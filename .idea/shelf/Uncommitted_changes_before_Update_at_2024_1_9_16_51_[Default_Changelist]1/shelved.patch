Index: src/main/resources/mapper/zhouqi/mapper/QuestionMapper.java
===================================================================
diff --git a/src/main/resources/mapper/zhouqi/mapper/QuestionMapper.java b/src/main/resources/mapper/zhouqi/mapper/QuestionMapper.java
deleted file mode 100644
--- a/src/main/resources/mapper/zhouqi/mapper/QuestionMapper.java	
+++ /dev/null	
@@ -1,25 +0,0 @@
-package com.kalvin.kvf.modules.zhouqi.mapper;
-
-import com.baomidou.mybatisplus.core.mapper.BaseMapper;
-import com.baomidou.mybatisplus.core.metadata.IPage;
-import com.kalvin.kvf.modules.zhouqi.entity.Question;
-
-import java.util.List;
-
-/**
- * <p>
- *  Mapper 接口
- * </p>
- * @since 2023-07-14 17:00:09
- */
-public interface QuestionMapper extends BaseMapper<Question> {
-
-    /**
-     * 查询列表(分页)
-     * @param question 查询参数
-     * @param page 分页参数
-     * @return list
-     */
-    List<Question> selectQuestionList(Question question, IPage page);
-
-}
Index: src/main/resources/mapper/zhouqi/service/QuestionService.java
===================================================================
diff --git a/src/main/resources/mapper/zhouqi/service/QuestionService.java b/src/main/resources/mapper/zhouqi/service/QuestionService.java
deleted file mode 100644
--- a/src/main/resources/mapper/zhouqi/service/QuestionService.java	
+++ /dev/null	
@@ -1,22 +0,0 @@
-package com.kalvin.kvf.modules.zhouqi.service;
-
-import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
-import com.baomidou.mybatisplus.extension.service.IService;
-import com.kalvin.kvf.modules.zhouqi.entity.Question;
-
-/**
- * <p>
- *  服务类
- * </p>
- * @since 2023-07-14 17:00:09
- */
-public interface QuestionService extends IService<Question> {
-
-    /**
-     * 获取列表。分页
-     * @param question 查询参数
-     * @return page
-     */
-    Page<Question> listQuestionPage(Question question);
-
-}
Index: src/main/resources/mapper/zhouqi/controller/QuestionController.java
===================================================================
diff --git a/src/main/resources/mapper/zhouqi/controller/QuestionController.java b/src/main/resources/mapper/zhouqi/controller/QuestionController.java
deleted file mode 100644
--- a/src/main/resources/mapper/zhouqi/controller/QuestionController.java	
+++ /dev/null	
@@ -1,88 +0,0 @@
-package com.kalvin.kvf.modules.zhouqi.controller;
-
-import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
-import org.apache.shiro.authz.annotation.RequiresPermissions;
-import org.springframework.beans.factory.annotation.Autowired;
-import org.springframework.web.bind.annotation.*;
-import org.springframework.web.servlet.ModelAndView;
-import com.kalvin.kvf.common.controller.BaseController;
-import com.kalvin.kvf.common.dto.R;
-import com.kalvin.kvf.modules.zhouqi.entity.Question;
-import com.kalvin.kvf.modules.zhouqi.service.QuestionService;
-
-import java.util.List;
-
-
-/**
- * <p>
- *  前端控制器
- * </p>
- * @since 2023-07-14 17:00:09
- */
-@RestController
-@RequestMapping("zhouqi/question")
-public class QuestionController extends BaseController {
-
-    @Autowired
-    private QuestionService questionService;
-
-    @RequiresPermissions("zhouqi:question:index")
-    @GetMapping("index")
-    public ModelAndView index() {
-        return new ModelAndView("zhouqi/question");
-    }
-
-    @GetMapping(value = "edit")
-    public ModelAndView edit(Long id) {
-        ModelAndView mv = new ModelAndView("zhouqi/question_edit");
-        Question question;
-        if (id == null) {
-            question = new Question();
-        } else {
-            question = questionService.getById(id);
-        }
-        mv.addObject("editInfo", question);
-        return mv;
-    }
-
-    @GetMapping(value = "list/data")
-    public R listData(Question question) {
-        Page<Question> page = questionService.listQuestionPage(question);
-        return R.ok(page);
-    }
-
-    @RequiresPermissions("zhouqi:question:add")
-    @PostMapping(value = "add")
-    public R add(Question question) {
-        questionService.save(question);
-        return R.ok();
-    }
-
-    @RequiresPermissions("zhouqi:question:del")
-    @PostMapping(value = "batchdel")
-    public R batchdel(@RequestParam("ids") List<Long> ids) {
-        questionService.removeByIds(ids);
-        return R.ok();
-    }
-
-    @RequiresPermissions("zhouqi:question:edit")
-    @PostMapping(value = "edit")
-    public R edit(Question question) {
-        questionService.updateById(question);
-        return R.ok();
-    }
-
-    @RequiresPermissions("zhouqi:question:del")
-    @PostMapping(value = "del/{id}")
-    public R del(@PathVariable Long id) {
-        questionService.removeById(id);
-        return R.ok();
-    }
-
-    @GetMapping(value = "get/{id}")
-    public R get(@PathVariable Long id) {
-        return R.ok(questionService.getById(id));
-    }
-
-}
-
Index: src/main/resources/mapper/zhouqi/service/QuestionServiceImpl.java
===================================================================
diff --git a/src/main/resources/mapper/zhouqi/service/QuestionServiceImpl.java b/src/main/resources/mapper/zhouqi/service/QuestionServiceImpl.java
deleted file mode 100644
--- a/src/main/resources/mapper/zhouqi/service/QuestionServiceImpl.java	
+++ /dev/null	
@@ -1,27 +0,0 @@
-package com.kalvin.kvf.modules.zhouqi.service;
-
-import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
-import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;
-import org.springframework.stereotype.Service;
-import com.kalvin.kvf.modules.zhouqi.entity.Question;
-import com.kalvin.kvf.modules.zhouqi.mapper.QuestionMapper;
-
-import java.util.List;
-
-/**
- * <p>
- *  服务实现类
- * </p>
- * @since 2023-07-14 17:00:09
- */
-@Service
-public class QuestionServiceImpl extends ServiceImpl<QuestionMapper, Question> implements QuestionService {
-
-    @Override
-    public Page<Question> listQuestionPage(Question question) {
-        Page<Question> page = new Page<>(question.getCurrent(), question.getSize());
-        List<Question> questions = baseMapper.selectQuestionList(question, page);
-        return page.setRecords(questions);
-    }
-
-}
Index: src/main/resources/mapper/zhouqi/entity/Question.java
===================================================================
diff --git a/src/main/resources/mapper/zhouqi/entity/Question.java b/src/main/resources/mapper/zhouqi/entity/Question.java
deleted file mode 100644
--- a/src/main/resources/mapper/zhouqi/entity/Question.java	
+++ /dev/null	
@@ -1,56 +0,0 @@
-package com.kalvin.kvf.modules.zhouqi.entity;
-
-import com.baomidou.mybatisplus.annotation.IdType;
-import com.baomidou.mybatisplus.annotation.TableId;
-import com.baomidou.mybatisplus.annotation.TableName;
-import lombok.Data;
-import lombok.EqualsAndHashCode;
-import lombok.experimental.Accessors;
-import com.kalvin.kvf.common.entity.BaseEntity;
-
-/**
- * <p>
- * 
- * </p>
- * @since 2023-07-14 17:00:09
- */
-@Data
-@EqualsAndHashCode(callSuper = true)
-@Accessors(chain = true)
-@TableName("zhouqi_question")
-public class Question extends BaseEntity {
-
-    private static final long serialVersionUID = 1L;
-
-    /**
-     * 
-     */
-    @TableId(value = "id", type = IdType.AUTO)
-    private Integer id;
-
-    /**
-     * 
-     */
-    private String classify;
-
-    /**
-     * 
-     */
-    private String subjectType;
-
-    /**
-     * 
-     */
-    private String question;
-
-    /**
-     * 
-     */
-    private String item;
-
-    /**
-     * 
-     */
-    private String answer;
-
-}
Index: src/main/java/com/kalvin/kvf/modules/schedule/entity/Job.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.schedule.entity;\r\n\r\nimport com.baomidou.mybatisplus.annotation.IdType;\r\nimport com.baomidou.mybatisplus.annotation.TableId;\r\nimport com.baomidou.mybatisplus.annotation.TableName;\r\nimport com.kalvin.kvf.common.entity.BaseEntity;\r\nimport lombok.Data;\r\nimport lombok.EqualsAndHashCode;\r\nimport lombok.experimental.Accessors;\r\nimport org.springframework.format.annotation.DateTimeFormat;\r\n\r\nimport java.time.LocalDateTime;\r\n\r\n\r\n/**\r\n * <p>\r\n * 定时任务表\r\n * </p>\r\n * @since 2019-08-17 17:06:12\r\n */\r\n@Data\r\n@EqualsAndHashCode(callSuper = true)\r\n@Accessors(chain = true)\r\n@TableName(\"schedule_job\")\r\npublic class Job extends BaseEntity {\r\n\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    /**\r\n     * 主键\r\n     */\r\n    @TableId(value = \"id\", type = IdType.AUTO)\r\n    private Long id;\r\n\r\n    /**\r\n     * 任务bean\r\n     */\r\n    private String bean;\r\n\r\n    /**\r\n     * 方法名\r\n     */\r\n    private String method;\r\n\r\n    /**\r\n     * 参数\r\n     */\r\n    private String params;\r\n\r\n    /**\r\n     * crom表达式\r\n     */\r\n    private String cron;\r\n\r\n    /**\r\n     * 状态。0：运行中；1：已暂停；2：已完成；3：运行失败；\r\n     */\r\n    private Integer status;\r\n\r\n    /**\r\n     * 备注\r\n     */\r\n    private String remark;\r\n\r\n    /**\r\n     * 创建时间\r\n     */\r\n    @DateTimeFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\r\n    private LocalDateTime createTime;\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/schedule/entity/Job.java b/src/main/java/com/kalvin/kvf/modules/schedule/entity/Job.java
--- a/src/main/java/com/kalvin/kvf/modules/schedule/entity/Job.java	
+++ b/src/main/java/com/kalvin/kvf/modules/schedule/entity/Job.java	
@@ -3,6 +3,7 @@
 import com.baomidou.mybatisplus.annotation.IdType;
 import com.baomidou.mybatisplus.annotation.TableId;
 import com.baomidou.mybatisplus.annotation.TableName;
+import com.fasterxml.jackson.annotation.JsonFormat;
 import com.kalvin.kvf.common.entity.BaseEntity;
 import lombok.Data;
 import lombok.EqualsAndHashCode;
@@ -10,6 +11,7 @@
 import org.springframework.format.annotation.DateTimeFormat;
 
 import java.time.LocalDateTime;
+import java.util.Date;
 
 
 /**
@@ -47,6 +49,11 @@
      */
     private String params;
 
+    /**
+     * 机器人地址
+     */
+    private String webhook;
+
     /**
      * crom表达式
      */
@@ -65,7 +72,7 @@
     /**
      * 创建时间
      */
-    @DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss")
-    private LocalDateTime createTime;
+    @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss", timezone = "GMT+8")
+    private Date createTime;
 
 }
Index: src/main/java/com/kalvin/kvf/modules/func/mapper/TrainMapper.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.mapper;\r\n\r\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\r\nimport com.baomidou.mybatisplus.core.metadata.IPage;\r\nimport com.kalvin.kvf.modules.func.entity.Train;\r\n\r\nimport java.util.List;\r\n\r\n/**\r\n * <p>\r\n * 在线培训表 Mapper 接口\r\n * </p>\r\n * @since 2022-06-08 09:36:53\r\n */\r\npublic interface TrainMapper extends BaseMapper<Train> {\r\n\r\n    /**\r\n     * 查询列表(分页)\r\n     * @param train 查询参数\r\n     * @param page 分页参数\r\n     * @return list\r\n     */\r\n    List<Train> selectTrainList(Train train, IPage page);\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/mapper/TrainMapper.java b/src/main/java/com/kalvin/kvf/modules/func/mapper/TrainMapper.java
--- a/src/main/java/com/kalvin/kvf/modules/func/mapper/TrainMapper.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/mapper/TrainMapper.java	
@@ -3,6 +3,7 @@
 import com.baomidou.mybatisplus.core.mapper.BaseMapper;
 import com.baomidou.mybatisplus.core.metadata.IPage;
 import com.kalvin.kvf.modules.func.entity.Train;
+import org.apache.ibatis.annotations.Select;
 
 import java.util.List;
 
@@ -22,4 +23,14 @@
      */
     List<Train> selectTrainList(Train train, IPage page);
 
+    /**
+     * 查询列表(分页)
+     * @param train 查询参数
+     * @param page 分页参数
+     * @return list
+     */
+    List<Train> getTrainList(Train train, IPage page);
+
+    @Select("SELECT DISTINCT department FROM func_user_tab")
+    List<String> getDepts();
 }
Index: src/main/java/com/kalvin/kvf/modules/schedule/job/HelloJob.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.schedule.job;\r\n\r\nimport com.kalvin.kvf.modules.schedule.constant.JobConstant;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.quartz.JobExecutionContext;\r\nimport org.quartz.JobExecutionException;\r\nimport org.springframework.scheduling.quartz.QuartzJobBean;\r\nimport org.springframework.stereotype.Component;\r\n\r\nimport java.util.Date;\r\n\r\n/**\r\n * 测试定时任务类。可删除\r\n */\r\n@Slf4j\r\n@Component\r\npublic class HelloJob extends QuartzJobBean {\r\n\r\n    @Override\r\n    protected void executeInternal(JobExecutionContext jobExecutionContext) throws JobExecutionException {\r\n        // 获得传入的参数\r\n        Object params = jobExecutionContext.getMergedJobDataMap().get(JobConstant.JOB_MAP_KEY);\r\n        log.info(\"helloJob is running params={}, time:{}\", params, new Date());\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/schedule/job/HelloJob.java b/src/main/java/com/kalvin/kvf/modules/schedule/job/HelloJob.java
--- a/src/main/java/com/kalvin/kvf/modules/schedule/job/HelloJob.java	
+++ b/src/main/java/com/kalvin/kvf/modules/schedule/job/HelloJob.java	
@@ -1,9 +1,17 @@
 package com.kalvin.kvf.modules.schedule.job;
 
+import com.alibaba.xxpt.gateway.shared.client.http.ExecutableClient;
+import com.dingtalk.api.DefaultDingTalkClient;
+import com.dingtalk.api.DingTalkClient;
+import com.dingtalk.api.request.OapiRobotSendRequest;
+import com.dingtalk.api.response.OapiRobotSendResponse;
+import com.kalvin.kvf.common.controller.BaseController;
 import com.kalvin.kvf.modules.schedule.constant.JobConstant;
 import lombok.extern.slf4j.Slf4j;
 import org.quartz.JobExecutionContext;
 import org.quartz.JobExecutionException;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 import org.springframework.scheduling.quartz.QuartzJobBean;
 import org.springframework.stereotype.Component;
 
@@ -15,11 +23,29 @@
 @Slf4j
 @Component
 public class HelloJob extends QuartzJobBean {
+    private Logger LOGGER = LoggerFactory.getLogger(HelloJob.class);
 
     @Override
     protected void executeInternal(JobExecutionContext jobExecutionContext) throws JobExecutionException {
         // 获得传入的参数
         Object params = jobExecutionContext.getMergedJobDataMap().get(JobConstant.JOB_MAP_KEY);
+        Object webhook = jobExecutionContext.getMergedJobDataMap().get(JobConstant.JOB_MAP_ADDRESS);
         log.info("helloJob is running params={}, time:{}", params, new Date());
+
+        try {
+            OapiRobotSendRequest request = new OapiRobotSendRequest();
+//            DingTalkClient client = new DefaultDingTalkClient("https://oapi.dingtalk.com/robot/send?access_token=9933cc8fd30809231360a9a8a54459eb15dd949eac75b1cb159ae0fdf568f546");
+            DingTalkClient client = new DefaultDingTalkClient(webhook.toString());
+
+            request.setMsgtype("text");
+            OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text();
+            text.setContent("小警提醒：" + params);
+            request.setText(text);
+
+            OapiRobotSendResponse response = client.execute(request);
+            LOGGER.info("发送成功!");
+        } catch (Exception ex) {
+            LOGGER.error(ex.getMessage(), ex);
+        }
     }
 }
\ No newline at end of file
Index: src/main/java/com/kalvin/kvf/modules/func/mapper/UserTabMapper.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.mapper;\r\n\r\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\r\nimport com.baomidou.mybatisplus.core.metadata.IPage;\r\nimport com.kalvin.kvf.modules.func.entity.UserTab;\r\n\r\nimport java.util.List;\r\n\r\n/**\r\n * <p>\r\n * 用户表 Mapper 接口\r\n * </p>\r\n * @since 2021-03-30 14:33:54\r\n */\r\npublic interface UserTabMapper extends BaseMapper<UserTab> {\r\n\r\n    /**\r\n     * 查询列表(分页)\r\n     * @param userTab 查询参数\r\n     * @param page 分页参数\r\n     * @return list\r\n     */\r\n    List<UserTab> selectUserTabList(UserTab userTab, IPage page);\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/mapper/UserTabMapper.java b/src/main/java/com/kalvin/kvf/modules/func/mapper/UserTabMapper.java
--- a/src/main/java/com/kalvin/kvf/modules/func/mapper/UserTabMapper.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/mapper/UserTabMapper.java	
@@ -2,7 +2,11 @@
 
 import com.baomidou.mybatisplus.core.mapper.BaseMapper;
 import com.baomidou.mybatisplus.core.metadata.IPage;
+import com.kalvin.kvf.modules.func.entity.DeptSys;
+import com.kalvin.kvf.modules.func.entity.UserSys;
 import com.kalvin.kvf.modules.func.entity.UserTab;
+import org.apache.ibatis.annotations.Param;
+import org.apache.ibatis.annotations.Select;
 
 import java.util.List;
 
@@ -22,4 +26,70 @@
      */
     List<UserTab> selectUserTabList(UserTab userTab, IPage page);
 
+    /**
+     * 用户列表
+     * @return List<UserTab>
+     */
+    @Select("select a.*,IFNULL(b.today_cnt,0) todayCnt from func_user_tab a\n" +
+            "left join func_user_info b\n" +
+            "on a.userid = b.userid\n" +
+            "order by todayCnt ")
+    List<UserTab> selectUserList();
+
+    @Select("SELECT t1.days\n" +
+            "FROM\n" +
+            "/*连续天数表*/\n" +
+            "(SELECT\n" +
+            "    date_format(@cdate := DATE_ADD(@cdate, INTERVAL - 1 DAY),'%Y-%m-%d') as days\n" +
+            "  FROM\n" +
+            "    (SELECT @cdate := DATE_ADD(NOW(), INTERVAL + 1 DAY) FROM func_record) t0\n" +
+            "  LIMIT 10) t1\n" +
+            "/*左连接数据表*/\n" +
+            "LEFT JOIN\n" +
+            "(select id,userid, date_format(create_time,'%Y-%m-%d') as days from func_record ) t2\n" +
+            "ON t2.days = t1.days and t2.userid = #{userid}\n" +
+            "GROUP BY t1.days\n" +
+            "HAVING COUNT(t2.id) = 0")
+    List<String> getUndoDays(@Param("userid") String userid);
+
+    @Select("select T01.*,T02.cnt,round(T01.cs/T02.cnt * 100,2) bfb from (\n" +
+            "select department,sum(case when userid is null then 0 else 1 end) cs from (\n" +
+            "select T01.department,T02.userid,T02.realname from (\n" +
+            "select distinct department from func_user_tab) T01 left join \n" +
+            "(select T01.*,T02.department from (\n" +
+            "SELECT distinct userid, realname  FROM func_record\n" +
+            "WHERE create_time like #{date} )T01 LEFT JOIN func_user_tab T02 on T01.userid = T02.userid) T02 on T01.department = T02.department\n" +
+            ") T01 group by department ) T01,(SELECT department, COUNT(*) cnt from func_user_tab\n" +
+            "GROUP BY department) T02 where T01.department = T02.department\n" +
+            "ORDER BY bfb desc")
+    List<DeptSys> getDeptSys(String date);
+
+    @Select("select realname ,avatar, (case when userid is null then 0 else 1 end) status from(\n" +
+            "select T1.realname, T1.avatar, T2.userid from(\n" +
+            "select * from func_user_tab\n" +
+            "WHERE department = #{deptName}\n" +
+            ")T1\n" +
+            "LEFT JOIN(\n" +
+            "select distinct userid, realname from func_record\n" +
+            "where create_time like #{date}) T2\n" +
+            "ON T1.userid = T2.userid) T3\n" +
+            "order by status")
+    List<UserSys> getUserSys(@Param("deptName") String deptName, @Param("date") String date);
+
+    @Select("SELECT\n" +
+            "\trealname,\n" +
+            "\tavatar,\n" +
+            "\t( CASE WHEN userid IS NULL THEN 0 ELSE 1 END ) status \n" +
+            "FROM\n" +
+            "\t(\n" +
+            "\tSELECT\n" +
+            "\t\tT1.realname,\n" +
+            "\t\tT1.avatar,\n" +
+            "\t\tT2.userid \n" +
+            "\tFROM\n" +
+            "\t\t( SELECT * FROM func_user_tab WHERE department = #{deptName} ) T1\n" +
+            "\t\tLEFT JOIN ( SELECT DISTINCT user_id userid FROM func_train_record WHERE train_id = #{trainId}) T2 ON T1.userid = T2.userid \n" +
+            "\t) T3 \n" +
+            "ORDER BY status")
+    List<UserSys> getUserStatus(@Param("deptName") String deptName, @Param("trainId") Integer trainId);
 }
Index: src/main/java/com/kalvin/kvf/modules/func/mapper/QuestionBankMapper.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.mapper;\r\n\r\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\r\nimport com.baomidou.mybatisplus.core.metadata.IPage;\r\nimport com.kalvin.kvf.modules.func.entity.QuestionBank;\r\nimport com.kalvin.kvf.modules.sys.entity.User;\r\nimport org.apache.ibatis.annotations.Param;\r\nimport org.apache.ibatis.annotations.Select;\r\n\r\nimport java.util.List;\r\n\r\n/**\r\n * <p>\r\n * 题库 Mapper 接口\r\n * </p>\r\n * @since 2020-07-20 10:24:50\r\n */\r\npublic interface QuestionBankMapper extends BaseMapper<QuestionBank> {\r\n\r\n    /**\r\n     * 查询列表(分页)\r\n     * @param questionBank 查询参数\r\n     * @param page 分页参数\r\n     * @return list\r\n     */\r\n    List<QuestionBank> selectQuestionBankList(@Param(\"questionBank\") QuestionBank questionBank, IPage page);\r\n\r\n    /**\r\n     * 查询所有的出题人\r\n     * @return\r\n     */\r\n    @Select(\"SELECT b.* FROM\\n\" +\r\n            \"\\t(SELECT DISTINCT create_by FROM func_question_bank) a\\n\" +\r\n            \"LEFT JOIN  sys_user b\\n\" +\r\n            \"ON a.create_by = b.id\")\r\n    List<User> getBankCreators();\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/mapper/QuestionBankMapper.java b/src/main/java/com/kalvin/kvf/modules/func/mapper/QuestionBankMapper.java
--- a/src/main/java/com/kalvin/kvf/modules/func/mapper/QuestionBankMapper.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/mapper/QuestionBankMapper.java	
@@ -35,4 +35,42 @@
             "ON a.create_by = b.id")
     List<User> getBankCreators();
 
+    /**
+     * 获取专项类别列表
+     * @return
+     */
+    @Select("SELECT distinct classify from func_question_bank\n" +
+            "WHERE classify is not null;")
+    List<String> getClassify();
+
+    /**
+     *
+     * @return
+     */
+    @Select("(select * from func_question_bank\n" +
+            "where classify = '科技应用' and subject_type = 1\n" +
+            "order by RAND()\n" +
+            "limit 20)\n" +
+            "UNION \n" +
+            "(select * from func_question_bank\n" +
+            "where classify = '科技应用' and subject_type = 2\n" +
+            "order by RAND()\n" +
+            "limit 20)\n" +
+            "UNION \n" +
+            "(select * from func_question_bank\n" +
+            "where classify = '科技应用' and subject_type = 3\n" +
+            "order by RAND()\n" +
+            "limit 10)")
+    List<Integer> getRandom50();
+
+    @Select("(select * from func_question_bank\n" +
+            "where subject_type = 1 and classify = '新警题库'\n" +
+            "order by RAND()\n" +
+            "limit 60)\n" +
+            "union  all \n" +
+            "(select * from func_question_bank\n" +
+            "where subject_type = 2 and classify = '新警题库'\n" +
+            "order by RAND()\n" +
+            "limit 40)")
+    List<QuestionBank> getNewtests();
 }
Index: src/main/java/com/kalvin/kvf/modules/zhouqi/entity/Question.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.zhouqi.entity;\r\n\r\nimport com.baomidou.mybatisplus.annotation.IdType;\r\nimport com.baomidou.mybatisplus.annotation.TableId;\r\nimport com.baomidou.mybatisplus.annotation.TableName;\r\nimport lombok.Data;\r\nimport lombok.EqualsAndHashCode;\r\nimport lombok.experimental.Accessors;\r\nimport com.kalvin.kvf.common.entity.BaseEntity;\r\n\r\n/**\r\n * <p>\r\n * \r\n * </p>\r\n * @since 2023-07-14 17:00:09\r\n */\r\n@Data\r\n@EqualsAndHashCode(callSuper = true)\r\n@Accessors(chain = true)\r\n@TableName(\"zhouqi_question\")\r\npublic class Question extends BaseEntity {\r\n\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    /**\r\n     * \r\n     */\r\n    @TableId(value = \"id\", type = IdType.AUTO)\r\n    private Integer id;\r\n\r\n    /**\r\n     * \r\n     */\r\n    private String classify;\r\n\r\n    /**\r\n     * \r\n     */\r\n    private String subjectType;\r\n\r\n    /**\r\n     * \r\n     */\r\n    private String question;\r\n\r\n    /**\r\n     * \r\n     */\r\n    private String item;\r\n\r\n    /**\r\n     * \r\n     */\r\n    private String answer;\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/zhouqi/entity/Question.java b/src/main/java/com/kalvin/kvf/modules/zhouqi/entity/Question.java
--- a/src/main/java/com/kalvin/kvf/modules/zhouqi/entity/Question.java	
+++ b/src/main/java/com/kalvin/kvf/modules/zhouqi/entity/Question.java	
@@ -29,27 +29,32 @@
     private Integer id;
 
     /**
-     * 
+     * 标题
+     */
+    private String label;
+
+    /**
+     * 题库名称
      */
     private String classify;
 
     /**
-     * 
+     * 题目类型
      */
-    private String subjectType;
+    private Long subjectType;
 
     /**
-     * 
+     * 问题
      */
     private String question;
 
     /**
-     * 
+     * 选项
      */
     private String item;
 
     /**
-     * 
+     * 答案
      */
     private String answer;
 
Index: src/main/java/com/kalvin/kvf/common/config/RedisConfig.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.common.config;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonAutoDetect;\r\nimport com.fasterxml.jackson.annotation.PropertyAccessor;\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\nimport com.fasterxml.jackson.databind.SerializationFeature;\r\nimport com.fasterxml.jackson.datatype.jsr310.JavaTimeModule;\r\nimport org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\r\nimport org.springframework.cache.CacheManager;\r\nimport org.springframework.cache.annotation.CachingConfigurerSupport;\r\nimport org.springframework.cache.annotation.EnableCaching;\r\nimport org.springframework.cache.interceptor.KeyGenerator;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.context.annotation.Primary;\r\nimport org.springframework.data.redis.cache.RedisCacheConfiguration;\r\nimport org.springframework.data.redis.cache.RedisCacheManager;\r\nimport org.springframework.data.redis.cache.RedisCacheWriter;\r\nimport org.springframework.data.redis.connection.RedisConnectionFactory;\r\nimport org.springframework.data.redis.core.RedisTemplate;\r\nimport org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;\r\nimport org.springframework.data.redis.serializer.RedisSerializationContext;\r\nimport org.springframework.data.redis.serializer.RedisSerializer;\r\nimport org.springframework.data.redis.serializer.StringRedisSerializer;\r\n\r\nimport java.time.Duration;\r\n\r\n/**\r\n * Redis配置\r\n * Create by Kalvin on 2019/6/25\r\n */\r\n@EnableCaching  //启用缓存注解\r\n@Configuration\r\n@ConditionalOnProperty(name = \"kvf.cache.enable\", havingValue = \"true\")\r\npublic class RedisConfig extends CachingConfigurerSupport {\r\n\r\n    /**\r\n     * 注入生成key的策略(作用于注解注解缓存)\r\n     */\r\n    @Bean(name = \"customKeyGenerator\")\r\n    public KeyGenerator keyGenerator() {\r\n        return new RedisCacheKeyGenerator();\r\n    }\r\n\r\n    @Primary\r\n    @Bean\r\n    public CacheManager cacheManager(RedisConnectionFactory factory) {\r\n        // 对象的序列化\r\n        RedisSerializationContext.SerializationPair<Object> valueSerializationPair\r\n                = RedisSerializationContext.SerializationPair.fromSerializer(jackson2JsonRedisSerializer());\r\n        // 全局redis缓存过期时间。默认1天\r\n        RedisCacheConfiguration redisCacheConfiguration = RedisCacheConfiguration.defaultCacheConfig()\r\n                .entryTtl(Duration.ofDays(1))\r\n//                .serializeKeysWith()\r\n                .serializeValuesWith(valueSerializationPair);\r\n\r\n        return new RedisCacheManager(RedisCacheWriter.nonLockingRedisCacheWriter(factory), redisCacheConfiguration);\r\n    }\r\n\r\n    /**\r\n     * RedisTemplate配置\r\n     * @param factory redis链接工厂\r\n     * @return RedisTemplate\r\n     */\r\n    @Bean(name = \"redisTemplate\")\r\n    public RedisTemplate<String, Object> redisTemplate(RedisConnectionFactory factory) {\r\n        RedisTemplate<String, Object> template = new RedisTemplate<>();\r\n        RedisSerializer<String> redisSerializer = new StringRedisSerializer();\r\n\r\n        // 设置序列化，key采用redisSerializer，value采用jackson2JsonRedisSerializer\r\n        template.setConnectionFactory(factory);\r\n        template.setKeySerializer(redisSerializer);\r\n        template.setValueSerializer(jackson2JsonRedisSerializer());\r\n        template.setHashKeySerializer(redisSerializer);\r\n        template.setHashValueSerializer(jackson2JsonRedisSerializer());\r\n        template.afterPropertiesSet();\r\n        return template;\r\n    }\r\n\r\n\r\n    private Jackson2JsonRedisSerializer<Object> jackson2JsonRedisSerializer() {\r\n        Jackson2JsonRedisSerializer<Object> jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer<>(Object.class);\r\n        jackson2JsonRedisSerializer.setObjectMapper(objectMapper());\r\n        return jackson2JsonRedisSerializer;\r\n    }\r\n\r\n    private ObjectMapper objectMapper() {\r\n        ObjectMapper objectMapper = new ObjectMapper();\r\n        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);\r\n        objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);\r\n\r\n        // 解决jackson2无法反序列化LocalDateTime的问题\r\n        objectMapper.disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);\r\n        objectMapper.registerModule(new JavaTimeModule());\r\n        return objectMapper;\r\n    }\r\n\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/common/config/RedisConfig.java b/src/main/java/com/kalvin/kvf/common/config/RedisConfig.java
--- a/src/main/java/com/kalvin/kvf/common/config/RedisConfig.java	
+++ b/src/main/java/com/kalvin/kvf/common/config/RedisConfig.java	
@@ -29,7 +29,7 @@
  * Redis配置
  * Create by Kalvin on 2019/6/25
  */
-@EnableCaching  //启用缓存注解
+@EnableCaching
 @Configuration
 @ConditionalOnProperty(name = "kvf.cache.enable", havingValue = "true")
 public class RedisConfig extends CachingConfigurerSupport {
@@ -37,6 +37,7 @@
     /**
      * 注入生成key的策略(作用于注解注解缓存)
      */
+    @Override
     @Bean(name = "customKeyGenerator")
     public KeyGenerator keyGenerator() {
         return new RedisCacheKeyGenerator();
@@ -77,7 +78,6 @@
         return template;
     }
 
-
     private Jackson2JsonRedisSerializer<Object> jackson2JsonRedisSerializer() {
         Jackson2JsonRedisSerializer<Object> jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer<>(Object.class);
         jackson2JsonRedisSerializer.setObjectMapper(objectMapper());
@@ -94,7 +94,5 @@
         objectMapper.registerModule(new JavaTimeModule());
         return objectMapper;
     }
-
-
 }
 
Index: src/main/java/com/kalvin/kvf/modules/func/mapper/QuestionCollectMapper.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.mapper;\r\n\r\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\r\nimport com.baomidou.mybatisplus.core.metadata.IPage;\r\nimport com.kalvin.kvf.modules.func.entity.QuestionCollect;\r\n\r\nimport java.util.List;\r\n\r\n/**\r\n * <p>\r\n *  Mapper 接口\r\n * </p>\r\n * @since 2022-01-17 08:50:34\r\n */\r\npublic interface QuestionCollectMapper extends BaseMapper<QuestionCollect> {\r\n\r\n    /**\r\n     * 查询列表(分页)\r\n     * @param questionCollect 查询参数\r\n     * @param page 分页参数\r\n     * @return list\r\n     */\r\n    List<QuestionCollect> selectQuestionCollectList(QuestionCollect questionCollect, IPage page);\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/mapper/QuestionCollectMapper.java b/src/main/java/com/kalvin/kvf/modules/func/mapper/QuestionCollectMapper.java
--- a/src/main/java/com/kalvin/kvf/modules/func/mapper/QuestionCollectMapper.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/mapper/QuestionCollectMapper.java	
@@ -2,7 +2,10 @@
 
 import com.baomidou.mybatisplus.core.mapper.BaseMapper;
 import com.baomidou.mybatisplus.core.metadata.IPage;
+import com.kalvin.kvf.modules.func.entity.QuestionBank;
 import com.kalvin.kvf.modules.func.entity.QuestionCollect;
+import org.apache.ibatis.annotations.Param;
+import org.apache.ibatis.annotations.Select;
 
 import java.util.List;
 
@@ -22,4 +25,11 @@
      */
     List<QuestionCollect> selectQuestionCollectList(QuestionCollect questionCollect, IPage page);
 
+    @Select("select b.*, a.`status` sta from func_question_collect a\n" +
+            "left join func_question_bank b\n" +
+            "on a.qs_id = b.id\n" +
+            "where a.status = 0 and a.userid = #{userid}\n" +
+            "order by RAND()\n" +
+            "limit 10")
+    List<QuestionBank> getRandQuestionC(@Param("userid") String userid);
 }
Index: src/main/resources/mapper/zhouqi/QuestionMapper.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\r\n<mapper namespace=\"com.kalvin.kvf.modules.zhouqi.mapper.QuestionMapper\">\r\n\r\n    <!-- 通用查询映射结果 -->\r\n    <resultMap id=\"BaseResultMap\" type=\"com.kalvin.kvf.modules.zhouqi.entity.Question\">\r\n        <id column=\"id\" property=\"id\" />\r\n        <result column=\"classify\" property=\"classify\" />\r\n        <result column=\"subject_type\" property=\"subjectType\" />\r\n        <result column=\"question\" property=\"question\" />\r\n        <result column=\"item\" property=\"item\" />\r\n        <result column=\"answer\" property=\"answer\" />\r\n    </resultMap>\r\n\r\n    <!-- 通用查询结果列 -->\r\n    <sql id=\"Base_Column_List\">\r\n       id, classify, subject_type, question, item, answer\r\n    </sql>\r\n\r\n    <select id=\"selectQuestionList\" resultType=\"com.kalvin.kvf.modules.zhouqi.entity.Question\">\r\n        select <include refid=\"Base_Column_List\" /> from zhouqi_question\r\n        <trim prefix=\"where\" prefixOverrides=\"and\">\r\n            <if test=\"question.classify != null and question.classify != ''\">\r\n                and classify like concat(#{question.classify}, \"%\")\r\n            </if>\r\n            <if test=\"question.subjectType != null and question.subjectType != ''\">\r\n                and subject_type like concat(#{question.subjectType}, \"%\")\r\n            </if>\r\n            <if test=\"question.question != null and question.question != ''\">\r\n                and question like concat(#{question.question}, \"%\")\r\n            </if>\r\n            <if test=\"question.item != null and question.item != ''\">\r\n                and item like concat(#{question.item}, \"%\")\r\n            </if>\r\n            <if test=\"question.answer != null and question.answer != ''\">\r\n                and answer like concat(#{question.answer}, \"%\")\r\n            </if>\r\n        </trim>\r\n    </select>\r\n\r\n</mapper>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/mapper/zhouqi/QuestionMapper.xml b/src/main/resources/mapper/zhouqi/QuestionMapper.xml
--- a/src/main/resources/mapper/zhouqi/QuestionMapper.xml	
+++ b/src/main/resources/mapper/zhouqi/QuestionMapper.xml	
@@ -5,6 +5,7 @@
     <!-- 通用查询映射结果 -->
     <resultMap id="BaseResultMap" type="com.kalvin.kvf.modules.zhouqi.entity.Question">
         <id column="id" property="id" />
+        <result column="label" property="label" />
         <result column="classify" property="classify" />
         <result column="subject_type" property="subjectType" />
         <result column="question" property="question" />
@@ -14,7 +15,7 @@
 
     <!-- 通用查询结果列 -->
     <sql id="Base_Column_List">
-       id, classify, subject_type, question, item, answer
+       id, label, classify, subject_type, question, item, answer
     </sql>
 
     <select id="selectQuestionList" resultType="com.kalvin.kvf.modules.zhouqi.entity.Question">
Index: src/main/java/com/kalvin/kvf/modules/func/mapper/RecordMapper.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.mapper;\r\n\r\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\r\nimport com.baomidou.mybatisplus.core.metadata.IPage;\r\nimport com.kalvin.kvf.modules.func.entity.Record;\r\n\r\nimport java.util.List;\r\n\r\n/**\r\n * <p>\r\n *  Mapper 接口\r\n * </p>\r\n * @since 2021-03-30 16:24:21\r\n */\r\npublic interface RecordMapper extends BaseMapper<Record> {\r\n\r\n    /**\r\n     * 查询列表(分页)\r\n     * @param record 查询参数\r\n     * @param page 分页参数\r\n     * @return list\r\n     */\r\n    List<Record> selectRecordList(Record record, IPage page);\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/mapper/RecordMapper.java b/src/main/java/com/kalvin/kvf/modules/func/mapper/RecordMapper.java
--- a/src/main/java/com/kalvin/kvf/modules/func/mapper/RecordMapper.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/mapper/RecordMapper.java	
@@ -3,6 +3,7 @@
 import com.baomidou.mybatisplus.core.mapper.BaseMapper;
 import com.baomidou.mybatisplus.core.metadata.IPage;
 import com.kalvin.kvf.modules.func.entity.Record;
+import org.apache.ibatis.annotations.Select;
 
 import java.util.List;
 
@@ -22,4 +23,13 @@
      */
     List<Record> selectRecordList(Record record, IPage page);
 
+    /**
+     * 获取当天最高积分
+     * @param userid
+     * @return
+     */
+    @Select("SELECT MAX(level) level FROM func_record\n" +
+            "WHERE TO_DAYS(create_time) = TO_DAYS(NOW())\n" +
+            "and  userid = #{userid}")
+    Integer getMaxLevel(String userid);
 }
Index: src/main/java/com/kalvin/kvf/modules/schedule/constant/JobConstant.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.schedule.constant;\r\n\r\n/**\r\n * Create by Kalvin on 2019/8/17\r\n */\r\npublic class JobConstant {\r\n\r\n    // 任务状态\r\n    public final static int JOB_STATUS_RUNNING = 0;\r\n    public final static int JOB_STATUS_PAUSE = 1;\r\n    public final static int JOB_STATUS_FINISH = 2;\r\n    public final static int JOB_STATUS_FAIL = 3;\r\n\r\n    public final static String JOB_MAP_KEY = \"JOB_KEY\";\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/schedule/constant/JobConstant.java b/src/main/java/com/kalvin/kvf/modules/schedule/constant/JobConstant.java
--- a/src/main/java/com/kalvin/kvf/modules/schedule/constant/JobConstant.java	
+++ b/src/main/java/com/kalvin/kvf/modules/schedule/constant/JobConstant.java	
@@ -12,5 +12,5 @@
     public final static int JOB_STATUS_FAIL = 3;
 
     public final static String JOB_MAP_KEY = "JOB_KEY";
-
+    public final static String JOB_MAP_ADDRESS = "JOB_ADDRESS";
 }
Index: src/main/java/com/kalvin/kvf/modules/schedule/utils/ScheduleKit.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.schedule.utils;\r\n\r\nimport com.kalvin.kvf.common.exception.KvfException;\r\nimport com.kalvin.kvf.common.utils.SpringContextKit;\r\nimport com.kalvin.kvf.modules.schedule.constant.JobConstant;\r\nimport com.kalvin.kvf.modules.schedule.entity.Job;\r\nimport org.quartz.*;\r\nimport org.springframework.scheduling.quartz.QuartzJobBean;\r\n\r\n/**\r\n * 定时任务工具类\r\n * Create by Kalvin on 2019/8/17\r\n */\r\npublic class ScheduleKit {\r\n\r\n    private final static String JOB_KEY = \"JOB_\";\r\n\r\n    private final static Scheduler scheduler = SpringContextKit.getBean(Scheduler.class);\r\n\r\n    public static void create(Long jobId, Job job) {\r\n        try {\r\n            // 启动调度器\r\n//            scheduler.start();\r\n            //构建job信息\r\n            JobDetail jobDetail = JobBuilder.newJob(ScheduleKit.getJobClass(job.getBean()).getClass()).withIdentity(getJobKey(jobId)).build();\r\n            //表达式调度构建器(即任务执行的时间)\r\n            CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(job.getCron());\r\n            //按新的cronExpression表达式构建一个新的trigger\r\n            CronTrigger trigger = TriggerBuilder.newTrigger().withIdentity(getTriggerKey(jobId))\r\n                    .withSchedule(scheduleBuilder).build();\r\n            // 传入参数\r\n            jobDetail.getJobDataMap().put(JobConstant.JOB_MAP_KEY, job.getParams());\r\n            scheduler.scheduleJob(jobDetail, trigger);\r\n\r\n            // 默认创建时任务设置为暂停\r\n            ScheduleKit.pause(jobId);\r\n        } catch (SchedulerException e) {\r\n            throw new KvfException(\"创建定时任务失败\");\r\n        }\r\n    }\r\n\r\n    public static void pause(Long jobId) {\r\n        try {\r\n            scheduler.pauseJob(getJobKey(jobId));\r\n        } catch (SchedulerException e) {\r\n            throw new KvfException(\"暂停定时任务失败\");\r\n        }\r\n    }\r\n\r\n    public static void resume(Long jobId) {\r\n        try {\r\n            scheduler.resumeJob(getJobKey(jobId));\r\n        } catch (SchedulerException e) {\r\n            throw new KvfException(\"恢复启动定时任务失败\");\r\n        }\r\n    }\r\n\r\n    public static void update(Long jobId, Job job) {\r\n        try {\r\n            TriggerKey triggerKey = getTriggerKey(jobId);\r\n            // 表达式调度构建器\r\n            CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(job.getCron());\r\n            CronTrigger trigger = (CronTrigger) scheduler.getTrigger(triggerKey);\r\n            // 按新的cronExpression表达式重新构建trigger\r\n            trigger = trigger.getTriggerBuilder().withIdentity(triggerKey).withSchedule(scheduleBuilder).build();\r\n            // 更新参数\r\n            trigger.getJobDataMap().put(JobConstant.JOB_MAP_KEY, job.getParams());\r\n            // 按新的trigger重新设置job执行\r\n            scheduler.rescheduleJob(triggerKey, trigger);\r\n        } catch (SchedulerException e) {\r\n            throw new KvfException(\"更新定时任务失败\");\r\n        }catch (Exception ex){\r\n            throw ex;\r\n        }\r\n    }\r\n\r\n    public static void delete(Long jobId) {\r\n        try {\r\n            scheduler.pauseTrigger(getTriggerKey(jobId));\r\n            scheduler.unscheduleJob(getTriggerKey(jobId));\r\n            scheduler.deleteJob(getJobKey(jobId));\r\n        } catch (SchedulerException e) {\r\n            throw new KvfException(\"删除定时任务失败\");\r\n        }\r\n    }\r\n\r\n    public static JobKey getJobKey(Long jobId) {\r\n        return JobKey.jobKey(JOB_KEY + jobId);\r\n    }\r\n\r\n    public static TriggerKey getTriggerKey(Long jobId) {\r\n        return TriggerKey.triggerKey(JOB_KEY + jobId);\r\n    }\r\n\r\n    public static QuartzJobBean getJobClass(String classname) {\r\n        return (QuartzJobBean) SpringContextKit.getBean(classname);\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/schedule/utils/ScheduleKit.java b/src/main/java/com/kalvin/kvf/modules/schedule/utils/ScheduleKit.java
--- a/src/main/java/com/kalvin/kvf/modules/schedule/utils/ScheduleKit.java	
+++ b/src/main/java/com/kalvin/kvf/modules/schedule/utils/ScheduleKit.java	
@@ -65,12 +65,13 @@
             trigger = trigger.getTriggerBuilder().withIdentity(triggerKey).withSchedule(scheduleBuilder).build();
             // 更新参数
             trigger.getJobDataMap().put(JobConstant.JOB_MAP_KEY, job.getParams());
+            trigger.getJobDataMap().put(JobConstant.JOB_MAP_ADDRESS, job.getWebhook());
             // 按新的trigger重新设置job执行
             scheduler.rescheduleJob(triggerKey, trigger);
         } catch (SchedulerException e) {
             throw new KvfException("更新定时任务失败");
         }catch (Exception ex){
-            throw ex;
+            throw new KvfException("更新定时任务失败");
         }
     }
 
Index: src/main/java/com/kalvin/kvf/modules/func/service/UserInfoServiceImpl.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.service;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;\r\nimport org.springframework.stereotype.Service;\r\nimport com.kalvin.kvf.modules.func.entity.UserInfo;\r\nimport com.kalvin.kvf.modules.func.mapper.UserInfoMapper;\r\n\r\nimport java.util.List;\r\n\r\n/**\r\n * <p>\r\n * 用户信息表 服务实现类\r\n * </p>\r\n * @since 2021-03-11 14:26:11\r\n */\r\n@Service\r\npublic class UserInfoServiceImpl extends ServiceImpl<UserInfoMapper, UserInfo> implements UserInfoService {\r\n\r\n    @Override\r\n    public Page<UserInfo> listUserInfoPage(UserInfo userInfo) {\r\n        Page<UserInfo> page = new Page<>(userInfo.getCurrent(), userInfo.getSize());\r\n        List<UserInfo> userInfos = baseMapper.selectUserInfoList(userInfo, page);\r\n        return page.setRecords(userInfos);\r\n    }\r\n\r\n    @Override\r\n    public Page<UserInfo> getRank(UserInfo userInfo) {\r\n        Page<UserInfo> page = new Page<>(userInfo.getCurrent(), userInfo.getSize());\r\n        List<UserInfo> userInfos = baseMapper.getRank(userInfo, page);\r\n        return page.setRecords(userInfos);\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/service/UserInfoServiceImpl.java b/src/main/java/com/kalvin/kvf/modules/func/service/UserInfoServiceImpl.java
--- a/src/main/java/com/kalvin/kvf/modules/func/service/UserInfoServiceImpl.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/service/UserInfoServiceImpl.java	
@@ -30,4 +30,11 @@
         List<UserInfo> userInfos = baseMapper.getRank(userInfo, page);
         return page.setRecords(userInfos);
     }
+
+    @Override
+    public Page<UserInfo> getMonthRank(UserInfo userInfo) {
+        Page<UserInfo> page = new Page<>(userInfo.getCurrent(), userInfo.getSize());
+        List<UserInfo> userInfos = baseMapper.getMonthRank(userInfo, page);
+        return page.setRecords(userInfos);
+    }
 }
Index: src/main/resources/templates/func/train.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n</head>\r\n<body style=\"background-color: #f2f2f2;\">\r\n\r\n<div id=\"kPage\" class=\"layui-fluid\" style=\"padding: 0\">\r\n    <div class=\"layui-row\">\r\n        <div class=\"layui-col-md12\" id=\"kMainContentCol\">\r\n            <div class=\"layui-fluid kvf-fluid-padding15\">\r\n                <div class=\"layui-card\">\r\n                    <form>\r\n                        <div class=\"layui-form layui-card-header kvf-card-header-auto\">\r\n                            <div class=\"layui-form-item\">\r\n                                <div class=\"layui-inline\">\r\n                                    <label class=\"layui-form-label\">标题</label>\r\n                                    <div class=\"layui-input-inline\">\r\n                                        <input type=\"text\" name=\"title\" placeholder=\"请输入标题\" autocomplete=\"off\" class=\"layui-input\">\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class=\"layui-inline\">\r\n                                    <button class=\"layui-btn \" lay-submit=\"\" lay-filter=\"kTableSearchFilter\">\r\n                                        <i class=\"layui-icon layui-icon-search\"></i>\r\n                                    </button>\r\n                                    <button class=\"layui-btn \" type=\"reset\" data-event=\"refresh\">\r\n                                        <i class=\"layui-icon layui-icon-refresh-1\"></i>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </form>\r\n\r\n                    <div class=\"layui-card-body\">\r\n                        <table id=\"kContentTable\" lay-filter=\"kContentTable\"></table>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n\r\n<!--头部工具栏模板-->\r\n<script type=\"text/html\" id=\"headToolbarTpl\">\r\n    <button class=\"layui-btn layui-btn-sm \" lay-event=\"add\">添加</button>\r\n    <button class=\"layui-btn layui-btn-sm layui-btn-danger\" lay-event=\"batchdel\">批量删除</button>\r\n</script>\r\n\r\n<!--表格行工具栏模板-->\r\n<script type=\"text/html\" id=\"rowToolbarTpl\">\r\n    <a class=\"layui-btn layui-btn-xs layui-btn-normal\" lay-event=\"edit\"><i class=\"layui-icon layui-icon-edit\"></i>编辑</a>\r\n    <a class=\"layui-btn layui-btn-xs layui-btn-danger\" lay-event=\"del\"><i class=\"layui-icon layui-icon-delete\"></i>删除</a>\r\n</script>\r\n\r\n<!--表格列格式化模板 start-->\r\n<!--表格列格式化模板 end-->\r\n\r\n<script type=\"text/javascript\" th:inline=\"javascript\">\r\n    layui.use(['element', 'form', 'layer', 'table', 'laydate'], function () {\r\n        var elemet = layui.element, form = layui.form, layer = layui.layer, table = layui.table, laydate = layui.laydate;\r\n        var tableId = 'kContentTable';\r\n        var area = ['449px', '95%'];\r\n\r\n        // 实例化table\r\n        var tableIns = table.render($.extend(config.layui.table, {\r\n            elem: '#' + tableId\r\n            ,url: BASE_WEB + 'func/train/list/data' // 数据接口\r\n            ,toolbar: '#headToolbarTpl'\r\n            ,cols: [[ //表头\r\n                {type:'checkbox', fixed: 'left'}\r\n                ,{field: 'title', title: '标题', width: 130}\r\n                ,{field: 'videoUrl', title: '路径'}\r\n                ,{field: 'descrption', title: '描述', width: 130}\r\n                ,{field: 'createTime', title: '创建时间', width: 130}\r\n                ,{field: '', title: '操作', width: 235, fixed: 'right', templet: '#rowToolbarTpl'}\r\n            ]]\r\n        }));\r\n\r\n        // 监听表格头部事件\r\n        table.on('toolbar(' + tableId + ')', function(obj){\r\n            var checkStatus = table.checkStatus(obj.config.id);\r\n            var checkData = checkStatus.data; // 得到选中的数据\r\n            switch(obj.event) {\r\n                case 'add':\r\n                    layer.open({\r\n                        type: 2\r\n                        ,title: '添加'\r\n                        ,content: BASE_WEB + 'func/train/edit'\r\n                        ,maxmin: true\r\n                        ,area: area   // 宽高\r\n                        ,btn: ['确定', '取消']\r\n                        ,yes: function(index, layero){\r\n                            //点击确认触发 iframe 内容中的按钮提交\r\n                            var submit = layero.find('iframe').contents().find(\"#kFormSubmit\");\r\n                            submit.click();\r\n                        }\r\n                    });\r\n                    break;\r\n                case 'batchdel':\r\n                    if(checkData.length === 0){\r\n                        return kvfKit.warningMsg('请选择数据');\r\n                    }\r\n                    layer.confirm('确定删除吗？', function(index) {\r\n                        var ids = [];\r\n                        $.each(checkData, function(i, n){\r\n                            ids[i] = n.id;\r\n                        });\r\n\r\n                        //执行 Ajax 后重载\r\n                        $.ajax({\r\n                            type: req.type.post,\r\n                            url: BASE_WEB + 'func/train/batchdel',\r\n                            data: {ids: ids.toString()},\r\n                            success: function (r) {\r\n                                if (r.code === req.status.ok) {\r\n                                    table.reload(tableId);\r\n                                    kvfKit.sucessMsg('已删除');\r\n                                } else {\r\n                                    kvfKit.errorMsg(r.msg);\r\n                                }\r\n                            }\r\n                        });\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n\r\n        // 表格行按钮 监听事件\r\n        table.on('tool(' + tableId + ')', function (obj) {\r\n            var data = obj.data; //获得当前行数据\r\n            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）\r\n            var tr = obj.tr; //获得当前行 tr 的DOM对象\r\n\r\n            if (layEvent === 'edit') {\r\n                layer.open({\r\n                    type: 2\r\n                    ,title: '编辑'\r\n                    ,content: BASE_WEB + 'func/train/edit?id=' + data.id\r\n                    ,maxmin: true\r\n                    ,area: area   // 宽高\r\n                    ,btn: ['确定', '取消']\r\n                    ,yes: function(index, layero){\r\n                        //点击确认触发 iframe 内容中的按钮提交\r\n                        var submit = layero.find('iframe').contents().find(\"#kFormSubmit\");\r\n                        submit.click();\r\n                    }\r\n                });\r\n            }\r\n            if (layEvent === 'del') {\r\n                layer.confirm('确定删除吗？', function(index) {\r\n                    //执行 Ajax 后重载\r\n                    $.ajax({\r\n                        type: req.type.post,\r\n                        url: BASE_WEB + 'func/train/del/' + data.id,\r\n                        async: false,\r\n                        success: function (r) {\r\n                            if (r.code === req.status.ok) {\r\n                                table.reload(tableId);\r\n                                kvfKit.sucessMsg('已删除');\r\n                            } else {\r\n                                kvfKit.errorMsg(r.msg);\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        });\r\n\r\n\r\n        // 监听查询\r\n        form.on('submit(kTableSearchFilter)', function (obj) {\r\n            renderTableData(obj.field);\r\n            return false;\r\n        });\r\n\r\n        var active = {\r\n            refresh: function () {\r\n                var $form = $('form');\r\n                $form[0].reset();\r\n                renderTableData(kvfKit.getFormJson($form));\r\n            }\r\n        };\r\n\r\n        kvfKit.activeInit(active);\r\n\r\n        function renderTableData(params) {\r\n            params = params ? params : {};\r\n\r\n            tableIns.reload({\r\n                where: params,\r\n                page: {curr: 1}\r\n            });\r\n        }\r\n\r\n        // 绑定监听回车事件\r\n        kvfKit.bindEnterEventForLayuiForm();\r\n\r\n    });\r\n</script>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/func/train.html b/src/main/resources/templates/func/train.html
--- a/src/main/resources/templates/func/train.html	
+++ b/src/main/resources/templates/func/train.html	
@@ -76,11 +76,10 @@
             ,toolbar: '#headToolbarTpl'
             ,cols: [[ //表头
                 {type:'checkbox', fixed: 'left'}
-                ,{field: 'title', title: '标题', width: 130}
-                ,{field: 'videoUrl', title: '路径'}
-                ,{field: 'descrption', title: '描述', width: 130}
-                ,{field: 'createTime', title: '创建时间', width: 130}
-                ,{field: '', title: '操作', width: 235, fixed: 'right', templet: '#rowToolbarTpl'}
+                ,{field: 'title', title: '标题', width: 200, align: 'center'}
+                ,{field: 'description', title: '描述', width: 300, align: 'center'}
+                ,{field: 'createTime', title: '创建时间', width: 180, align: 'center'}
+                ,{field: '', title: '操作', width: 235, fixed: 'right', templet: '#rowToolbarTpl', align: 'center'}
             ]]
         }));
 
Index: src/main/resources/static/html/index1.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n    <title>最红大脑</title>\r\n\r\n    <script src=\"../js/jquery.min.js\" type=\"text/javascript\"></script>\r\n    <script src=\"../js/vue.min.js\" type=\"text/javascript\"></script>\r\n    <style>\r\n        * {\r\n            margin: 0;\r\n            padding: 0;\r\n        }\r\n\r\n        html, body {\r\n            /*height: 100%;*/\r\n        }\r\n\r\n        li {\r\n            list-style: none;\r\n            height: 45px;\r\n            line-height: 45px;\r\n        }\r\n\r\n        .title {\r\n            width: 100%;\r\n            height: 40px;\r\n            line-height: 40px;\r\n            border: 1px solid bisque;\r\n            border-radius: 8px;\r\n            background-color: #1E90FF;\r\n            position: relative;\r\n            top: 5px;\r\n            margin: 0px auto;\r\n            color: white;\r\n        }\r\n    </style>\r\n</head>\r\n<body style=\"background-color: bisque\">\r\n<div id=\"news\" style=\"margin: 10px; height: 96%;border-radius: 8px\">\r\n    <div style=\"width:100%;text-align: center;height: 40px;\">\r\n        <p class=\"title\">技服中心最红大脑今日挑战</p></div>\r\n\r\n    <ul style=\"margin-top: 20px;border-radius: 8px;background-color: white;\">\r\n        <li v-for=\"(item,index) in wxRank\" @click=\"goto(item.userid)\">\r\n            <div style=\"float: left; width: 20%;height:45px;text-align: right;\">{{index + 1}}</div>\r\n            <div style=\"float: left; width: 50%;height:45px;text-align: center;font-weight: 600\">\r\n                <img style=\"width: 32px; border-radius: 50%; margin: 7px;\" :src=item.avatar>\r\n                <span style=\"position: absolute;font-size: 14px\">{{item.realname}}</span>\r\n            </div>\r\n            <div v-if=\"item.todayCnt === 0\"  style=\"float: left; width: 30%;height:45px;text-align: center;color: red\">未挑战</div>\r\n            <div v-else style=\"float: left; width: 30%;height:45px;text-align: center;color: green\">已挑战</div>\r\n        </li>\r\n    </ul>\r\n</div>\r\n<script>\r\n    var news = new Vue({\r\n        el: '#news',\r\n        data: {\r\n            wxRank: []\r\n        }\r\n    });\r\n\r\n    getUserrank();\r\n\r\n    function getUserrank() {\r\n        $.ajax({\r\n            url: \"https://dangshi.nhgaj.com/func/userTab/getUserList\",\r\n            // url: \"http://localhost:5566/func/userTab/getUserList\",\r\n            type: \"get\",\r\n            dataType: \"json\",\r\n            success: function (r) {\r\n                news.wxRank = r.data;\r\n            },\r\n            error: function (data) {\r\n                alert(JSON.stringify(data));\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 跳转到详情\r\n     * @param userid\r\n     */\r\n    function goto(userid){\r\n        window.location.href = 'userundo.html?userid=' + userid;\r\n    }\r\n</script>\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/static/html/index1.html b/src/main/resources/static/html/index1.html
--- a/src/main/resources/static/html/index1.html	
+++ b/src/main/resources/static/html/index1.html	
@@ -41,7 +41,6 @@
 <div id="news" style="margin: 10px; height: 96%;border-radius: 8px">
     <div style="width:100%;text-align: center;height: 40px;">
         <p class="title">技服中心最红大脑今日挑战</p></div>
-
     <ul style="margin-top: 20px;border-radius: 8px;background-color: white;">
         <li v-for="(item,index) in wxRank" @click="goto(item.userid)">
             <div style="float: left; width: 20%;height:45px;text-align: right;">{{index + 1}}</div>
Index: src/main/resources/static/html/index.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n    <title>微信用户统计</title>\r\n\r\n    <script src=\"js/jquery.min.js\" type=\"text/javascript\"></script>\r\n    <script src=\"js/vue.min.js\" type=\"text/javascript\"></script>\r\n    <style>\r\n        * {\r\n            margin: 0;\r\n            padding: 0;\r\n        }\r\n\r\n        html, body {\r\n            /*height: 100%;*/\r\n        }\r\n\r\n        li {\r\n            list-style: none;\r\n            height: 45px;\r\n            line-height: 45px;\r\n        }\r\n\r\n        .title {\r\n            width: 100%;\r\n            height: 40px;\r\n            line-height: 40px;\r\n            border: 1px solid bisque;\r\n            border-radius: 8px;\r\n            background-color: #1E90FF;\r\n            position: relative;\r\n            top: 5px;\r\n            margin: 0px auto;\r\n            color: white;\r\n        }\r\n\r\n        .div1 {\r\n            width: 100%;\r\n            height: 40px;\r\n            text-align: center;\r\n            margin: 0px auto;\r\n            border-radius: 10px;\r\n            padding-top: 15px;\r\n        }\r\n\r\n        .ljrs {\r\n            width: 49%;\r\n            float: left;\r\n            text-align: center;\r\n            background: white;\r\n            border-radius: 10px;\r\n            padding: 5px 0px;\r\n        }\r\n\r\n        .jrrs {\r\n            width: 49%;\r\n            float: left;\r\n            text-align: center;\r\n            background: white;\r\n            border-radius: 10px;\r\n            padding: 5px 0px;\r\n            margin-left: 2%;\r\n        }\r\n    </style>\r\n</head>\r\n<body style=\"background-color: bisque\">\r\n<div id=\"news\" style=\"margin: 10px; height: 96%;border-radius: 8px\">\r\n    <div style=\"width:100%;text-align: center;height: 40px;\">\r\n        <p class=\"title\">微信用户排行榜（个人）</p></div>\r\n\r\n    <ul style=\"margin-top: 20px;border-radius: 8px;background-color: white;\">\r\n        <li>\r\n            <div style=\"float: left; width: 20%;text-align: center;font-size: 20px;font-weight: 500;color: #d84f4b;\">\r\n                排名\r\n            </div>\r\n            <div style=\"float: left; width: 55%;text-align: center;font-size: 20px;font-weight: 500;color: #d84f4b;\">\r\n                微信昵称\r\n            </div>\r\n            <div style=\"float: left; width: 25%;text-align: center;font-size: 20px;font-weight: 500;color: #d84f4b;\">\r\n                积分\r\n            </div>\r\n        </li>\r\n\r\n        <li v-for=\"(item,index) in wxRank\">\r\n            <div v-if=\"index == 0\" style=\"float: left; width: 20%;text-align: center;height: 45px;\"><img src=\"image/logo/冠军.png\" width=\"32\" style=\"vertical-align: middle;\"></div>\r\n            <div v-else-if=\"index == 1\" style=\"float: left; width: 20%;text-align: center;height: 45px;\"><img src=\"image/logo/亚军.png\" width=\"32\" style=\"vertical-align: middle;\"></div>\r\n            <div v-else-if=\"index == 2\" style=\"float: left; width: 20%;text-align: center;height: 45px;\"><img src=\"image/logo/季军.png\" width=\"32\" style=\"vertical-align: middle;\"></div>\r\n            <div v-else style=\"float: left; width: 20%;height:45px;text-align: center;\">{{index+1}}</div>\r\n            <div style=\"float: left; width: 55%;height:45px;text-align: left;font-weight: 600\">\r\n                <img style=\"width: 32px; border-radius: 50%; margin: 7px;\" :src=item.headimgurl>\r\n                <span style=\"position: absolute;font-size: 14px\">{{item.nickname}}</span>\r\n            </div>\r\n            <div style=\"float: left; width: 25%;height:45px;text-align: center;font-size: 20px;font-weight: 500\">\r\n                {{item.jf}}\r\n            </div>\r\n        </li>\r\n    </ul>\r\n\r\n    <div style=\"margin: 20px\">\r\n        <p id=\"time\" style=\"font-size: 13px; color: blue; text-align: right;\"></p>\r\n    </div>\r\n</div>\r\n<script>\r\n    var news = new Vue({\r\n        el: '#news',\r\n        data: {\r\n            wxRank: []\r\n        }\r\n    });\r\n\r\n    getDeptrank();\r\n\r\n    function getDeptrank() {\r\n        $.ajax({\r\n            url: \"http://nhmsfz.nhgaj.com/func/wxUser/getWxRank\",\r\n            type: \"get\",\r\n            dataType: \"json\",\r\n            success: function (r) {\r\n                news.wxRank = r.data;\r\n                $('#time').text('统计截止时间：' + getNowFormatDate());\r\n            },\r\n            error: function (data) {\r\n                alert(JSON.stringify(data));\r\n            }\r\n        });\r\n    }\r\n\r\n    function getNowFormatDate() {\r\n        var date = new Date();\r\n        var seperator1 = \"-\";\r\n        var seperator2 = \":\";\r\n        var month = date.getMonth() + 1;\r\n        var strDate = date.getDate();\r\n        if (month >= 1 && month <= 9) {\r\n            month = \"0\" + month;\r\n        }\r\n        if (strDate >= 0 && strDate <= 9) {\r\n            strDate = \"0\" + strDate;\r\n        }\r\n        var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate\r\n            + \" \" + date.getHours() + seperator2 + date.getMinutes()\r\n            + seperator2 + date.getSeconds();\r\n\r\n        return currentdate;\r\n    }\r\n</script>\r\n<script type=\"text/javascript\" src=\"//js.users.51.la/20911027.js\"></script>\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/static/html/index.html b/src/main/resources/static/html/index.html
--- a/src/main/resources/static/html/index.html	
+++ b/src/main/resources/static/html/index.html	
@@ -3,10 +3,10 @@
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
-    <title>微信用户统计</title>
+    <title>最红大脑</title>
 
-    <script src="js/jquery.min.js" type="text/javascript"></script>
-    <script src="js/vue.min.js" type="text/javascript"></script>
+    <script src="../js/jquery.min.js" type="text/javascript"></script>
+    <script src="../js/vue.min.js" type="text/javascript"></script>
     <style>
         * {
             margin: 0;
@@ -35,74 +35,46 @@
             margin: 0px auto;
             color: white;
         }
-
-        .div1 {
-            width: 100%;
-            height: 40px;
-            text-align: center;
-            margin: 0px auto;
-            border-radius: 10px;
-            padding-top: 15px;
-        }
-
-        .ljrs {
-            width: 49%;
-            float: left;
-            text-align: center;
-            background: white;
-            border-radius: 10px;
-            padding: 5px 0px;
-        }
-
-        .jrrs {
-            width: 49%;
-            float: left;
-            text-align: center;
-            background: white;
-            border-radius: 10px;
-            padding: 5px 0px;
-            margin-left: 2%;
-        }
     </style>
 </head>
 <body style="background-color: bisque">
 <div id="news" style="margin: 10px; height: 96%;border-radius: 8px">
     <div style="width:100%;text-align: center;height: 40px;">
-        <p class="title">微信用户排行榜（个人）</p></div>
+        <p class="title">最红大脑部门挑战统计</p></div>
 
     <ul style="margin-top: 20px;border-radius: 8px;background-color: white;">
         <li>
-            <div style="float: left; width: 20%;text-align: center;font-size: 20px;font-weight: 500;color: #d84f4b;">
-                排名
+            <div style="float: left; width: 40%;text-align: center;font-size: 15px;font-weight: 500;color: #d84f4b;">
+                部门
             </div>
-            <div style="float: left; width: 55%;text-align: center;font-size: 20px;font-weight: 500;color: #d84f4b;">
-                微信昵称
+            <div style="float: left; width: 30%;text-align: center;font-size: 15px;font-weight: 500;color: #d84f4b;">
+                总人数
             </div>
-            <div style="float: left; width: 25%;text-align: center;font-size: 20px;font-weight: 500;color: #d84f4b;">
-                积分
+            <div style="float: left; width: 30%;text-align: center;font-size: 15px;font-weight: 500;color: #d84f4b;">
+                今日未挑战人数
             </div>
         </li>
 
         <li v-for="(item,index) in wxRank">
-            <div v-if="index == 0" style="float: left; width: 20%;text-align: center;height: 45px;"><img src="image/logo/冠军.png" width="32" style="vertical-align: middle;"></div>
-            <div v-else-if="index == 1" style="float: left; width: 20%;text-align: center;height: 45px;"><img src="image/logo/亚军.png" width="32" style="vertical-align: middle;"></div>
-            <div v-else-if="index == 2" style="float: left; width: 20%;text-align: center;height: 45px;"><img src="image/logo/季军.png" width="32" style="vertical-align: middle;"></div>
-            <div v-else style="float: left; width: 20%;height:45px;text-align: center;">{{index+1}}</div>
-            <div style="float: left; width: 55%;height:45px;text-align: left;font-weight: 600">
-                <img style="width: 32px; border-radius: 50%; margin: 7px;" :src=item.headimgurl>
-                <span style="position: absolute;font-size: 14px">{{item.nickname}}</span>
+            <div style="float: left; width: 40%;height:45px;text-align: center;">{{item.deptName}}</div>
+            <div style="float: left; width: 30%;text-align: center;font-size: 20px;font-weight: 500;color: #d84f4b;">
+                {{item.allCount}}
             </div>
-            <div style="float: left; width: 25%;height:45px;text-align: center;font-size: 20px;font-weight: 500">
-                {{item.jf}}
+            <div @click="goto(item.deptName)" style="float: left; width: 30%;text-align: center;font-size: 20px;font-weight: 500;color: blue;text-decoration:underline">
+                {{item.allCount - item.todayPerson}}
             </div>
         </li>
     </ul>
-
-    <div style="margin: 20px">
-        <p id="time" style="font-size: 13px; color: blue; text-align: right;"></p>
-    </div>
 </div>
 <script>
+    (function ($) {
+        $.getUrlParam = function (name) {
+            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
+            var r = window.location.search.substr(1).match(reg);
+            if (r != null) return unescape(r[2]); return null;
+        }
+    })(jQuery);
+
     var news = new Vue({
         el: '#news',
         data: {
@@ -110,16 +82,21 @@
         }
     });
 
-    getDeptrank();
+    let url = "https://dangshi.nhgaj.com/func/userTab/getDeptSys";
+    // let url = "http://localhost:5566/func/userTab/getDeptSys";
+    let date = $.getUrlParam('date');
+    if(date != null){
+        url = url + '?date=' + date;
+    }
 
-    function getDeptrank() {
+    getDeptRank();
+    function getDeptRank() {
         $.ajax({
-            url: "http://nhmsfz.nhgaj.com/func/wxUser/getWxRank",
+            url: url,
             type: "get",
             dataType: "json",
             success: function (r) {
                 news.wxRank = r.data;
-                $('#time').text('统计截止时间：' + getNowFormatDate());
             },
             error: function (data) {
                 alert(JSON.stringify(data));
@@ -127,25 +104,14 @@
         });
     }
 
-    function getNowFormatDate() {
-        var date = new Date();
-        var seperator1 = "-";
-        var seperator2 = ":";
-        var month = date.getMonth() + 1;
-        var strDate = date.getDate();
-        if (month >= 1 && month <= 9) {
-            month = "0" + month;
-        }
-        if (strDate >= 0 && strDate <= 9) {
-            strDate = "0" + strDate;
-        }
-        var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
-            + " " + date.getHours() + seperator2 + date.getMinutes()
-            + seperator2 + date.getSeconds();
-
-        return currentdate;
+    /**
+     * 跳转
+     * @param deptName
+     */
+    function goto(deptName) {
+        let url = 'userundo.html?deptName=' + deptName + '&date=' + date;
+        window.location.href = url;
     }
 </script>
-<script type="text/javascript" src="//js.users.51.la/20911027.js"></script>
 </body>
 </html>
\ No newline at end of file
Index: src/main/java/com/kalvin/kvf/common/constant/UploadPathEnum.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.common.constant;\r\n\r\n/**\r\n * 上传路径枚举\r\n * @author Kalvin\r\n */\r\npublic enum UploadPathEnum {\r\n    FILE_PATH(\"file\", \"file\"),   // 默认其它文件路径\r\n    IMAGE_PATH(\"image\", \"image\"), // 默认图片路径\r\n    DOC_PATH(\"doc\", \"doc\"),     // 默认文档路径\r\n    HEAD_PATH(\"avatar\", \"avatar\"),  // 默认用户头像路径\r\n    UE_EDITOR_PATH(\"ueditor\", \"ueditor\");  // 默认UEditor上传目录\r\n\r\n    private String type;\r\n    private String path;\r\n\r\n    UploadPathEnum(String type, String path) {\r\n        this.type = type;\r\n        this.path = path;\r\n    }\r\n\r\n    public static UploadPathEnum get(String type) {\r\n        for (UploadPathEnum pathEnum : values()) {\r\n            if (pathEnum.getType().equals(type)) {\r\n                return pathEnum;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public String getType() {\r\n        return type;\r\n    }\r\n\r\n    public String getPath() {\r\n        return path;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/common/constant/UploadPathEnum.java b/src/main/java/com/kalvin/kvf/common/constant/UploadPathEnum.java
--- a/src/main/java/com/kalvin/kvf/common/constant/UploadPathEnum.java	
+++ b/src/main/java/com/kalvin/kvf/common/constant/UploadPathEnum.java	
@@ -7,6 +7,7 @@
 public enum UploadPathEnum {
     FILE_PATH("file", "file"),   // 默认其它文件路径
     IMAGE_PATH("image", "image"), // 默认图片路径
+    VIDEO_PATH("video", "video"), // 默认图片路径
     DOC_PATH("doc", "doc"),     // 默认文档路径
     HEAD_PATH("avatar", "avatar"),  // 默认用户头像路径
     UE_EDITOR_PATH("ueditor", "ueditor");  // 默认UEditor上传目录
Index: src/main/resources/static/html/rank.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title></title>\r\n    <link rel=\"stylesheet\" href=\"/static/css/style.css\">\r\n    <style>\r\n\r\n        @import url('https://fonts.googleapis.com/css?family=Muli&display=swap');\r\n\r\n        * {\r\n            box-sizing: border-box;\r\n        }\r\n\r\n        body {\r\n            background: linear-gradient(to right, #9796f0, #fbc7d4);\r\n            color: #333;\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            justify-content: center;\r\n            font-family: 'Muli';\r\n            height: 100vh;\r\n            margin: 0;\r\n        }\r\n\r\n        .reviews-container {\r\n            background-color: transparent;\r\n            border-radius: 5px;\r\n            box-shadow: 0 3px 10px -5px rgba(0, 0, 0, 0.3);\r\n            padding: 20px;\r\n            position: absolute;\r\n            top: 0px;\r\n            bottom: 0px;\r\n            left: 0px;\r\n            right: 0px;\r\n            /* background-image:url(image/下载.png);\r\n            background-repeat:no-repeat;\r\n            background-size:100% 100%;\r\n            -moz-background-size:100% 100%; */\r\n        }\r\n\r\n        .review {\r\n            border: 1px solid transparent;\r\n            border-radius: 5px;\r\n            color: white;\r\n            display: flex;\r\n            font-size: 35px;\r\n            align-items: center;\r\n            padding: 10px;\r\n            margin: 5px 0;\r\n            float: left;\r\n            width: 100%;\r\n\r\n        }\r\n\r\n        .review:hover {\r\n            border: 1px solid #ddd;\r\n            box-shadow: 0 3px 10px -5px rgba(0, 0, 0, 0.7);\r\n        }\r\n\r\n        .progress {\r\n            background-color: rgba(100, 100, 100, 0.2);\r\n            border-radius: 5px;\r\n            position: relative;\r\n            margin: 0 10px;\r\n            width: 57%;\r\n            height: 41px;\r\n        }\r\n\r\n        .progress-done {\r\n            background: linear-gradient(to left, rgb(236, 161, 161), rgb(239, 199, 199));\r\n\r\n            border-radius: 5px;\r\n            height: 41px;\r\n            width: 0;\r\n            transition: width 1s ease 0.3s;\r\n        }\r\n\r\n        .percent {\r\n            color: white;\r\n            width: 15%;\r\n            display: inline-block;\r\n        }\r\n\r\n        /* SOCIAL PANEL CSS */\r\n        .social-panel-container {\r\n            position: fixed;\r\n            right: 0;\r\n            bottom: 80px;\r\n            transform: translateX(100%);\r\n            transition: transform 0.4s ease-in-out;\r\n        }\r\n\r\n        .social-panel-container.visible {\r\n            transform: translateX(-10px);\r\n        }\r\n\r\n        .social-panel {\r\n            background-color: #fff;\r\n            border-radius: 16px;\r\n            box-shadow: 0 16px 31px -17px rgba(0, 31, 97, 0.6);\r\n            border: 5px solid #001F61;\r\n            display: flex;\r\n            flex-direction: column;\r\n            justify-content: center;\r\n            align-items: center;\r\n            font-family: 'Muli';\r\n            position: relative;\r\n            height: 169px;\r\n            width: 370px;\r\n            max-width: calc(100% - 10px);\r\n        }\r\n\r\n        .social-panel button.close-btn {\r\n            border: 0;\r\n            color: #97A5CE;\r\n            cursor: pointer;\r\n            font-size: 20px;\r\n            position: absolute;\r\n            top: 5px;\r\n            right: 5px;\r\n        }\r\n\r\n        .social-panel button.close-btn:focus {\r\n            outline: none;\r\n        }\r\n\r\n        .social-panel p {\r\n            background-color: #001F61;\r\n            border-radius: 0 0 10px 10px;\r\n            color: #fff;\r\n            font-size: 14px;\r\n            line-height: 18px;\r\n            padding: 2px 17px 6px;\r\n            position: absolute;\r\n            top: 0;\r\n            left: 50%;\r\n            margin: 0;\r\n            transform: translateX(-50%);\r\n            text-align: center;\r\n            width: 235px;\r\n        }\r\n\r\n        .social-panel p i {\r\n            margin: 0 5px;\r\n        }\r\n\r\n        .social-panel p a {\r\n            color: #FF7500;\r\n            text-decoration: none;\r\n        }\r\n\r\n        .social-panel h4 {\r\n            margin: 20px 0;\r\n            color: #97A5CE;\r\n            font-family: 'Muli';\r\n            font-size: 14px;\r\n            line-height: 18px;\r\n            text-transform: uppercase;\r\n        }\r\n\r\n        .social-panel ul {\r\n            display: flex;\r\n            list-style-type: none;\r\n            padding: 0;\r\n            margin: 0;\r\n        }\r\n\r\n        .social-panel ul li {\r\n            margin: 0 10px;\r\n        }\r\n\r\n        .social-panel ul li a {\r\n            border: 1px solid #DCE1F2;\r\n            border-radius: 50%;\r\n            color: #001F61;\r\n            font-size: 20px;\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            height: 50px;\r\n            width: 50px;\r\n            text-decoration: none;\r\n        }\r\n\r\n        .social-panel ul li a:hover {\r\n            border-color: #FF6A00;\r\n            box-shadow: 0 9px 12px -9px #FF6A00;\r\n        }\r\n\r\n        .floating-btn {\r\n            border-radius: 26.5px;\r\n            background-color: #001F61;\r\n            border: 1px solid #001F61;\r\n            box-shadow: 0 16px 22px -17px #03153B;\r\n            color: #fff;\r\n            cursor: pointer;\r\n            font-size: 16px;\r\n            line-height: 20px;\r\n            padding: 12px 20px;\r\n            position: fixed;\r\n            bottom: 20px;\r\n            right: 20px;\r\n            z-index: 999;\r\n        }\r\n\r\n        .floating-btn:hover {\r\n            background-color: #ffffff;\r\n            color: #001F61;\r\n        }\r\n\r\n        .floating-btn:focus {\r\n            outline: none;\r\n        }\r\n\r\n        .floating-text {\r\n            background-color: #001F61;\r\n            border-radius: 10px 10px 0 0;\r\n            color: #fff;\r\n            font-family: 'Muli';\r\n            padding: 7px 15px;\r\n            position: fixed;\r\n            bottom: 0;\r\n            left: 50%;\r\n            transform: translateX(-50%);\r\n            text-align: center;\r\n            z-index: 998;\r\n        }\r\n\r\n        .floating-text a {\r\n            color: #FF7500;\r\n            text-decoration: none;\r\n        }\r\n\r\n        @media screen and (max-width: 480px) {\r\n\r\n            .social-panel-container.visible {\r\n                transform: translateX(0px);\r\n            }\r\n\r\n            .floating-btn {\r\n                right: 10px;\r\n            }\r\n        }\r\n\r\n\r\n    </style>\r\n    <style>\r\n\r\n\r\n        .review {\r\n            height: 7.60%;\r\n\r\n        }\r\n\r\n        .icon-container {\r\n            width: 23%;\r\n            display: inline-block;\r\n            text-align: right;\r\n            white-space: nowrap;\r\n            overflow: hidden;\r\n            text-overflow: ellipsis;\r\n        }\r\n\r\n        .active {\r\n            font-size: 45px !important;\r\n            font-weight: bold !important;\r\n        }\r\n\r\n        .active .progress-done {\r\n            background: linear-gradient(to left, rgb(106, 143, 247), rgb(191, 198, 236)) !important;\r\n            height: 45px !important;\r\n        }\r\n\r\n        .active .progress {\r\n            height: 45px !important;\r\n        }\r\n\r\n        .active .icon-container {\r\n            color: rgb(106, 143, 247) !important;\r\n        }\r\n\r\n        .active .percent {\r\n            color: rgb(106, 143, 247) !important;\r\n        }\r\n\r\n\r\n        .codrops-demos {\r\n            font-size: 0.8em;\r\n            text-align: center;\r\n            position: absolute;\r\n            z-index: 99;\r\n            width: 96%;\r\n        }\r\n\r\n        .codrops-demos a {\r\n            display: inline-block;\r\n            margin: 0.35em 0.1em;\r\n            padding: 0.5em 1.2em;\r\n            outline: none;\r\n            text-decoration: none;\r\n            text-transform: uppercase;\r\n            letter-spacing: 1px;\r\n            font-weight: 700;\r\n            border-radius: 2px;\r\n            font-size: 110%;\r\n            border: 2px solid transparent;\r\n            color: #fff;\r\n        }\r\n\r\n        .codrops-demos a:hover,\r\n        .codrops-demos a.current-demo {\r\n            border-color: #383a3c;\r\n        }\r\n\r\n        video {\r\n            position: fixed;\r\n        / / 视频定位方式设为固定 right: 0;\r\n            bottom: 0;\r\n        / / 视频位置 min-width: 100 %;\r\n            min-height: 100%;\r\n        / / 不会因视频尺寸造成页面需要滚动 width: auto;\r\n            height: auto;\r\n        / / 尺寸保持原视频大小 z-index: - 100;\r\n        / / z轴定位，小于0即可 -webkit-filter: grayscale(20 %);\r\n        / / 添加灰度蒙版，如果设定为100 % 则视频显示为黑白\r\n        }\r\n\r\n\r\n    </style>\r\n</head>\r\n<body>\r\n<video loop=\"loop\" autoplay=\"autoplay\" id=\"bgvid\" muted=\"muted\">\r\n    <source src=\"bg.mp4\" type=\"video/mp4\">\r\n</video>\r\n<!-- <canvas id=\"canvas\"></canvas> -->\r\n<div class=\"reviews-container\" style=\"width:100%;height:100%;\">\r\n    <div style=\"color: white;font-weight:bold;text-align:center;font-size: 55px;position:absolute;height:100px;top:0px;left:0px;right:0px;line-height:100px;padding-top:10px;\">\r\n        新&nbsp;警&nbsp;测&nbsp;试&nbsp;排&nbsp;名\r\n    </div>\r\n\r\n    <div style=\"position:absolute;top:100px;left:0px;right:0px;bottom:0px;\">\r\n        <div class=\"review\" id=\"group0\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n        <div class=\"review\" id=\"group1\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n        <div class=\"review\" id=\"group2\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n\r\n        <div class=\"review\" id=\"group3\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n\r\n        <div class=\"review\" id=\"group4\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n\r\n        <div class=\"review\" id=\"group5\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n\r\n        <div class=\"review\" id=\"group6\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n\r\n        <div class=\"review\" id=\"group7\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n\r\n        <div class=\"review\" id=\"group8\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n\r\n        <div class=\"review\" id=\"group9\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n\r\n        <div class=\"review\" id=\"group10\">\r\n            <span class=\"icon-container\"></span>\r\n            <div class=\"progress\">\r\n                <div class=\"progress-done\" data-done=\"\"></div>\r\n            </div>\r\n            <span class=\"percent\"></span>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n<script src=\"/static/js/jquery.min.js\"></script>\r\n<script src=\"/static/js/layer.js\"></script>\r\n\r\n\r\n<script>\r\n\r\n    $(function () {\r\n        refresh();\r\n        setInterval(\"refresh()\", 2000);\r\n    });\r\n\r\n    function refresh() {\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: 'daping/page1',\r\n            dataType: \"json\",\r\n            success: function (json) {\r\n                // $(\".review\").removeClass('active');\r\n                $.each(json, function (index, value) {\r\n                    $(\"#group\" + index).find('.icon-container').html(value.department);\r\n                    $(\"#group\" + index).find('.progress-done').attr('data-done', value.score_avg);\r\n                    $(\"#group\" + index).find('.percent').html(value.score_avg);\r\n                    // if (value.current) {\r\n                    //     $(\"#group\" + index).addClass('active');\r\n                    // }\r\n                });\r\n\r\n                const progressDone = document.querySelectorAll('.progress-done');\r\n\r\n                progressDone.forEach(progress => {\r\n                    progress.style.width = progress.getAttribute('data-done') + '%';\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    function goToResultPage() {\r\n        window.location.href = \"page1_result.html\";\r\n    }\r\n\r\n</script>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/static/html/rank.html b/src/main/resources/static/html/rank.html
--- a/src/main/resources/static/html/rank.html	
+++ b/src/main/resources/static/html/rank.html	
@@ -3,7 +3,7 @@
 <head>
     <meta charset="UTF-8">
     <title></title>
-    <link rel="stylesheet" href="/static/css/style.css">
+<!--    <link rel="stylesheet" href="/static/css/style.css">-->
     <style>
 
         @import url('https://fonts.googleapis.com/css?family=Muli&display=swap');
@@ -45,10 +45,10 @@
             border-radius: 5px;
             color: white;
             display: flex;
-            font-size: 35px;
+            font-size: 25px;
             align-items: center;
-            padding: 10px;
-            margin: 5px 0;
+            padding: 2px;
+            margin: 2px 0;
             float: left;
             width: 100%;
 
@@ -65,14 +65,13 @@
             position: relative;
             margin: 0 10px;
             width: 57%;
-            height: 41px;
+            height: 30px;
         }
 
         .progress-done {
             background: linear-gradient(to left, rgb(236, 161, 161), rgb(239, 199, 199));
-
             border-radius: 5px;
-            height: 41px;
+            height: 30px;
             width: 0;
             transition: width 1s ease 0.3s;
         }
@@ -336,95 +335,349 @@
 </video>
 <!-- <canvas id="canvas"></canvas> -->
 <div class="reviews-container" style="width:100%;height:100%;">
-    <div style="color: white;font-weight:bold;text-align:center;font-size: 55px;position:absolute;height:100px;top:0px;left:0px;right:0px;line-height:100px;padding-top:10px;">
+    <div style="color: white;font-weight:bold;text-align:center;font-size: 55px;position:absolute;height:100px;top:0px;left:0px;right:0px;line-height:100px;">
         新&nbsp;警&nbsp;测&nbsp;试&nbsp;排&nbsp;名
     </div>
 
     <div style="position:absolute;top:100px;left:0px;right:0px;bottom:0px;">
-        <div class="review" id="group0">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
-        </div>
-        <div class="review" id="group1">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
+        <div style="display:flex;">
+            <div class="review" id="group0">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+            <div class="review" id="group1">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
         </div>
-        <div class="review" id="group2">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
-        </div>
+        <div style="display:flex;">
+            <div class="review" id="group2">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
 
-        <div class="review" id="group3">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
+            <div class="review" id="group3">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
         </div>
-
-        <div class="review" id="group4">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
-        </div>
+        <div style="display:flex;">
+            <div class="review" id="group4">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
 
-        <div class="review" id="group5">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
+            <div class="review" id="group5">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
         </div>
-
-        <div class="review" id="group6">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
-        </div>
+        <div style="display:flex;">
+            <div class="review" id="group6">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
 
-        <div class="review" id="group7">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
+            <div class="review" id="group7">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
         </div>
-
-        <div class="review" id="group8">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
-        </div>
+        <div style="display:flex;">
+            <div class="review" id="group8">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
 
-        <div class="review" id="group9">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
+            <div class="review" id="group9">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
         </div>
-
-        <div class="review" id="group10">
-            <span class="icon-container"></span>
-            <div class="progress">
-                <div class="progress-done" data-done=""></div>
-            </div>
-            <span class="percent"></span>
+        <div style="display:flex;">
+            <div class="review" id="group10">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+
+            <div class="review" id="group11">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group12">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group13">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group14">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group15">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group16">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group17">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group18">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group19">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group20">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group21">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group22">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+            <div class="review" id="group23">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group24">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group25">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group26">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group27">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group28">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group29">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group30">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group31">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+
+            <div class="review" id="group32">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+            <div class="review" id="group33">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group34">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group35">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group36">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group37">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+        </div>
+        <div style="display:flex;">
+            <div class="review" id="group38">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
+
+            <div class="review" id="group39">
+                <span class="icon-container"></span>
+                <div class="progress">
+                    <div class="progress-done" data-done=""></div>
+                </div>
+                <span class="percent"></span>
+            </div>
         </div>
     </div>
 
@@ -443,14 +696,14 @@
     function refresh() {
         $.ajax({
             type: 'GET',
-            url: 'daping/page1',
+            url: '/func/infoTestRecord/getTop40',
             dataType: "json",
-            success: function (json) {
+            success: function (res) {
                 // $(".review").removeClass('active');
-                $.each(json, function (index, value) {
-                    $("#group" + index).find('.icon-container').html(value.department);
-                    $("#group" + index).find('.progress-done').attr('data-done', value.score_avg);
-                    $("#group" + index).find('.percent').html(value.score_avg);
+                $.each(res.data, function (index, value) {
+                    $("#group" + index).find('.icon-container').html((index + 1) + '-' + value.userName);
+                    $("#group" + index).find('.progress-done').attr('data-done', value.score);
+                    $("#group" + index).find('.percent').html(value.score);
                     // if (value.current) {
                     //     $("#group" + index).addClass('active');
                     // }
@@ -465,11 +718,6 @@
         });
     }
 
-
-    function goToResultPage() {
-        window.location.href = "page1_result.html";
-    }
-
 </script>
 
 </body>
Index: src/main/resources/static/html/userundo.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n    <title>最红大脑</title>\r\n\r\n    <script src=\"../js/jquery.min.js\" type=\"text/javascript\"></script>\r\n    <script src=\"../js/vue.min.js\" type=\"text/javascript\"></script>\r\n    <style>\r\n        * {\r\n            margin: 0;\r\n            padding: 0;\r\n        }\r\n\r\n        html, body {\r\n            /*height: 100%;*/\r\n        }\r\n\r\n        li {\r\n            list-style: none;\r\n            height: 45px;\r\n            line-height: 45px;\r\n        }\r\n\r\n        .title {\r\n            width: 100%;\r\n            height: 40px;\r\n            line-height: 40px;\r\n            border: 1px solid bisque;\r\n            border-radius: 8px;\r\n            background-color: #1E90FF;\r\n            position: relative;\r\n            top: 5px;\r\n            margin: 0px auto;\r\n            color: white;\r\n        }\r\n\r\n        .div1 {\r\n            width: 100%;\r\n            height: 40px;\r\n            text-align: center;\r\n            margin: 0px auto;\r\n            border-radius: 10px;\r\n            padding-top: 15px;\r\n        }\r\n\r\n        .ljrs {\r\n            width: 49%;\r\n            float: left;\r\n            text-align: center;\r\n            background: white;\r\n            border-radius: 10px;\r\n            padding: 5px 0px;\r\n        }\r\n\r\n        .jrrs {\r\n            width: 49%;\r\n            float: left;\r\n            text-align: center;\r\n            background: white;\r\n            border-radius: 10px;\r\n            padding: 5px 0px;\r\n            margin-left: 2%;\r\n        }\r\n    </style>\r\n</head>\r\n<body style=\"background-color: bisque\">\r\n<div id=\"news\" style=\"margin: 10px; height: 96%;border-radius: 8px\">\r\n    <div style=\"width:100%;text-align: center;height: 40px;\">\r\n        <p class=\"title\">最红大脑技服中心今日未挑战人员</p></div>\r\n\r\n    <ul style=\"margin-top: 20px;border-radius: 8px;background-color: white;\">\r\n        <li v-for=\"(item,index) in wxRank\" @click=\"goto(item.userid)\">\r\n            <div style=\"float: left; width: 50%;height:45px;text-align: center;\">{{index + 1}}</div>\r\n            <div style=\"float: right; width: 50%;height:45px;text-align: left;font-weight: 600\">\r\n                <img style=\"width: 32px; border-radius: 50%; margin: 7px;\" :src=item.avatar>\r\n                <span style=\"position: absolute;font-size: 14px\">{{item.realname}}</span>\r\n            </div>\r\n        </li>\r\n    </ul>\r\n</div>\r\n<script>\r\n    var news = new Vue({\r\n        el: '#news',\r\n        data: {\r\n            wxRank: []\r\n        }\r\n    });\r\n\r\n    getUserrank();\r\n\r\n    function getUserrank() {\r\n        $.ajax({\r\n            // url: \"https://dangshi.nhgaj.com/func/userTab/getUserList\",\r\n            url: \"http://localhost:5566/func/userTab/getUserList\",\r\n            type: \"get\",\r\n            dataType: \"json\",\r\n            success: function (r) {\r\n                news.wxRank = r.data;\r\n            },\r\n            error: function (data) {\r\n                alert(JSON.stringify(data));\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 跳转到详情\r\n     * @param userid\r\n     */\r\n    function goto(userid){\r\n        alert(userid);\r\n    }\r\n</script>\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/static/html/userundo.html b/src/main/resources/static/html/userundo.html
--- a/src/main/resources/static/html/userundo.html	
+++ b/src/main/resources/static/html/userundo.html	
@@ -35,83 +35,82 @@
             margin: 0px auto;
             color: white;
         }
-
-        .div1 {
-            width: 100%;
-            height: 40px;
-            text-align: center;
-            margin: 0px auto;
-            border-radius: 10px;
-            padding-top: 15px;
-        }
-
-        .ljrs {
-            width: 49%;
-            float: left;
-            text-align: center;
-            background: white;
-            border-radius: 10px;
-            padding: 5px 0px;
-        }
-
-        .jrrs {
-            width: 49%;
-            float: left;
-            text-align: center;
-            background: white;
-            border-radius: 10px;
-            padding: 5px 0px;
-            margin-left: 2%;
-        }
     </style>
 </head>
 <body style="background-color: bisque">
 <div id="news" style="margin: 10px; height: 96%;border-radius: 8px">
     <div style="width:100%;text-align: center;height: 40px;">
-        <p class="title">最红大脑技服中心今日未挑战人员</p></div>
+        <p class="title">{{deptName}}{{date}}未挑战人员</p></div>
 
     <ul style="margin-top: 20px;border-radius: 8px;background-color: white;">
-        <li v-for="(item,index) in wxRank" @click="goto(item.userid)">
+        <li v-for="(item,index) in wxRank">
             <div style="float: left; width: 50%;height:45px;text-align: center;">{{index + 1}}</div>
             <div style="float: right; width: 50%;height:45px;text-align: left;font-weight: 600">
-                <img style="width: 32px; border-radius: 50%; margin: 7px;" :src=item.avatar>
-                <span style="position: absolute;font-size: 14px">{{item.realname}}</span>
+                <span style="position: absolute;font-size: 14px">{{item}}</span>
             </div>
         </li>
     </ul>
 </div>
 <script>
-    var news = new Vue({
-        el: '#news',
-        data: {
-            wxRank: []
-        }
-    });
+    $(function () {
+        var news = new Vue({
+            el: '#news',
+            data: {
+                deptName: '',
+                date: '',
+                wxRank: []
+            }
+        });
 
-    getUserrank();
+        (function ($) {
+            $.getUrlParam = function (name) {
+                var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
+                var r = window.location.search.substr(1).match(reg);
+                if (r != null) return decodeURIComponent(r[2]);
+                return null;
+            }
+        })(jQuery);
+
+        let deptName = $.getUrlParam('deptName');
+        news.deptName = deptName;
+        let date = $.getUrlParam('date');
+        if (date !== 'null') {
+            news.date = date;
+        } else {
+            news.date = getDate();
+        }
+
+
+        getUserrank();
 
-    function getUserrank() {
-        $.ajax({
-            // url: "https://dangshi.nhgaj.com/func/userTab/getUserList",
-            url: "http://localhost:5566/func/userTab/getUserList",
-            type: "get",
-            dataType: "json",
-            success: function (r) {
-                news.wxRank = r.data;
-            },
-            error: function (data) {
-                alert(JSON.stringify(data));
-            }
-        });
-    }
+        function getUserrank() {
+            $.ajax({
+                url: "https://dangshi.nhgaj.com/func/userTab/getUndoUsers?deptName=" + deptName + '&date=' + date,
+                // url: "http://localhost:5566/func/userTab/getUndoUsers?deptName=" + deptName + '&date=' + date,
+                type: "get",
+                dataType: "json",
+                success: function (r) {
+                    news.wxRank = r.data;
+                },
+                error: function (data) {
+                    alert(JSON.stringify(data));
+                }
+            });
+        }
 
-    /**
-     * 跳转到详情
-     * @param userid
-     */
-    function goto(userid){
-        alert(userid);
-    }
+        function getDate() {
+            var now = new Date();
+            var year = now.getFullYear(); //得到年份
+            var month = now.getMonth();//得到月份
+            var date = now.getDate();//得到日期
+            month = month + 1;
+            if (month < 10) month = "0" + month;
+            if (date < 10) date = "0" + date;
+            var time = "";
+            time = year + "-" + month + "-" + date;
+            return time;
+        }
+    })
 </script>
 </body>
 </html>
\ No newline at end of file
Index: src/main/java/com/kalvin/kvf/modules/func/service/TrainServiceImpl.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.service;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;\r\nimport org.springframework.stereotype.Service;\r\nimport com.kalvin.kvf.modules.func.entity.Train;\r\nimport com.kalvin.kvf.modules.func.mapper.TrainMapper;\r\n\r\nimport java.util.List;\r\n\r\n/**\r\n * <p>\r\n * 在线培训表 服务实现类\r\n * </p>\r\n * @since 2022-06-08 09:36:53\r\n */\r\n@Service\r\npublic class TrainServiceImpl extends ServiceImpl<TrainMapper, Train> implements TrainService {\r\n\r\n    @Override\r\n    public Page<Train> listTrainPage(Train train) {\r\n        Page<Train> page = new Page<>(train.getCurrent(), train.getSize());\r\n        List<Train> trains = baseMapper.selectTrainList(train, page);\r\n        return page.setRecords(trains);\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/service/TrainServiceImpl.java b/src/main/java/com/kalvin/kvf/modules/func/service/TrainServiceImpl.java
--- a/src/main/java/com/kalvin/kvf/modules/func/service/TrainServiceImpl.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/service/TrainServiceImpl.java	
@@ -24,4 +24,10 @@
         return page.setRecords(trains);
     }
 
+    @Override
+    public Page<Train> getTrainPage(Train train) {
+        Page<Train> page = new Page<>(train.getCurrent(), train.getSize());
+        List<Train> trains = baseMapper.getTrainList(train, page);
+        return page.setRecords(trains);
+    }
 }
Index: src/main/java/com/kalvin/kvf/modules/func/service/TrainService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.service;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport com.baomidou.mybatisplus.extension.service.IService;\r\nimport com.kalvin.kvf.modules.func.entity.Train;\r\n\r\n/**\r\n * <p>\r\n * 在线培训表 服务类\r\n * </p>\r\n * @since 2022-06-08 09:36:53\r\n */\r\npublic interface TrainService extends IService<Train> {\r\n\r\n    /**\r\n     * 获取列表。分页\r\n     * @param train 查询参数\r\n     * @return page\r\n     */\r\n    Page<Train> listTrainPage(Train train);\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/service/TrainService.java b/src/main/java/com/kalvin/kvf/modules/func/service/TrainService.java
--- a/src/main/java/com/kalvin/kvf/modules/func/service/TrainService.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/service/TrainService.java	
@@ -19,4 +19,10 @@
      */
     Page<Train> listTrainPage(Train train);
 
+    /**
+     * 获取列表。分页
+     * @param train 查询参数
+     * @return page
+     */
+    Page<Train> getTrainPage(Train train);
 }
Index: src/main/java/com/kalvin/kvf/modules/util/OkHttpUtils.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.util;public class OkHttpUtils {\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/util/OkHttpUtils.java b/src/main/java/com/kalvin/kvf/modules/util/OkHttpUtils.java
--- a/src/main/java/com/kalvin/kvf/modules/util/OkHttpUtils.java	
+++ b/src/main/java/com/kalvin/kvf/modules/util/OkHttpUtils.java	
@@ -1,2 +1,373 @@
-package com.kalvin.kvf.modules.util;public class OkHttpUtils {
-}
+package com.kalvin.kvf.modules.util;
+
+import com.alibaba.fastjson.JSON;
+import okhttp3.*;
+
+import javax.net.ssl.SSLContext;
+import javax.net.ssl.SSLSocketFactory;
+import javax.net.ssl.TrustManager;
+import javax.net.ssl.X509TrustManager;
+import java.io.IOException;
+import java.net.URLEncoder;
+import java.security.SecureRandom;
+import java.security.cert.X509Certificate;
+import java.util.LinkedHashMap;
+import java.util.Map;
+import java.util.concurrent.Semaphore;
+import java.util.concurrent.TimeUnit;
+
+/**
+ * @author Administrator
+ */
+public class OkHttpUtils {
+    private static volatile OkHttpClient okHttpClient = null;
+    private static volatile Semaphore semaphore = null;
+    private Map<String, String> headerMap;
+    private Map<String, String> paramMap;
+    private String url;
+    private Request.Builder request;
+
+    /**
+     * 初始化okHttpClient，并且允许https访问
+     */
+    private OkHttpUtils() {
+        if (okHttpClient == null) {
+            synchronized (OkHttpUtils.class) {
+                if (okHttpClient == null) {
+                    TrustManager[] trustManagers = buildTrustManagers();
+                    okHttpClient = new OkHttpClient.Builder()
+                            //设置连接超时时间
+                            .connectTimeout(15, TimeUnit.SECONDS)
+                            //写入超时时间
+                            .writeTimeout(20, TimeUnit.SECONDS)
+                            //从连接成功到响应的总时间
+                            .readTimeout(20, TimeUnit.SECONDS)
+                            //跳过ssl认证(https)
+                            .sslSocketFactory(createSSLSocketFactory(trustManagers), (X509TrustManager) trustManagers[0])
+                            .hostnameVerifier((hostName, session) -> true)
+                            .retryOnConnectionFailure(true)
+//                            .proxy(proxy)//代理ip
+                            //设置连接池  最大连接数量  , 持续存活的连接
+                            .connectionPool(new ConnectionPool(50, 10, TimeUnit.MINUTES))
+                            .build();
+                    addHeader("User-Agent", "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36");
+                }
+            }
+        }
+    }
+
+    /**
+     * 用于异步请求时，控制访问线程数，返回结果
+     *
+     * @return
+     */
+    private static Semaphore getSemaphoreInstance() {
+        //只能1个线程同时访问
+        synchronized (OkHttpUtils.class) {
+            if (semaphore == null) {
+                semaphore = new Semaphore(0);
+            }
+        }
+        return semaphore;
+    }
+
+    /**
+     * 创建OkHttpUtils
+     *
+     * @return
+     */
+    public static OkHttpUtils builder() {
+        return new OkHttpUtils();
+    }
+
+    /**
+     * 添加url
+     *
+     * @param url
+     * @return
+     */
+    public OkHttpUtils url(String url) {
+        this.url = url;
+        return this;
+    }
+
+    /**
+     * 添加参数
+     *
+     * @param key   参数名
+     * @param value 参数值
+     * @return
+     */
+    public OkHttpUtils addParam(String key, String value) {
+        if (paramMap == null) {
+            paramMap = new LinkedHashMap<>(16);
+        }
+        paramMap.put(key, value);
+        return this;
+    }
+
+    /**
+     * 添加请求头
+     *
+     * @param key   参数名
+     * @param value 参数值
+     * @return
+     */
+    public OkHttpUtils addHeader(String key, String value) {
+        if (headerMap == null) {
+            headerMap = new LinkedHashMap<>(16);
+        }
+        headerMap.put(key, value);
+        return this;
+    }
+
+    /**
+     * 初始化get方法
+     *
+     * @return
+     */
+    public OkHttpUtils get() {
+        request = new Request.Builder().get();
+        StringBuilder urlBuilder = new StringBuilder(url);
+        if (paramMap != null) {
+            urlBuilder.append("?");
+            try {
+                for (Map.Entry<String, String> entry : paramMap.entrySet()) {
+                    urlBuilder.append(URLEncoder.encode(entry.getKey(), "utf-8")).
+                            append("=").
+                            append(URLEncoder.encode(entry.getValue(), "utf-8")).
+                            append("&");
+                }
+            } catch (Exception e) {
+                e.printStackTrace();
+            }
+            urlBuilder.deleteCharAt(urlBuilder.length() - 1);
+        }
+        request.url(urlBuilder.toString());
+        return this;
+    }
+
+    /**
+     * 初始化post方法
+     *
+     * @param isJsonPost true等于json的方式提交数据，类似postman里post方法的raw
+     *                   false等于普通的表单提交
+     * @return
+     */
+    public OkHttpUtils post(boolean isJsonPost) {
+        RequestBody requestBody;
+        if (isJsonPost) {
+            String json = "";
+            if (paramMap != null) {
+                json = JSON.toJSONString(paramMap);
+            }
+            requestBody = RequestBody.create(MediaType.parse("application/json; charset=utf-8"), json);
+        } else {
+            FormBody.Builder formBody = new FormBody.Builder();
+            if (paramMap != null) {
+                paramMap.forEach(formBody::add);
+            }
+            requestBody = formBody.build();
+        }
+        request = new Request.Builder().post(requestBody).url(url);
+        return this;
+    }
+
+    public OkHttpUtils put() {
+        String json = "";
+        if (paramMap != null) {
+            json = JSON.toJSONString(paramMap);
+        }
+        RequestBody requestBody = RequestBody.create(MediaType.parse("application/json; charset=utf-8"), json);
+
+        request = new Request.Builder().put(requestBody).url(url);
+        return this;
+    }
+
+    public OkHttpUtils del() {
+        String json = "";
+        if (paramMap != null) {
+            json = JSON.toJSONString(paramMap);
+        }
+        RequestBody requestBody = RequestBody.create(MediaType.parse("application/json; charset=utf-8"), json);
+        request = new Request.Builder().delete(requestBody).url(url);
+        return this;
+    }
+
+    /**
+     * 同步请求
+     *
+     * @return
+     */
+    public String sync() {
+        setHeader(request);
+        try {
+            Response response = okHttpClient.newCall(request.build()).execute();
+            assert response.body() != null;
+            return response.body().string();
+        } catch (IOException e) {
+            e.printStackTrace();
+            return "请求失败：" + e.getMessage();
+        }
+    }
+
+    /**
+     * 异步请求，有返回值
+     */
+    public String async() {
+        StringBuilder buffer = new StringBuilder("");
+        setHeader(request);
+        okHttpClient.newCall(request.build()).enqueue(new Callback() {
+            @Override
+            public void onFailure(Call call, IOException e) {
+                buffer.append("请求出错：").append(e.getMessage());
+            }
+
+            @Override
+            public void onResponse(Call call, Response response) throws IOException {
+                assert response.body() != null;
+                buffer.append(response.body().string());
+                getSemaphoreInstance().release();
+            }
+        });
+        try {
+            getSemaphoreInstance().acquire();
+        } catch (InterruptedException e) {
+            e.printStackTrace();
+        }
+        return buffer.toString();
+    }
+
+    /**
+     * 异步请求，带有接口回调
+     *
+     * @param callBack
+     */
+    public void async(ICallBack callBack) {
+        setHeader(request);
+        okHttpClient.newCall(request.build()).enqueue(new Callback() {
+            @Override
+            public void onFailure(Call call, IOException e) {
+                callBack.onFailure(call, e.getMessage());
+            }
+
+            @Override
+            public void onResponse(Call call, Response response) throws IOException {
+                assert response.body() != null;
+                callBack.onSuccessful(call, response.body().string());
+            }
+        });
+    }
+
+    /**
+     * 为request添加请求头
+     *
+     * @param request
+     */
+    private void setHeader(Request.Builder request) {
+        if (headerMap != null) {
+            try {
+                for (Map.Entry<String, String> entry : headerMap.entrySet()) {
+                    request.addHeader(entry.getKey(), entry.getValue());
+                }
+            } catch (Exception e) {
+                e.printStackTrace();
+            }
+        }
+    }
+
+
+    /**
+     * 生成安全套接字工厂，用于https请求的证书跳过
+     *
+     * @return
+     */
+    private static SSLSocketFactory createSSLSocketFactory(TrustManager[] trustAllCerts) {
+        SSLSocketFactory ssfFactory = null;
+        try {
+            SSLContext sc = SSLContext.getInstance("SSL");
+            sc.init(null, trustAllCerts, new SecureRandom());
+            ssfFactory = sc.getSocketFactory();
+        } catch (Exception e) {
+            e.printStackTrace();
+        }
+        return ssfFactory;
+    }
+
+    private static TrustManager[] buildTrustManagers() {
+        return new TrustManager[]{
+                new X509TrustManager() {
+                    @Override
+                    public void checkClientTrusted(X509Certificate[] chain, String authType) {
+                    }
+
+                    @Override
+                    public void checkServerTrusted(X509Certificate[] chain, String authType) {
+                    }
+
+                    @Override
+                    public X509Certificate[] getAcceptedIssuers() {
+                        return new X509Certificate[]{};
+                    }
+                }
+        };
+    }
+
+    /**
+     * 自定义一个接口回调
+     */
+    public interface ICallBack {
+
+        void onSuccessful(Call call, String data);
+
+        void onFailure(Call call, String errorMsg);
+
+    }
+
+    //发送get请求
+//    String sync = OkHttpUtils.builder().url("http://localhost:9100/user/all")
+//            .addHeader("token", "xxxxxxx")
+//            .addParam("name", "xxx").addParam("pass", "xxx")
+//            .get()
+//            .sync();
+//        System.out.println(sync);
+
+    //发送POST请求
+//    String sync = OkHttpUtils.builder().url("http://localhost:9100/user/all")
+//            .addHeader("token", "xxxxxxx")
+//            .addParam("name", "xxx").addParam("pass", "xxx")
+//            .post(true) // true 为json提交方式
+//            .sync();
+//        System.out.println(sync);
+
+
+//    发送异步请求
+//    需要实现ICallBack接口
+
+    //回调实现类
+    public class AsyncHttpServiceImpl implements OkHttpUtils.ICallBack {
+        @Override
+        public void onSuccessful(Call call, String data) {
+            //接口正常返回的内容
+            System.out.println("onSuccessful"+data);
+
+        }
+
+        @Override
+        public void onFailure(Call call, String errorMsg) {
+            //接口错误返回的内容
+            System.out.println("onFailure"+errorMsg);
+        }
+    }
+
+    //发送异步请求
+//           OkHttpUtils.builder().url("http://localhost:9100/user/all")
+//                .addHeader("token", "xxxxxxx")
+//                .addParam("name", "xxx").addParam("pass", "xxx")
+//                .post(true)
+//                .async(new AsyncHttpServiceImpl());
+
+}
+
+
+
Index: src/main/java/com/kalvin/kvf/modules/func/controller/SummerCampController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.controller;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.*;\r\nimport org.springframework.web.servlet.ModelAndView;\r\nimport com.kalvin.kvf.common.controller.BaseController;\r\nimport com.kalvin.kvf.common.dto.R;\r\nimport com.kalvin.kvf.modules.func.entity.SummerCamp;\r\nimport com.kalvin.kvf.modules.func.service.SummerCampService;\r\n\r\nimport java.util.List;\r\n\r\n\r\n/**\r\n * <p>\r\n * 夏令营 前端控制器\r\n * </p>\r\n * @since 2022-08-16 14:54:46\r\n */\r\n@RestController\r\n@RequestMapping(\"func/summerCamp\")\r\npublic class SummerCampController extends BaseController {\r\n\r\n    @Autowired\r\n    private SummerCampService summerCampService;\r\n\r\n    @RequiresPermissions(\"func:summerCamp:index\")\r\n    @GetMapping(\"index\")\r\n    public ModelAndView index() {\r\n        return new ModelAndView(\"func/summerCamp\");\r\n    }\r\n\r\n    @GetMapping(value = \"edit\")\r\n    public ModelAndView edit(Long id) {\r\n        ModelAndView mv = new ModelAndView(\"func/summerCamp_edit\");\r\n        SummerCamp summerCamp;\r\n        if (id == null) {\r\n            summerCamp = new SummerCamp();\r\n        } else {\r\n            summerCamp = summerCampService.getById(id);\r\n        }\r\n        mv.addObject(\"editInfo\", summerCamp);\r\n        return mv;\r\n    }\r\n\r\n    @GetMapping(value = \"list/data\")\r\n    public R listData(SummerCamp summerCamp) {\r\n        Page<SummerCamp> page = summerCampService.listSummerCampPage(summerCamp);\r\n        return R.ok(page);\r\n    }\r\n\r\n    @RequiresPermissions(\"func:summerCamp:add\")\r\n    @PostMapping(value = \"add\")\r\n    public R add(SummerCamp summerCamp) {\r\n        summerCampService.save(summerCamp);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:summerCamp:del\")\r\n    @PostMapping(value = \"batchdel\")\r\n    public R batchdel(@RequestParam(\"ids\") List<Long> ids) {\r\n        summerCampService.removeByIds(ids);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:summerCamp:edit\")\r\n    @PostMapping(value = \"edit\")\r\n    public R edit(SummerCamp summerCamp) {\r\n        summerCampService.updateById(summerCamp);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:summerCamp:del\")\r\n    @PostMapping(value = \"del/{id}\")\r\n    public R del(@PathVariable Long id) {\r\n        summerCampService.removeById(id);\r\n        return R.ok();\r\n    }\r\n\r\n    @GetMapping(value = \"get/{id}\")\r\n    public R get(@PathVariable Long id) {\r\n        return R.ok(summerCampService.getById(id));\r\n    }\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/controller/SummerCampController.java b/src/main/java/com/kalvin/kvf/modules/func/controller/SummerCampController.java
--- a/src/main/java/com/kalvin/kvf/modules/func/controller/SummerCampController.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/controller/SummerCampController.java	
@@ -1,5 +1,6 @@
 package com.kalvin.kvf.modules.func.controller;
 
+import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
 import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
 import org.apache.shiro.authz.annotation.RequiresPermissions;
 import org.springframework.beans.factory.annotation.Autowired;
@@ -17,6 +18,7 @@
  * <p>
  * 夏令营 前端控制器
  * </p>
+ *
  * @since 2022-08-16 14:54:46
  */
 @RestController
@@ -51,9 +53,21 @@
         return R.ok(page);
     }
 
-    @RequiresPermissions("func:summerCamp:add")
+    //    @RequiresPermissions("func:summerCamp:add")
     @PostMapping(value = "add")
     public R add(SummerCamp summerCamp) {
+        SummerCamp sc = summerCampService.getOne(new LambdaQueryWrapper<SummerCamp>()
+                .eq(SummerCamp::getTel, summerCamp.getTel()));
+
+        if (sc != null) {
+            return R.fail("您已报名，不可重复报名！");
+        }
+
+        Integer count = summerCampService.count();
+        if (count == 15) {
+            return R.fail("对不起，夏令营总数15人，报名人数已满！");
+        }
+
         summerCampService.save(summerCamp);
         return R.ok();
     }
@@ -84,5 +98,14 @@
         return R.ok(summerCampService.getById(id));
     }
 
+    /**
+     * 获取已报名数
+     *
+     * @return
+     */
+    @GetMapping(value = "getCount")
+    public R getCount() {
+        return R.ok(summerCampService.count());
+    }
 }
 
Index: src/main/resources/templates/func/infoTest_edit.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n</head>\r\n<body>\r\n<div class=\"layui-form\" style=\"padding: 20px 30px 0 0;\">\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">标题</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"title\" th:value=\"${editInfo.title}\" placeholder=\"请输入标题\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">题目列表</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"ids\" th:value=\"${editInfo.ids}\" placeholder=\"请输入题目列表\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">创建时间</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"createTime\" id=\"createTime\" th:value=\"${#strings.replace(editInfo.createTime,'T',' ')}\" placeholder=\"请输入创建时间\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">开始时间</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"startTime\" id=\"startTime\" th:value=\"${#strings.replace(editInfo.startTime,'T',' ')}\" placeholder=\"请输入开始时间\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">结束时间</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"endTime\" id=\"endTime\" th:value=\"${#strings.replace(editInfo.endTime,'T',' ')}\" placeholder=\"请输入结束时间\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"layui-form-item layui-hide\">\r\n        <input type=\"button\" lay-submit=\"\" lay-filter=\"kFormSubmit\" id=\"kFormSubmit\">\r\n        <input type=\"text\" name=\"id\" th:value=\"${editInfo.id}\" autocomplete=\"off\" class=\"layui-input\">\r\n    </div>\r\n</div>\r\n\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n<script>\r\n    layui.use(['form', 'laydate'], function () {\r\n        var $ = layui.$, form = layui.form, laydate = layui.laydate;\r\n\r\n\r\n        laydate.render({\r\n            elem: '#createTime' // 指定元素\r\n            ,type: 'datetime'\r\n        });\r\n        laydate.render({\r\n            elem: '#startTime' // 指定元素\r\n            ,type: 'datetime'\r\n        });\r\n        laydate.render({\r\n            elem: '#endTime' // 指定元素\r\n            ,type: 'datetime'\r\n        });\r\n\r\n        //监听提交\r\n        form.on('submit(kFormSubmit)', function(data){\r\n            var field = data.field; //获取提交的字段\r\n            var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引\r\n\r\n            var url = field.id ? 'func/infoTest/edit' : 'func/infoTest/add';\r\n            //提交 Ajax 成功后，关闭当前弹层并重载表格\r\n            $.ajax({\r\n                type: req.type.post,\r\n                url: BASE_WEB + url,\r\n                data: field,\r\n                async: false,\r\n                success: function (r) {\r\n                    if (r.code === req.status.ok) {\r\n                        // 重载表格\r\n                        parent.layui.table.reload('kContentTable');\r\n                        parent.layer.close(index); //再执行关闭\r\n                    } else {\r\n                        kvfKit.errorMsg(r.msg);\r\n                    }\r\n                }\r\n            });\r\n\r\n        });\r\n    })\r\n</script>\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/func/infoTest_edit.html b/src/main/resources/templates/func/infoTest_edit.html
--- a/src/main/resources/templates/func/infoTest_edit.html	
+++ b/src/main/resources/templates/func/infoTest_edit.html	
@@ -16,25 +16,26 @@
     <div class="layui-form-item">
         <label class="layui-form-label">题目列表</label>
         <div class="layui-input-inline">
-            <input type="text" name="ids" th:value="${editInfo.ids}" placeholder="请输入题目列表" autocomplete="off" class="layui-input">
+            <input type="text" name="ids" th:value="${editInfo.ids}" placeholder="请输入题目列表" autocomplete="off" class="layui-input" style="display: inline;width: 84%;">
+            <button id="generate" type="button" class="layui-btn layui-btn-sm" ><i class=""></i>生成</button>
         </div>
     </div>
-    <div class="layui-form-item">
-        <label class="layui-form-label">创建时间</label>
-        <div class="layui-input-inline">
-            <input type="text" name="createTime" id="createTime" th:value="${#strings.replace(editInfo.createTime,'T',' ')}" placeholder="请输入创建时间" autocomplete="off" class="layui-input">
-        </div>
-    </div>
+<!--    <div class="layui-form-item">-->
+<!--        <label class="layui-form-label">创建时间</label>-->
+<!--        <div class="layui-input-inline">-->
+<!--            <input type="text" name="createTime" id="createTime" th:value="${#strings.replace(editInfo.createTime,'T',' ')}" placeholder="请输入创建时间" autocomplete="off" class="layui-input">-->
+<!--        </div>-->
+<!--    </div>-->
     <div class="layui-form-item">
         <label class="layui-form-label">开始时间</label>
         <div class="layui-input-inline">
-            <input type="text" name="startTime" id="startTime" th:value="${#strings.replace(editInfo.startTime,'T',' ')}" placeholder="请输入开始时间" autocomplete="off" class="layui-input">
+            <input type="text" name="startTime" id="startTime" th:value="${#dates.format(editInfo.startTime, 'yyyy-MM-dd HH:mm:ss')}" placeholder="请输入开始时间" autocomplete="off" class="layui-input">
         </div>
     </div>
     <div class="layui-form-item">
         <label class="layui-form-label">结束时间</label>
         <div class="layui-input-inline">
-            <input type="text" name="endTime" id="endTime" th:value="${#strings.replace(editInfo.endTime,'T',' ')}" placeholder="请输入结束时间" autocomplete="off" class="layui-input">
+            <input type="text" name="endTime" id="endTime" th:value="${#dates.format(editInfo.endTime, 'yyyy-MM-dd HH:mm:ss')}" placeholder="请输入结束时间" autocomplete="off" class="layui-input">
         </div>
     </div>
 
@@ -50,11 +51,6 @@
     layui.use(['form', 'laydate'], function () {
         var $ = layui.$, form = layui.form, laydate = layui.laydate;
 
-
-        laydate.render({
-            elem: '#createTime' // 指定元素
-            ,type: 'datetime'
-        });
         laydate.render({
             elem: '#startTime' // 指定元素
             ,type: 'datetime'
@@ -86,8 +82,23 @@
                     }
                 }
             });
-
-        });
+        });
+
+        $('#generate').click(function (e) {
+            log("1111");
+            $.ajax({
+                type: req.type.get,
+                url: BASE_WEB + 'func/infoTest/generate',
+                async: false,
+                success: function (r) {
+                    if (r.code === req.status.ok) {
+                        $('input[name=ids]').val(r.data);
+                    } else {
+                        kvfKit.errorMsg(r.msg);
+                    }
+                }
+            });
+        })
     })
 </script>
 </body>
Index: src/main/java/com/kalvin/kvf/modules/func/schedule/ScheduledConfig.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.schedule;\r\n\r\nimport com.baomidou.mybatisplus.core.conditions.update.LambdaUpdateWrapper;\r\nimport com.kalvin.kvf.modules.func.entity.UserInfo;\r\nimport com.kalvin.kvf.modules.func.mapper.UserInfoMapper;\r\nimport com.kalvin.kvf.modules.func.service.UserInfoService;\r\nimport org.springframework.scheduling.annotation.EnableScheduling;\r\nimport org.springframework.scheduling.annotation.Scheduled;\r\nimport org.springframework.scheduling.annotation.SchedulingConfigurer;\r\nimport org.springframework.scheduling.config.ScheduledTaskRegistrar;\r\nimport org.springframework.stereotype.Component;\r\n\r\nimport javax.annotation.Resource;\r\nimport java.util.concurrent.Executors;\r\n\r\n@Component\r\n@EnableScheduling\r\npublic class ScheduledConfig implements SchedulingConfigurer {\r\n    @Resource\r\n    private UserInfoService userInfoService;\r\n\r\n    @Override\r\n    public void configureTasks(ScheduledTaskRegistrar scheduledTaskRegistrar) {\r\n        //参数传入一个size为10的线程池\r\n        scheduledTaskRegistrar.setScheduler(Executors.newScheduledThreadPool(10));\r\n    }\r\n\r\n    /**\r\n     * 每日次数置0\r\n     */\r\n    @Scheduled(cron = \"1 0 0 * * ?\")\r\n    public void test() {\r\n        try {\r\n            userInfoService.update(new LambdaUpdateWrapper<UserInfo>()\r\n                    .set(UserInfo::getTodayCnt, 0));\r\n        } catch (Exception ex) {\r\n            ex.printStackTrace();\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/schedule/ScheduledConfig.java b/src/main/java/com/kalvin/kvf/modules/func/schedule/ScheduledConfig.java
--- a/src/main/java/com/kalvin/kvf/modules/func/schedule/ScheduledConfig.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/schedule/ScheduledConfig.java	
@@ -1,9 +1,21 @@
 package com.kalvin.kvf.modules.func.schedule;
 
-import com.baomidou.mybatisplus.core.conditions.update.LambdaUpdateWrapper;
+import com.alibaba.fastjson.JSON;
+import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
+import com.dingtalk.api.DefaultDingTalkClient;
+import com.dingtalk.api.DingTalkClient;
+import com.dingtalk.api.request.OapiMediaUploadRequest;
+import com.dingtalk.api.request.OapiRobotSendRequest;
+import com.dingtalk.api.response.OapiRobotSendResponse;
+import com.kalvin.kvf.modules.func.entity.QuestionBank;
+import com.kalvin.kvf.modules.func.entity.Record;
 import com.kalvin.kvf.modules.func.entity.UserInfo;
-import com.kalvin.kvf.modules.func.mapper.UserInfoMapper;
+import com.kalvin.kvf.modules.func.mapper.RecordMapper;
+import com.kalvin.kvf.modules.func.service.QuestionBankService;
 import com.kalvin.kvf.modules.func.service.UserInfoService;
+import com.kalvin.kvf.modules.func.vo.AnswerDto;
+import com.kalvin.kvf.modules.zhouqi.entity.Question;
+import com.kalvin.kvf.modules.zhouqi.mapper.QuestionMapper;
 import org.springframework.scheduling.annotation.EnableScheduling;
 import org.springframework.scheduling.annotation.Scheduled;
 import org.springframework.scheduling.annotation.SchedulingConfigurer;
@@ -11,14 +23,29 @@
 import org.springframework.stereotype.Component;
 
 import javax.annotation.Resource;
+import java.util.ArrayList;
+import java.util.Date;
+import java.util.List;
+import java.util.Random;
 import java.util.concurrent.Executors;
 
+import static com.kalvin.kvf.modules.util.DateUtil.*;
+
 @Component
 @EnableScheduling
 public class ScheduledConfig implements SchedulingConfigurer {
     @Resource
     private UserInfoService userInfoService;
 
+    @Resource
+    private RecordMapper recordMapper;
+
+    @Resource
+    private QuestionMapper questionMapper;
+
+    @Resource
+    private QuestionBankService questionBankService;
+
     @Override
     public void configureTasks(ScheduledTaskRegistrar scheduledTaskRegistrar) {
         //参数传入一个size为10的线程池
@@ -26,15 +53,318 @@
     }
 
     /**
-     * 每日次数置0
+     * 题库导入
+     */
+//    @Scheduled(fixedDelay = Long.MAX_VALUE)
+    public void schedule_0() {
+        List<Question> qts = questionMapper.selectList(null);
+        List<QuestionBank> qtbs = new ArrayList<>();
+        for (Question qu : qts) {
+            QuestionBank qb = new QuestionBank();
+            qb.setSubjectType(qu.getSubjectType());
+            qb.setClassify(qu.getClassify());
+            qb.setQuestion(qu.getQuestion());
+
+            qb.setStatus(0);
+            qb.setCreateBy(1L);
+            qb.setCreateTime(new Date());
+
+
+            List<AnswerDto> ads = new ArrayList<>();
+            String[] item = qu.getItem().split("\\r|\\n|\\r\\n");
+            for (String s : item) {
+                AnswerDto ad = new AnswerDto();
+                ad.setAnswer(s);
+                ad.setValue(false);
+//                if (qu.getSubjectType() == 3L) {
+//                    if (qu.getAnswer().equals("正确")) {
+//                        ad.setValue(true);
+//                    } else {
+//
+//                    }
+//                    ads.add(ad);
+//                }
+//                else {
+                if (qu.getAnswer().contains("A") && s.startsWith("A")) {
+                    ad.setValue(true);
+                }
+
+                if (qu.getAnswer().contains("B") && s.startsWith("B")) {
+                    ad.setValue(true);
+                }
+
+                if (qu.getAnswer().contains("C") && s.startsWith("C")) {
+                    ad.setValue(true);
+                }
+
+                if (qu.getAnswer().contains("D") && s.startsWith("D")) {
+                    ad.setValue(true);
+                }
+//                }
+                ads.add(ad);
+            }
+
+            qb.setAnswer(JSON.toJSONString(ads));
+            qtbs.add(qb);
+        }
+        questionBankService.saveBatch(qtbs);
+        System.out.println();
+    }
+
+    @Scheduled(cron = "0 0 9 * * ?")
+    public void schedule_1() {
+        try {
+            // 吴朝晖
+            runBack("04154536361515");
+
+            // 李军
+            runBack("1012355633498");
+
+            // 章勤超
+            runBack("08594808546880");
+
+            // 许锋
+            runBack("08400764101146963");
+
+            // 俞军
+            runBack("0405442836181");
+
+            // 李慧
+            runBack("1012345921355");
+
+            // 刘敏青
+            runBack("1012355734948");
+
+            // 黄燕婷
+            runBack("08401237375000");
+        } catch (Exception ex) {
+            System.out.println(ex.getMessage());
+        }
+    }
+
+    @Scheduled(cron = "0 0 10 * * ?")
+    public void schedule_2() {
+        try {
+            DingTalkClient client = new DefaultDingTalkClient("https://openplatform-pro.ding.zj.gov.cn/robot/send?access_token=32b7b93409b6fa33ac2d07af0f09d45953a460deba131f66811fa626c3b8e12c");
+            OapiRobotSendRequest request = new OapiRobotSendRequest();
+
+            request.setMsgtype("text");
+            OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text();
+            text.setContent("小警提醒：请各位领导登录红色根脉强基系统！");
+            request.setText(text);
+
+            OapiRobotSendResponse response = client.execute(request);
+            System.out.println("发送机器人：" + response.getErrmsg());
+        } catch (Exception ex) {
+            System.out.println("发送机器人：" + ex.getMessage());
+        }
+    }
+
+
+    /**
+     * *东栅提醒1
      */
-    @Scheduled(cron = "1 0 0 * * ?")
-    public void test() {
+    @Scheduled(cron = "0 0 11 * * ?")
+    public void schedule_3() {
+        try {
+            DingTalkClient client = new DefaultDingTalkClient("https://openplatform-pro.ding.zj.gov.cn/robot/send?access_token=1e57cdae8928f24030363b6324f599373b9ff0701676f97689b8535d6c0cb098");
+            OapiRobotSendRequest request = new OapiRobotSendRequest();
+
+            request.setMsgtype("text");
+            OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text();
+            text.setContent("小警提醒：大家学习强国别忘记登陆，现在要求每天登陆，而且学习分数30分以上!");
+            request.setText(text);
+
+            OapiRobotSendResponse response = client.execute(request);
+            System.out.println("发送机器人：" + response.getErrmsg());
+        } catch (Exception ex) {
+            System.out.println("发送机器人：" + ex.getMessage());
+        }
+    }
+
+    /**
+     * 东栅提醒2
+     */
+    @Scheduled(cron = "0 0 14 * * ?")
+    public void schedule_4() {
+        try {
+            DingTalkClient client = new DefaultDingTalkClient("https://openplatform-pro.ding.zj.gov.cn/robot/send?access_token=1e57cdae8928f24030363b6324f599373b9ff0701676f97689b8535d6c0cb098");
+            OapiRobotSendRequest request = new OapiRobotSendRequest();
+
+            request.setMsgtype("text");
+            OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text();
+            text.setContent("小警提醒：大家午睡起床后，寝室内务卫生整理好，灯、空调等电器记得关闭！");
+            request.setText(text);
+
+            OapiRobotSendResponse response = client.execute(request);
+            System.out.println("发送机器人：" + response.getErrmsg());
+        } catch (Exception ex) {
+            System.out.println("发送机器人：" + ex.getMessage());
+        }
+    }
+
+    /**
+     * 技服提醒1
+     */
+    @Scheduled(cron = "0 30 8 ? * MON-FRI")
+    public void schedule_5() {
         try {
-            userInfoService.update(new LambdaUpdateWrapper<UserInfo>()
-                    .set(UserInfo::getTodayCnt, 0));
+            DingTalkClient client = new DefaultDingTalkClient("https://openplatform-pro.ding.zj.gov.cn/robot/send?access_token=f965eb3b207ca46db21e4245ea5b1b1edb75199840e9b157114626f874d1e040");
+            OapiRobotSendRequest request = new OapiRobotSendRequest();
+
+            request.setMsgtype("text");
+            OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text();
+            text.setContent("大家学习强国别忘记登陆学习！");
+            request.setText(text);
+
+            OapiRobotSendResponse response = client.execute(request);
+            System.out.println("发送机器人：" + response.getErrmsg());
         } catch (Exception ex) {
-            ex.printStackTrace();
+            System.out.println("发送机器人：" + ex.getMessage());
+        }
+    }
+
+    /**
+     * 技服提醒2
+     */
+    @Scheduled(cron = "0 0 10 ? * SAT,SUN")
+    public void schedule_6() {
+        try {
+            DingTalkClient client = new DefaultDingTalkClient("https://openplatform-pro.ding.zj.gov.cn/robot/send?access_token=f965eb3b207ca46db21e4245ea5b1b1edb75199840e9b157114626f874d1e040");
+            OapiRobotSendRequest request = new OapiRobotSendRequest();
+
+            request.setMsgtype("text");
+            OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text();
+            text.setContent("大家学习强国别忘记登陆学习！");
+            request.setText(text);
+
+            OapiRobotSendResponse response = client.execute(request);
+            System.out.println("发送机器人：" + response.getErrmsg());
+        } catch (Exception ex) {
+            System.out.println("发送机器人：" + ex.getMessage());
+        }
+    }
+
+    //    @Scheduled(fixedDelay = Long.MAX_VALUE)
+    public void schedule_7() {
+        try {
+            DingTalkClient client = new DefaultDingTalkClient("https://oapi.dingtalk.com/robot/send?access_token=4bcb1b6c25609486d43ef36f0cdaa85d6b51caddee6acdf50bac0abe5ee79705");
+            OapiRobotSendRequest request = new OapiRobotSendRequest();
+
+            request.setMsgtype("text");
+            OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text();
+            text.setContent("昨日8：30至今伤害类警情或案件《处理进度表》请群里通报，写明：\n" +
+                    "一、案件进展\n" +
+                    "1.笔录已做几人（嫌疑人、证人、报案人）；\n" +
+                    "2.现场照片；\n" +
+                    "3.体表原始伤情记录表+伤势照片；\n" +
+                    "4.接受病例材料；\n" +
+                    "5.监控；\n" +
+                    "二、后继交换工作\n" +
+                    "1.调解时间；\n" +
+                    "2.是否受案；\n" +
+                    "3.待补证据：病例材料、笔录、监控；");
+            request.setText(text);
+
+            OapiRobotSendRequest.At at = new OapiRobotSendRequest.At();
+            List mobiles = new ArrayList<String>();
+            mobiles.add("13750754543");
+            mobiles.add("15167357853");
+            mobiles.add("18767164520");
+            at.setAtMobiles(mobiles);
+            at.setIsAtAll("false");
+            request.setAt(at);
+            OapiRobotSendResponse response = client.execute(request);
+            System.out.println("发送机器人：" + response.getErrmsg());
+        } catch (Exception ex) {
+            System.out.println("发送机器人：" + ex.getMessage());
+        }
+    }
+
+    @Scheduled(cron = "0 0 11 * * ?")
+    public void schedule_8() {
+        try {
+            DingTalkClient client = new DefaultDingTalkClient("https://openplatform-pro.ding.zj.gov.cn/robot/send?access_token=b80543ffa1a0483ef7cb0764cf8023f99adf57950c0072266fd6121682f95760");
+            OapiRobotSendRequest request = new OapiRobotSendRequest();
+
+            request.setMsgtype("text");
+            OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text();
+            text.setContent("法定不准出境人员报备");
+            request.setText(text);
+
+            OapiRobotSendResponse response = client.execute(request);
+            System.out.println("发送机器人：" + response.getErrmsg());
+        } catch (Exception ex) {
+            System.out.println("发送机器人：" + ex.getMessage());
+        }
+    }
+
+    @Scheduled(cron = "0 0 16 * * ?")
+    public void schedule_9() {
+        try {
+            DingTalkClient client = new DefaultDingTalkClient("https://openplatform-pro.ding.zj.gov.cn/robot/send?access_token=b80543ffa1a0483ef7cb0764cf8023f99adf57950c0072266fd6121682f95760");
+            OapiRobotSendRequest request = new OapiRobotSendRequest();
+
+            request.setMsgtype("text");
+            OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text();
+            text.setContent("法定不准出境人员报备");
+            request.setText(text);
+
+            OapiRobotSendResponse response = client.execute(request);
+            System.out.println("发送机器人：" + response.getErrmsg());
+        } catch (Exception ex) {
+            System.out.println("发送机器人：" + ex.getMessage());
+        }
+    }
+
+        @Scheduled(cron = "0 0 17 * * ?")
+//    @Scheduled(fixedDelay = Long.MAX_VALUE)
+    public void schedule_10() {
+        try {
+            DingTalkClient client = new DefaultDingTalkClient("https://openplatform-pro.ding.zj.gov.cn/robot/send?access_token=b80543ffa1a0483ef7cb0764cf8023f99adf57950c0072266fd6121682f95760");
+            OapiRobotSendRequest request = new OapiRobotSendRequest();
+
+            request.setMsgtype("text");
+            OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text();
+            text.setContent("学习强国");
+            request.setText(text);
+
+            OapiRobotSendResponse response = client.execute(request);
+            System.out.println("发送机器人：" + response.getErrmsg());
+        } catch (Exception ex) {
+            System.out.println("发送机器人：" + ex.getMessage());
+        }
+    }
+
+    /**
+     * 自动做题
+     */
+    private void runBack(String userid) {
+        try {
+            UserInfo userInfo = userInfoService.getOne(new LambdaQueryWrapper<UserInfo>()
+                    .eq(UserInfo::getUserid, userid));
+
+            Random random = new Random();
+            int score = random.nextInt(6) + 5;
+            userInfo.setResScore(userInfo.getResScore() + score);
+
+            //累计答题次数
+            userInfo.setResCnt(userInfo.getResCnt() + 1);
+            //保存本次答题积分，不是最高积分。
+            userInfo.setMaxLevel(score);
+            //保存今日最高分
+            userInfo.setTodayCnt(score);
+            userInfoService.saveOrUpdate(userInfo);
+
+            Record record = new Record();
+            record.setUserid(userid);
+            record.setLevel(score);
+            record.setRealname(userInfo.getRealname().replaceAll("　", ""));
+            record.setCreateTime(randomDate(todayDateStr(), tomorrowDateStr()));
+            recordMapper.insert(record);
+
+        } catch (Exception ex) {
+
         }
     }
 }
Index: src/main/java/com/kalvin/kvf/modules/func/controller/UserTabController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.controller;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.*;\r\nimport org.springframework.web.servlet.ModelAndView;\r\nimport com.kalvin.kvf.common.controller.BaseController;\r\nimport com.kalvin.kvf.common.dto.R;\r\nimport com.kalvin.kvf.modules.func.entity.UserTab;\r\nimport com.kalvin.kvf.modules.func.service.UserTabService;\r\n\r\nimport java.util.List;\r\n\r\n\r\n/**\r\n * <p>\r\n * 用户表 前端控制器\r\n * </p>\r\n * @since 2021-03-30 14:33:54\r\n */\r\n@RestController\r\n@RequestMapping(\"func/userTab\")\r\npublic class UserTabController extends BaseController {\r\n\r\n    @Autowired\r\n    private UserTabService userTabService;\r\n\r\n    @RequiresPermissions(\"func:userTab:index\")\r\n    @GetMapping(\"index\")\r\n    public ModelAndView index() {\r\n        return new ModelAndView(\"func/userTab\");\r\n    }\r\n\r\n    @GetMapping(value = \"edit\")\r\n    public ModelAndView edit(Long id) {\r\n        ModelAndView mv = new ModelAndView(\"func/userTab_edit\");\r\n        UserTab userTab;\r\n        if (id == null) {\r\n            userTab = new UserTab();\r\n        } else {\r\n            userTab = userTabService.getById(id);\r\n        }\r\n        mv.addObject(\"editInfo\", userTab);\r\n        return mv;\r\n    }\r\n\r\n    @GetMapping(value = \"list/data\")\r\n    public R listData(UserTab userTab) {\r\n        Page<UserTab> page = userTabService.listUserTabPage(userTab);\r\n        return R.ok(page);\r\n    }\r\n\r\n    @RequiresPermissions(\"func:userTab:add\")\r\n    @PostMapping(value = \"add\")\r\n    public R add(UserTab userTab) {\r\n        userTabService.save(userTab);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:userTab:del\")\r\n    @PostMapping(value = \"batchdel\")\r\n    public R batchdel(@RequestParam(\"ids\") List<Long> ids) {\r\n        userTabService.removeByIds(ids);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:userTab:edit\")\r\n    @PostMapping(value = \"edit\")\r\n    public R edit(UserTab userTab) {\r\n        userTabService.updateById(userTab);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:userTab:del\")\r\n    @PostMapping(value = \"del/{id}\")\r\n    public R del(@PathVariable Long id) {\r\n        userTabService.removeById(id);\r\n        return R.ok();\r\n    }\r\n\r\n    @GetMapping(value = \"get/{id}\")\r\n    public R get(@PathVariable Long id) {\r\n        return R.ok(userTabService.getById(id));\r\n    }\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/controller/UserTabController.java b/src/main/java/com/kalvin/kvf/modules/func/controller/UserTabController.java
--- a/src/main/java/com/kalvin/kvf/modules/func/controller/UserTabController.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/controller/UserTabController.java	
@@ -1,6 +1,10 @@
 package com.kalvin.kvf.modules.func.controller;
 
 import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
+import com.kalvin.kvf.modules.func.entity.DeptSys;
+import com.kalvin.kvf.modules.func.entity.UserSys;
+import com.kalvin.kvf.modules.func.mapper.UserTabMapper;
+import org.apache.commons.lang3.StringUtils;
 import org.apache.shiro.authz.annotation.RequiresPermissions;
 import org.springframework.beans.factory.annotation.Autowired;
 import org.springframework.web.bind.annotation.*;
@@ -10,13 +14,17 @@
 import com.kalvin.kvf.modules.func.entity.UserTab;
 import com.kalvin.kvf.modules.func.service.UserTabService;
 
+import javax.annotation.Resource;
+import java.text.SimpleDateFormat;
+import java.util.Date;
 import java.util.List;
 
 
 /**
  * <p>
- * 用户表 前端控制器
+ * 用户表 前端控制器func/userTab
  * </p>
+ *
  * @since 2021-03-30 14:33:54
  */
 @RestController
@@ -26,6 +34,9 @@
     @Autowired
     private UserTabService userTabService;
 
+    @Resource
+    private UserTabMapper userTabMapper;
+
     @RequiresPermissions("func:userTab:index")
     @GetMapping("index")
     public ModelAndView index() {
@@ -84,5 +95,71 @@
         return R.ok(userTabService.getById(id));
     }
 
+    /**
+     * 获取今日未答题人员
+     *
+     * @return
+     */
+    @GetMapping(value = "getUserList")
+    public R getUserList() {
+        return R.ok(userTabMapper.selectUserList());
+    }
+
+    @GetMapping(value = "getUndoDays/{userid}")
+    public R getUndoDays(@PathVariable String userid) {
+        try {
+            List<String> users = userTabMapper.getUndoDays(userid);
+            return R.ok(users);
+        } catch (Exception ex) {
+            return R.fail(ex.getMessage());
+        }
+    }
+
+    @GetMapping(value = "getUserSys")
+    public R getUserSys(@RequestParam(value = "deptName") String deptName, @RequestParam(value = "date",required = false) String date) {
+        try {
+            if(StringUtils.isAllEmpty(date)){
+                //设置日期格式
+                SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
+                date = dateFormat.format(new Date()) + "%";
+            }else{
+                date = date + "%";
+            }
+            List<UserSys> users = userTabMapper.getUserSys(deptName, date);
+            return R.ok(users);
+        } catch (Exception ex) {
+            return R.fail(ex.getMessage());
+        }
+    }
+
+    /**
+     * 获取部门挑战统计
+     *
+     * @return
+     */
+    @GetMapping(value = "getDeptSys")
+    public R getDeptSys(@RequestParam(value = "date",required = false) String date) {
+        try {
+            if(StringUtils.isAllEmpty(date)){
+                //设置日期格式
+                SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
+                date = dateFormat.format(new Date()) + "%";
+            }
+            List<DeptSys> deptSys = userTabMapper.getDeptSys(date + "%");
+            return R.ok(deptSys);
+        } catch (Exception ex) {
+            return R.fail(ex.getMessage());
+        }
+    }
+
+    @GetMapping(value = "getUserStatus")
+    public R getUserStatus(@RequestParam(value = "deptName") String deptName, @RequestParam Integer trainId) {
+        try {
+            List<UserSys> users = userTabMapper.getUserStatus(deptName, trainId);
+            return R.ok(users);
+        } catch (Exception ex) {
+            return R.fail(ex.getMessage());
+        }
+    }
 }
 
Index: src/main/java/com/kalvin/kvf/modules/func/controller/TrainController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.controller;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.*;\r\nimport org.springframework.web.servlet.ModelAndView;\r\nimport com.kalvin.kvf.common.controller.BaseController;\r\nimport com.kalvin.kvf.common.dto.R;\r\nimport com.kalvin.kvf.modules.func.entity.Train;\r\nimport com.kalvin.kvf.modules.func.service.TrainService;\r\n\r\nimport java.util.List;\r\n\r\n\r\n/**\r\n * <p>\r\n * 在线培训表 前端控制器\r\n * </p>\r\n * @since 2022-06-08 09:36:53\r\n */\r\n@RestController\r\n@RequestMapping(\"func/train\")\r\npublic class TrainController extends BaseController {\r\n\r\n    @Autowired\r\n    private TrainService trainService;\r\n\r\n    @RequiresPermissions(\"func:train:index\")\r\n    @GetMapping(\"index\")\r\n    public ModelAndView index() {\r\n        return new ModelAndView(\"func/train\");\r\n    }\r\n\r\n    @GetMapping(value = \"edit\")\r\n    public ModelAndView edit(Long id) {\r\n        ModelAndView mv = new ModelAndView(\"func/train_edit\");\r\n        Train train;\r\n        if (id == null) {\r\n            train = new Train();\r\n        } else {\r\n            train = trainService.getById(id);\r\n        }\r\n        mv.addObject(\"editInfo\", train);\r\n        return mv;\r\n    }\r\n\r\n    @GetMapping(value = \"list/data\")\r\n    public R listData(Train train) {\r\n        Page<Train> page = trainService.listTrainPage(train);\r\n        return R.ok(page);\r\n    }\r\n\r\n    @RequiresPermissions(\"func:train:add\")\r\n    @PostMapping(value = \"add\")\r\n    public R add(Train train) {\r\n        trainService.save(train);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:train:del\")\r\n    @PostMapping(value = \"batchdel\")\r\n    public R batchdel(@RequestParam(\"ids\") List<Long> ids) {\r\n        trainService.removeByIds(ids);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:train:edit\")\r\n    @PostMapping(value = \"edit\")\r\n    public R edit(Train train) {\r\n        trainService.updateById(train);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:train:del\")\r\n    @PostMapping(value = \"del/{id}\")\r\n    public R del(@PathVariable Long id) {\r\n        trainService.removeById(id);\r\n        return R.ok();\r\n    }\r\n\r\n    @GetMapping(value = \"get/{id}\")\r\n    public R get(@PathVariable Long id) {\r\n        return R.ok(trainService.getById(id));\r\n    }\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/controller/TrainController.java b/src/main/java/com/kalvin/kvf/modules/func/controller/TrainController.java
--- a/src/main/java/com/kalvin/kvf/modules/func/controller/TrainController.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/controller/TrainController.java	
@@ -1,15 +1,23 @@
 package com.kalvin.kvf.modules.func.controller;
 
 import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
+import com.kalvin.kvf.common.controller.BaseController;
+import com.kalvin.kvf.common.dto.R;
+import com.kalvin.kvf.modules.func.entity.Train;
+import com.kalvin.kvf.modules.func.entity.TrainRecord;
+import com.kalvin.kvf.modules.func.mapper.TrainMapper;
+import com.kalvin.kvf.modules.func.service.TrainRecordService;
+import com.kalvin.kvf.modules.func.service.TrainService;
 import org.apache.shiro.authz.annotation.RequiresPermissions;
 import org.springframework.beans.factory.annotation.Autowired;
 import org.springframework.web.bind.annotation.*;
 import org.springframework.web.servlet.ModelAndView;
-import com.kalvin.kvf.common.controller.BaseController;
-import com.kalvin.kvf.common.dto.R;
-import com.kalvin.kvf.modules.func.entity.Train;
-import com.kalvin.kvf.modules.func.service.TrainService;
 
+import javax.annotation.Resource;
+import javax.servlet.http.HttpServletRequest;
+import javax.servlet.http.HttpServletResponse;
+import java.io.*;
+import java.util.Date;
 import java.util.List;
 
 
@@ -17,6 +25,7 @@
  * <p>
  * 在线培训表 前端控制器
  * </p>
+ *
  * @since 2022-06-08 09:36:53
  */
 @RestController
@@ -26,6 +35,12 @@
     @Autowired
     private TrainService trainService;
 
+    @Resource
+    private TrainMapper trainMapper;
+
+    @Resource
+    private TrainRecordService trainRecordService;
+
     @RequiresPermissions("func:train:index")
     @GetMapping("index")
     public ModelAndView index() {
@@ -54,6 +69,7 @@
     @RequiresPermissions("func:train:add")
     @PostMapping(value = "add")
     public R add(Train train) {
+        train.setCreateTime(new Date());
         trainService.save(train);
         return R.ok();
     }
@@ -84,5 +100,135 @@
         return R.ok(trainService.getById(id));
     }
 
+    @GetMapping(value = "getVideos")
+    public R getVideos(Train train) {
+        Page<Train> page = trainService.getTrainPage(train);
+        return R.ok(page);
+    }
+
+    @GetMapping(value = "getDepts")
+    public R getDepts() {
+        List<String> depts = trainMapper.getDepts();
+        return R.ok(depts);
+    }
+
+    @PostMapping(value = "finish")
+    public R finish(@RequestParam String userId, @RequestParam Integer trainId) {
+        try {
+            TrainRecord trainRecord = new TrainRecord();
+            trainRecord.setUserId(userId);
+            trainRecord.setTrainId(trainId);
+            trainRecordService.save(trainRecord);
+            return R.ok();
+        } catch (Exception e) {
+            return R.fail(e.getMessage());
+        }
+    }
+
+    @RequestMapping(value = "/videoPlayer", method = RequestMethod.GET)
+    public void player2(HttpServletRequest request, HttpServletResponse response) {
+        String path = request.getServletContext().getRealPath("/static/my/video/interview.mp4");
+        path = System.getProperty("user.dir") + "\\userfile\\"
+                + request.getParameter("path").replace("/", "\\");
+
+        BufferedInputStream bis = null;
+        try {
+            File file = new File(path);
+            if (file.exists()) {
+                long p = 0L;
+                long toLength = 0L;
+                long contentLength = 0L;
+                int rangeSwitch = 0;
+                long fileLength;
+                String rangBytes = "";
+                fileLength = file.length();
+
+                // get file content
+                InputStream ins = new FileInputStream(file);
+                bis = new BufferedInputStream(ins);
+
+                // tell the client to allow accept-ranges
+                response.reset();
+                response.setHeader("Accept-Ranges", "bytes");
+
+                // client requests a file block download start byte
+                String range = request.getHeader("Range");
+                if (range != null && range.trim().length() > 0 && !"null".equals(range)) {
+                    response.setStatus(javax.servlet.http.HttpServletResponse.SC_PARTIAL_CONTENT);
+                    rangBytes = range.replaceAll("bytes=", "");
+                    if (rangBytes.endsWith("-")) { // bytes=270000-
+                        rangeSwitch = 1;
+                        p = Long.parseLong(rangBytes.substring(0, rangBytes.indexOf("-")));
+                        contentLength = fileLength - p; // 客户端请求的是270000之后的字节（包括bytes下标索引为270000的字节）
+                    } else { // bytes=270000-320000
+                        rangeSwitch = 2;
+                        String temp1 = rangBytes.substring(0, rangBytes.indexOf("-"));
+                        String temp2 = rangBytes.substring(rangBytes.indexOf("-") + 1, rangBytes.length());
+                        p = Long.parseLong(temp1);
+                        toLength = Long.parseLong(temp2);
+                        contentLength = toLength - p + 1; // 客户端请求的是 270000-320000 之间的字节
+                    }
+                } else {
+                    contentLength = fileLength;
+                }
+
+                // 如果设设置了Content-Length，则客户端会自动进行多线程下载。如果不希望支持多线程，则不要设置这个参数。
+                // Content-Length: [文件的总大小] - [客户端请求的下载的文件块的开始字节]
+                response.setHeader("Content-Length", new Long(contentLength).toString());
+
+                // 断点开始
+                // 响应的格式是:
+                // Content-Range: bytes [文件块的开始字节]-[文件的总大小 - 1]/[文件的总大小]
+                if (rangeSwitch == 1) {
+                    String contentRange = new StringBuffer("bytes ").append(new Long(p).toString()).append("-")
+                            .append(new Long(fileLength - 1).toString()).append("/")
+                            .append(new Long(fileLength).toString()).toString();
+                    response.setHeader("Content-Range", contentRange);
+                    bis.skip(p);
+                } else if (rangeSwitch == 2) {
+                    String contentRange = range.replace("=", " ") + "/" + new Long(fileLength).toString();
+                    response.setHeader("Content-Range", contentRange);
+                    bis.skip(p);
+                } else {
+                    String contentRange = new StringBuffer("bytes ").append("0-").append(fileLength - 1).append("/")
+                            .append(fileLength).toString();
+                    response.setHeader("Content-Range", contentRange);
+                }
+
+                String fileName = file.getName();
+                response.setContentType("application/octet-stream");
+                response.addHeader("Content-Disposition", "attachment;filename=" + fileName);
+
+                OutputStream out = response.getOutputStream();
+                int n = 0;
+                long readLength = 0;
+                int bsize = 1024;
+                byte[] bytes = new byte[bsize];
+                if (rangeSwitch == 2) {
+                    // 针对 bytes=27000-39000 的请求，从27000开始写数据
+                    while (readLength <= contentLength - bsize) {
+                        n = bis.read(bytes);
+                        readLength += n;
+                        out.write(bytes, 0, n);
+                    }
+                    if (readLength <= contentLength) {
+                        n = bis.read(bytes, 0, (int) (contentLength - readLength));
+                        out.write(bytes, 0, n);
+                    }
+                } else {
+                    while ((n = bis.read(bytes)) != -1) {
+                        out.write(bytes, 0, n);
+                    }
+                }
+                out.flush();
+                out.close();
+                bis.close();
+            }
+        } catch (IOException ie) {
+            // 忽略 ClientAbortException 之类的异常
+        } catch (Exception e) {
+            e.printStackTrace();
+        }
+    }
 }
 
Index: src/main/java/com/kalvin/kvf/modules/func/controller/QuestionCollectController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.controller;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.*;\r\nimport org.springframework.web.servlet.ModelAndView;\r\nimport com.kalvin.kvf.common.controller.BaseController;\r\nimport com.kalvin.kvf.common.dto.R;\r\nimport com.kalvin.kvf.modules.func.entity.QuestionCollect;\r\nimport com.kalvin.kvf.modules.func.service.QuestionCollectService;\r\n\r\nimport java.util.List;\r\n\r\n\r\n/**\r\n * <p>\r\n *  前端控制器\r\n * </p>\r\n * @since 2022-01-17 08:50:34\r\n */\r\n@RestController\r\n@RequestMapping(\"func/questionCollect\")\r\npublic class QuestionCollectController extends BaseController {\r\n\r\n    @Autowired\r\n    private QuestionCollectService questionCollectService;\r\n\r\n    @RequiresPermissions(\"func:questionCollect:index\")\r\n    @GetMapping(\"index\")\r\n    public ModelAndView index() {\r\n        return new ModelAndView(\"func/questionCollect\");\r\n    }\r\n\r\n    @GetMapping(value = \"edit\")\r\n    public ModelAndView edit(Long id) {\r\n        ModelAndView mv = new ModelAndView(\"func/questionCollect_edit\");\r\n        QuestionCollect questionCollect;\r\n        if (id == null) {\r\n            questionCollect = new QuestionCollect();\r\n        } else {\r\n            questionCollect = questionCollectService.getById(id);\r\n        }\r\n        mv.addObject(\"editInfo\", questionCollect);\r\n        return mv;\r\n    }\r\n\r\n    @GetMapping(value = \"list/data\")\r\n    public R listData(QuestionCollect questionCollect) {\r\n        Page<QuestionCollect> page = questionCollectService.listQuestionCollectPage(questionCollect);\r\n        return R.ok(page);\r\n    }\r\n\r\n    @RequiresPermissions(\"func:questionCollect:add\")\r\n    @PostMapping(value = \"add\")\r\n    public R add(QuestionCollect questionCollect) {\r\n        questionCollectService.save(questionCollect);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:questionCollect:del\")\r\n    @PostMapping(value = \"batchdel\")\r\n    public R batchdel(@RequestParam(\"ids\") List<Long> ids) {\r\n        questionCollectService.removeByIds(ids);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:questionCollect:edit\")\r\n    @PostMapping(value = \"edit\")\r\n    public R edit(QuestionCollect questionCollect) {\r\n        questionCollectService.updateById(questionCollect);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:questionCollect:del\")\r\n    @PostMapping(value = \"del/{id}\")\r\n    public R del(@PathVariable Long id) {\r\n        questionCollectService.removeById(id);\r\n        return R.ok();\r\n    }\r\n\r\n    @GetMapping(value = \"get/{id}\")\r\n    public R get(@PathVariable Long id) {\r\n        return R.ok(questionCollectService.getById(id));\r\n    }\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/controller/QuestionCollectController.java b/src/main/java/com/kalvin/kvf/modules/func/controller/QuestionCollectController.java
--- a/src/main/java/com/kalvin/kvf/modules/func/controller/QuestionCollectController.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/controller/QuestionCollectController.java	
@@ -1,31 +1,43 @@
 package com.kalvin.kvf.modules.func.controller;
 
+import com.alibaba.fastjson.JSON;
+import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
 import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
+import com.diboot.core.controller.BaseCrudRestController;
+import com.kalvin.kvf.common.dto.R;
+import com.kalvin.kvf.modules.func.entity.QuestionBank;
+import com.kalvin.kvf.modules.func.entity.QuestionCollect;
+import com.kalvin.kvf.modules.func.mapper.QuestionCollectMapper;
+import com.kalvin.kvf.modules.func.service.QuestionCollectService;
+import com.kalvin.kvf.modules.func.vo.AnswerDto;
+import com.kalvin.kvf.modules.func.vo.QuestionBankVo;
 import org.apache.shiro.authz.annotation.RequiresPermissions;
 import org.springframework.beans.factory.annotation.Autowired;
 import org.springframework.web.bind.annotation.*;
 import org.springframework.web.servlet.ModelAndView;
-import com.kalvin.kvf.common.controller.BaseController;
-import com.kalvin.kvf.common.dto.R;
-import com.kalvin.kvf.modules.func.entity.QuestionCollect;
-import com.kalvin.kvf.modules.func.service.QuestionCollectService;
 
+import javax.annotation.Resource;
+import java.util.Date;
 import java.util.List;
 
 
 /**
  * <p>
- *  前端控制器
+ * 前端控制器
  * </p>
+ *
  * @since 2022-01-17 08:50:34
  */
 @RestController
 @RequestMapping("func/questionCollect")
-public class QuestionCollectController extends BaseController {
+public class QuestionCollectController extends BaseCrudRestController {
 
     @Autowired
     private QuestionCollectService questionCollectService;
 
+    @Resource
+    private QuestionCollectMapper questionCollectMapper;
+
     @RequiresPermissions("func:questionCollect:index")
     @GetMapping("index")
     public ModelAndView index() {
@@ -84,5 +96,63 @@
         return R.ok(questionCollectService.getById(id));
     }
 
+    @PostMapping(value = "collect")
+    public R collect(@RequestParam String userid, @RequestParam Integer qsid) {
+        try {
+            QuestionCollect questionCollect = questionCollectMapper.selectOne(new LambdaQueryWrapper<QuestionCollect>()
+                    .eq(QuestionCollect::getUserid, userid)
+                    .eq(QuestionCollect::getQsId, qsid));
+
+            if (questionCollect == null) {
+                questionCollect = new QuestionCollect();
+                questionCollect.setUserid(userid);
+                questionCollect.setQsId(qsid);
+                questionCollect.setStatus(false);
+                questionCollect.setCreateTime(new Date());
+
+                questionCollectMapper.insert(questionCollect);
+            } else {
+                questionCollect.setStatus(!questionCollect.getStatus());
+                questionCollect.setUpdateTime(new Date());
+                questionCollectMapper.updateById(questionCollect);
+            }
+
+            return R.ok();
+        }catch(Exception ex){
+            return R.fail(ex.getMessage());
+        }
+    }
+
+    @GetMapping(value = "getRandQuestionC")
+    public R getRandQuestionC(@RequestParam(value = "userid") String userid) {
+        try {
+            List<QuestionBank> questionBanks = questionCollectMapper.getRandQuestionC(userid);
+
+            for (QuestionBank o : questionBanks) {
+                List<AnswerDto> answerDtos = JSON.parseArray(o.getAnswer(), AnswerDto.class);
+                o.setAnswerDtos(answerDtos);
+
+                StringBuilder correct = new StringBuilder();
+                for (int i = 0; i < answerDtos.size(); i++) {
+                    if(answerDtos.get(i).isValue()){
+                        correct.append(i);
+                    }
+                }
+
+                String c = correct.toString().replaceAll("0","A")
+                        .replaceAll("1","B")
+                        .replaceAll("2","C")
+                        .replaceAll("3","D");
+
+                o.setCorrect(c);
+            }
+
+//            List<QuestionBankVo> questionBankVos = super.convertToVoAndBindRelations (questionBanks, QuestionBankVo.class);
+
+            return R.ok(questionBanks);
+        } catch (Exception ex) {
+            return R.fail(ex.getMessage());
+        }
+    }
 }
 
Index: src/main/java/com/kalvin/kvf/modules/func/controller/TalkShowController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.controller;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.*;\r\nimport org.springframework.web.servlet.ModelAndView;\r\nimport com.kalvin.kvf.common.controller.BaseController;\r\nimport com.kalvin.kvf.common.dto.R;\r\nimport com.kalvin.kvf.modules.func.entity.TalkShow;\r\nimport com.kalvin.kvf.modules.func.service.TalkShowService;\r\n\r\nimport java.util.List;\r\n\r\n\r\n/**\r\n * <p>\r\n * 脱口秀 前端控制器\r\n * </p>\r\n * @since 2022-08-22 08:41:19\r\n */\r\n@RestController\r\n@RequestMapping(\"func/talkShow\")\r\npublic class TalkShowController extends BaseController {\r\n\r\n    @Autowired\r\n    private TalkShowService talkShowService;\r\n\r\n    @RequiresPermissions(\"func:talkShow:index\")\r\n    @GetMapping(\"index\")\r\n    public ModelAndView index() {\r\n        return new ModelAndView(\"func/talkShow\");\r\n    }\r\n\r\n    @GetMapping(value = \"edit\")\r\n    public ModelAndView edit(Long id) {\r\n        ModelAndView mv = new ModelAndView(\"func/talkShow_edit\");\r\n        TalkShow talkShow;\r\n        if (id == null) {\r\n            talkShow = new TalkShow();\r\n        } else {\r\n            talkShow = talkShowService.getById(id);\r\n        }\r\n        mv.addObject(\"editInfo\", talkShow);\r\n        return mv;\r\n    }\r\n\r\n    @GetMapping(value = \"list/data\")\r\n    public R listData(TalkShow talkShow) {\r\n        Page<TalkShow> page = talkShowService.listTalkShowPage(talkShow);\r\n        return R.ok(page);\r\n    }\r\n\r\n    @RequiresPermissions(\"func:talkShow:add\")\r\n    @PostMapping(value = \"add\")\r\n    public R add(TalkShow talkShow) {\r\n        talkShowService.save(talkShow);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:talkShow:del\")\r\n    @PostMapping(value = \"batchdel\")\r\n    public R batchdel(@RequestParam(\"ids\") List<Long> ids) {\r\n        talkShowService.removeByIds(ids);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:talkShow:edit\")\r\n    @PostMapping(value = \"edit\")\r\n    public R edit(TalkShow talkShow) {\r\n        talkShowService.updateById(talkShow);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:talkShow:del\")\r\n    @PostMapping(value = \"del/{id}\")\r\n    public R del(@PathVariable Long id) {\r\n        talkShowService.removeById(id);\r\n        return R.ok();\r\n    }\r\n\r\n    @GetMapping(value = \"get/{id}\")\r\n    public R get(@PathVariable Long id) {\r\n        return R.ok(talkShowService.getById(id));\r\n    }\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/controller/TalkShowController.java b/src/main/java/com/kalvin/kvf/modules/func/controller/TalkShowController.java
--- a/src/main/java/com/kalvin/kvf/modules/func/controller/TalkShowController.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/controller/TalkShowController.java	
@@ -1,14 +1,15 @@
 package com.kalvin.kvf.modules.func.controller;
 
+import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
 import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
-import org.apache.shiro.authz.annotation.RequiresPermissions;
-import org.springframework.beans.factory.annotation.Autowired;
-import org.springframework.web.bind.annotation.*;
-import org.springframework.web.servlet.ModelAndView;
 import com.kalvin.kvf.common.controller.BaseController;
 import com.kalvin.kvf.common.dto.R;
 import com.kalvin.kvf.modules.func.entity.TalkShow;
 import com.kalvin.kvf.modules.func.service.TalkShowService;
+import org.apache.shiro.authz.annotation.RequiresPermissions;
+import org.springframework.beans.factory.annotation.Autowired;
+import org.springframework.web.bind.annotation.*;
+import org.springframework.web.servlet.ModelAndView;
 
 import java.util.List;
 
@@ -51,9 +52,21 @@
         return R.ok(page);
     }
 
-    @RequiresPermissions("func:talkShow:add")
+    //    @RequiresPermissions("func:summerCamp:add")
     @PostMapping(value = "add")
     public R add(TalkShow talkShow) {
+        TalkShow sc = talkShowService.getOne(new LambdaQueryWrapper<TalkShow>()
+                .eq(TalkShow::getTel, talkShow.getTel()));
+
+        if (sc != null) {
+            return R.fail("您已报名，不可重复报名！");
+        }
+
+        Integer count = talkShowService.count();
+        if (count == 20) {
+            return R.fail("对不起，报名人数已满！");
+        }
+
         talkShowService.save(talkShow);
         return R.ok();
     }
@@ -84,5 +97,14 @@
         return R.ok(talkShowService.getById(id));
     }
 
+    /**
+     * 获取已报名数
+     *
+     * @return
+     */
+    @GetMapping(value = "getCount")
+    public R getCount() {
+        return R.ok(talkShowService.count());
+    }
 }
 
Index: src/main/java/com/kalvin/kvf/modules/func/controller/InfoTestController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.controller;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.*;\r\nimport org.springframework.web.servlet.ModelAndView;\r\nimport com.kalvin.kvf.common.controller.BaseController;\r\nimport com.kalvin.kvf.common.dto.R;\r\nimport com.kalvin.kvf.modules.func.entity.InfoTest;\r\nimport com.kalvin.kvf.modules.func.service.InfoTestService;\r\n\r\nimport java.util.List;\r\n\r\n\r\n/**\r\n * <p>\r\n *  前端控制器\r\n * </p>\r\n * @since 2022-06-15 09:43:42\r\n */\r\n@RestController\r\n@RequestMapping(\"func/infoTest\")\r\npublic class InfoTestController extends BaseController {\r\n\r\n    @Autowired\r\n    private InfoTestService infoTestService;\r\n\r\n    @RequiresPermissions(\"func:infoTest:index\")\r\n    @GetMapping(\"index\")\r\n    public ModelAndView index() {\r\n        return new ModelAndView(\"func/infoTest\");\r\n    }\r\n\r\n    @GetMapping(value = \"edit\")\r\n    public ModelAndView edit(Long id) {\r\n        ModelAndView mv = new ModelAndView(\"func/infoTest_edit\");\r\n        InfoTest infoTest;\r\n        if (id == null) {\r\n            infoTest = new InfoTest();\r\n        } else {\r\n            infoTest = infoTestService.getById(id);\r\n        }\r\n        mv.addObject(\"editInfo\", infoTest);\r\n        return mv;\r\n    }\r\n\r\n    @GetMapping(value = \"list/data\")\r\n    public R listData(InfoTest infoTest) {\r\n        Page<InfoTest> page = infoTestService.listInfoTestPage(infoTest);\r\n        return R.ok(page);\r\n    }\r\n\r\n    @RequiresPermissions(\"func:infoTest:add\")\r\n    @PostMapping(value = \"add\")\r\n    public R add(InfoTest infoTest) {\r\n        infoTestService.save(infoTest);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:infoTest:del\")\r\n    @PostMapping(value = \"batchdel\")\r\n    public R batchdel(@RequestParam(\"ids\") List<Long> ids) {\r\n        infoTestService.removeByIds(ids);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:infoTest:edit\")\r\n    @PostMapping(value = \"edit\")\r\n    public R edit(InfoTest infoTest) {\r\n        infoTestService.updateById(infoTest);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:infoTest:del\")\r\n    @PostMapping(value = \"del/{id}\")\r\n    public R del(@PathVariable Long id) {\r\n        infoTestService.removeById(id);\r\n        return R.ok();\r\n    }\r\n\r\n    @GetMapping(value = \"get/{id}\")\r\n    public R get(@PathVariable Long id) {\r\n        return R.ok(infoTestService.getById(id));\r\n    }\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/controller/InfoTestController.java b/src/main/java/com/kalvin/kvf/modules/func/controller/InfoTestController.java
--- a/src/main/java/com/kalvin/kvf/modules/func/controller/InfoTestController.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/controller/InfoTestController.java	
@@ -1,6 +1,17 @@
 package com.kalvin.kvf.modules.func.controller;
 
+import com.alibaba.fastjson.JSON;
+import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
 import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
+import com.diboot.core.controller.BaseCrudRestController;
+import com.kalvin.kvf.modules.func.entity.QuestionBank;
+import com.kalvin.kvf.modules.func.entity.QuestionCollect;
+import com.kalvin.kvf.modules.func.mapper.InfoTestMapper;
+import com.kalvin.kvf.modules.func.mapper.QuestionBankMapper;
+import com.kalvin.kvf.modules.func.mapper.QuestionCollectMapper;
+import com.kalvin.kvf.modules.func.vo.AnswerDto;
+import com.kalvin.kvf.modules.func.vo.QuestionBankVo;
+import org.apache.commons.lang3.StringUtils;
 import org.apache.shiro.authz.annotation.RequiresPermissions;
 import org.springframework.beans.factory.annotation.Autowired;
 import org.springframework.web.bind.annotation.*;
@@ -10,22 +21,32 @@
 import com.kalvin.kvf.modules.func.entity.InfoTest;
 import com.kalvin.kvf.modules.func.service.InfoTestService;
 
+import javax.annotation.Resource;
 import java.util.List;
 
 
 /**
  * <p>
- *  前端控制器
+ * 前端控制器
  * </p>
+ *
  * @since 2022-06-15 09:43:42
  */
 @RestController
 @RequestMapping("func/infoTest")
-public class InfoTestController extends BaseController {
+public class InfoTestController extends BaseCrudRestController {
+    @Resource
+    private QuestionBankMapper questionBankMapper;
+
+    @Resource
+    private InfoTestMapper infoTestMapper;
 
     @Autowired
     private InfoTestService infoTestService;
 
+    @Resource
+    private QuestionCollectMapper questionCollectMapper;
+
     @RequiresPermissions("func:infoTest:index")
     @GetMapping("index")
     public ModelAndView index() {
@@ -84,5 +105,93 @@
         return R.ok(infoTestService.getById(id));
     }
 
+    @GetMapping(value = "generate")
+    public R generate() {
+        List<Integer> ids = questionBankMapper.getRandom50();
+        String idsStr = StringUtils.join(ids, ",");
+        return R.ok(idsStr);
+    }
+
+    /**
+     * @param userId
+     * @return
+     */
+    @GetMapping(value = "getInfotests")
+    public R getInfotests(@RequestParam String userId) {
+        List<InfoTest> infoTests = infoTestMapper.getInfotests(userId);
+        return R.ok(infoTests);
+    }
+
+    /**
+     * @param id
+     * @return
+     */
+    @GetMapping(value = "getInfotest")
+    public R getInfotest(@RequestParam Integer id) {
+        InfoTest infoTest = infoTestService.getById(id);
+        List<QuestionBank> questionBanks = infoTestMapper.getInfotest(infoTest.getIds());
+
+        for (QuestionBank o : questionBanks) {
+            List<AnswerDto> answerDtos = JSON.parseArray(o.getAnswer(), AnswerDto.class);
+            o.setAnswerDtos(answerDtos);
+
+            StringBuilder correct = new StringBuilder();
+            for (int i = 0; i < answerDtos.size(); i++) {
+                if (answerDtos.get(i).isValue()) {
+                    correct.append(i);
+                }
+            }
+
+            String c = correct.toString().replaceAll("0", "A")
+                    .replaceAll("1", "B")
+                    .replaceAll("2", "C")
+                    .replaceAll("3", "D");
+
+            o.setCorrect(c);
+        }
+
+        List<QuestionBankVo> questionBankVos = super.convertToVoAndBindRelations(questionBanks, QuestionBankVo.class);
+
+        return R.ok(questionBankVos);
+    }
+
+    /**
+     * @return
+     */
+    @GetMapping(value = "getNewtest")
+    public R getNewtest(@RequestParam(value = "userid") String userid) {
+        List<QuestionBank> questionBanks = questionBankMapper.getNewtests();
+
+        for (QuestionBank o : questionBanks) {
+            List<AnswerDto> answerDtos = JSON.parseArray(o.getAnswer(), AnswerDto.class);
+            o.setAnswerDtos(answerDtos);
+
+            StringBuilder correct = new StringBuilder();
+            for (int i = 0; i < answerDtos.size(); i++) {
+                if (answerDtos.get(i).isValue()) {
+                    correct.append(i);
+                }
+            }
+
+            String c = correct.toString()
+                    .replaceAll("0", "A")
+                    .replaceAll("1", "B")
+                    .replaceAll("2", "C")
+                    .replaceAll("3", "D");
+
+            o.setCorrect(c);
+
+            QuestionCollect qc = questionCollectMapper.selectOne(new LambdaQueryWrapper<QuestionCollect>()
+                    .eq(QuestionCollect::getQsId, o.getId())
+                    .eq(QuestionCollect::getUserid, userid)
+                    .eq(QuestionCollect::getStatus, 0));
+
+            o.setSta(qc == null);
+        }
+
+//        List<QuestionBankVo> questionBankVos = super.convertToVoAndBindRelations(questionBanks, QuestionBankVo.class);
+
+        return R.ok(questionBanks);
+    }
 }
 
Index: src/main/resources/mapper/schedule/JobMapper.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\r\n<mapper namespace=\"com.kalvin.kvf.modules.schedule.mapper.JobMapper\">\r\n\r\n    <!-- 通用查询映射结果 -->\r\n    <resultMap id=\"BaseResultMap\" type=\"com.kalvin.kvf.modules.schedule.entity.Job\">\r\n        <id column=\"id\" property=\"id\" />\r\n        <result column=\"bean\" property=\"bean\" />\r\n        <result column=\"method\" property=\"method\" />\r\n        <result column=\"params\" property=\"params\" />\r\n        <result column=\"cron\" property=\"cron\" />\r\n        <result column=\"status\" property=\"status\" />\r\n        <result column=\"remark\" property=\"remark\" />\r\n        <result column=\"create_time\" property=\"createTime\" />\r\n    </resultMap>\r\n\r\n    <!-- 通用查询结果列 -->\r\n    <sql id=\"Base_Column_List\">\r\n       id, bean, method, params, cron, status, remark, create_time\r\n    </sql>\r\n\r\n    <select id=\"selectJobList\" resultType=\"com.kalvin.kvf.modules.schedule.entity.Job\">\r\n        select <include refid=\"Base_Column_List\" /> from schedule_job\r\n        <trim prefix=\"where\" prefixOverrides=\"and\">\r\n            <if test=\"job.bean != null and job.bean != ''\">\r\n                and bean like concat(#{job.bean}, \"%\")\r\n            </if>\r\n            <if test=\"job.status != null\">\r\n                and status = #{job.status}\r\n            </if>\r\n        </trim>\r\n        order by create_time desc\r\n    </select>\r\n\r\n</mapper>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/mapper/schedule/JobMapper.xml b/src/main/resources/mapper/schedule/JobMapper.xml
--- a/src/main/resources/mapper/schedule/JobMapper.xml	
+++ b/src/main/resources/mapper/schedule/JobMapper.xml	
@@ -8,6 +8,7 @@
         <result column="bean" property="bean" />
         <result column="method" property="method" />
         <result column="params" property="params" />
+        <result column="webhook" property="webhook" />
         <result column="cron" property="cron" />
         <result column="status" property="status" />
         <result column="remark" property="remark" />
@@ -16,7 +17,7 @@
 
     <!-- 通用查询结果列 -->
     <sql id="Base_Column_List">
-       id, bean, method, params, cron, status, remark, create_time
+       id, bean, method, params, webhook, cron, status, remark, create_time
     </sql>
 
     <select id="selectJobList" resultType="com.kalvin.kvf.modules.schedule.entity.Job">
Index: src/main/java/com/kalvin/kvf/modules/util/DateUtil.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.util;public class DateUtil {\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/util/DateUtil.java b/src/main/java/com/kalvin/kvf/modules/util/DateUtil.java
--- a/src/main/java/com/kalvin/kvf/modules/util/DateUtil.java	
+++ b/src/main/java/com/kalvin/kvf/modules/util/DateUtil.java	
@@ -1,2 +1,83 @@
-package com.kalvin.kvf.modules.util;public class DateUtil {
-}
+package com.kalvin.kvf.modules.util;
+
+import org.apache.commons.lang3.time.DateUtils;
+
+import java.text.DateFormat;
+import java.text.SimpleDateFormat;
+import java.util.Calendar;
+import java.util.Date;
+
+public class DateUtil {
+    /**
+     * 生成随机时间
+     *
+     * @param beginDate
+     * @param endDate
+     * @return
+     */
+    public static Date randomDate(String beginDate, String endDate) {
+        try {
+            SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
+            Date start =  DateUtils.addHours(format.parse(beginDate),9);;
+            Date end = format.parse(endDate);
+            // getTime()表示返回自 1970 年 1 月 1 日 00:00:00 GMT 以来此 Date 对象表示的毫秒数。
+            if (start.getTime() > end.getTime()) {
+                return null;
+            }
+            long date = random(start.getTime(), end.getTime());
+            return new Date(date);
+        } catch (Exception e) {
+            e.printStackTrace();
+        }
+        return null;
+    }
+
+    public static long random(long begin, long end) {
+        long rtn = begin + (long) (Math.random() * (end - begin));
+        // 如果返回的是开始时间和结束时间，则递归调用本函数查找随机值
+        if (rtn == begin || rtn == end) {
+            return random(begin, end);
+        }
+        return rtn;
+    }
+
+    /**
+     * 获取今天的时间字符串
+     *
+     * @return
+     */
+    public static String todayDateStr() {
+        Date date = new Date();
+        DateFormat format = new SimpleDateFormat("yyyy-MM-dd");
+
+        return format.getDateInstance().format(date);
+    }
+
+    /**
+     * 获取明天的日期字符串
+     *
+     * @return
+     */
+    public static String tomorrowDateStr() {
+        Date date = new Date();
+        Calendar calendar = Calendar.getInstance();
+        calendar.setTime(date);
+        //把日期往后增加一天.整数往后推,负数往前移动(1:表示明天、-1：表示昨天，0：表示今天)
+        calendar.add(Calendar.DATE, 1);
+
+        //这个时间就是日期往后推一天的结果
+        date = calendar.getTime();
+
+        SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
+        String tomorrowStr = formatter.format(date);
+        return tomorrowStr;
+    }
+
+    public static String addTime() {
+        /** 开始时间     结束时间   */
+        Date randomDate = randomDate("2020-08-01", "2021-04-07");
+        SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
+        String result = format.format(randomDate);
+        return result;
+    }
+}
\ No newline at end of file
Index: src/main/java/com/kalvin/kvf/modules/func/controller/InfoTestRecordController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.controller;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport org.apache.shiro.authz.annotation.RequiresPermissions;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.bind.annotation.*;\r\nimport org.springframework.web.servlet.ModelAndView;\r\nimport com.kalvin.kvf.common.controller.BaseController;\r\nimport com.kalvin.kvf.common.dto.R;\r\nimport com.kalvin.kvf.modules.func.entity.InfoTestRecord;\r\nimport com.kalvin.kvf.modules.func.service.InfoTestRecordService;\r\n\r\nimport java.util.List;\r\n\r\n\r\n/**\r\n * <p>\r\n *  前端控制器\r\n * </p>\r\n * @since 2022-06-16 16:59:58\r\n */\r\n@RestController\r\n@RequestMapping(\"func/infoTestRecord\")\r\npublic class InfoTestRecordController extends BaseController {\r\n\r\n    @Autowired\r\n    private InfoTestRecordService infoTestRecordService;\r\n\r\n    @RequiresPermissions(\"func:infoTestRecord:index\")\r\n    @GetMapping(\"index\")\r\n    public ModelAndView index() {\r\n        return new ModelAndView(\"func/infoTestRecord\");\r\n    }\r\n\r\n    @GetMapping(value = \"edit\")\r\n    public ModelAndView edit(Long id) {\r\n        ModelAndView mv = new ModelAndView(\"func/infoTestRecord_edit\");\r\n        InfoTestRecord infoTestRecord;\r\n        if (id == null) {\r\n            infoTestRecord = new InfoTestRecord();\r\n        } else {\r\n            infoTestRecord = infoTestRecordService.getById(id);\r\n        }\r\n        mv.addObject(\"editInfo\", infoTestRecord);\r\n        return mv;\r\n    }\r\n\r\n    @GetMapping(value = \"list/data\")\r\n    public R listData(InfoTestRecord infoTestRecord) {\r\n        Page<InfoTestRecord> page = infoTestRecordService.listInfoTestRecordPage(infoTestRecord);\r\n        return R.ok(page);\r\n    }\r\n\r\n    @RequiresPermissions(\"func:infoTestRecord:add\")\r\n    @PostMapping(value = \"add\")\r\n    public R add(InfoTestRecord infoTestRecord) {\r\n        infoTestRecordService.save(infoTestRecord);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:infoTestRecord:del\")\r\n    @PostMapping(value = \"batchdel\")\r\n    public R batchdel(@RequestParam(\"ids\") List<Long> ids) {\r\n        infoTestRecordService.removeByIds(ids);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:infoTestRecord:edit\")\r\n    @PostMapping(value = \"edit\")\r\n    public R edit(InfoTestRecord infoTestRecord) {\r\n        infoTestRecordService.updateById(infoTestRecord);\r\n        return R.ok();\r\n    }\r\n\r\n    @RequiresPermissions(\"func:infoTestRecord:del\")\r\n    @PostMapping(value = \"del/{id}\")\r\n    public R del(@PathVariable Long id) {\r\n        infoTestRecordService.removeById(id);\r\n        return R.ok();\r\n    }\r\n\r\n    @GetMapping(value = \"get/{id}\")\r\n    public R get(@PathVariable Long id) {\r\n        return R.ok(infoTestRecordService.getById(id));\r\n    }\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/controller/InfoTestRecordController.java b/src/main/java/com/kalvin/kvf/modules/func/controller/InfoTestRecordController.java
--- a/src/main/java/com/kalvin/kvf/modules/func/controller/InfoTestRecordController.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/controller/InfoTestRecordController.java	
@@ -1,5 +1,6 @@
 package com.kalvin.kvf.modules.func.controller;
 
+import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
 import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
 import org.apache.shiro.authz.annotation.RequiresPermissions;
 import org.springframework.beans.factory.annotation.Autowired;
@@ -15,8 +16,9 @@
 
 /**
  * <p>
- *  前端控制器
+ * 前端控制器
  * </p>
+ *
  * @since 2022-06-16 16:59:58
  */
 @RestController
@@ -84,5 +86,19 @@
         return R.ok(infoTestRecordService.getById(id));
     }
 
+    /**
+     * 获取新警测试前40名
+     * @return
+     */
+    @GetMapping(value = "getTop40")
+    public R getTop40() {
+        List<InfoTestRecord> infoTestRecords = infoTestRecordService.list(
+                new LambdaQueryWrapper<InfoTestRecord>()
+                        .eq(InfoTestRecord::getTestId, 4)
+                        .orderByDesc(InfoTestRecord::getScore)
+                        .last("limit 40")
+        );
+        return R.ok(infoTestRecords);
+    }
 }
 
Index: src/main/resources/mapper/func/UserInfoMapper.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\r\n<mapper namespace=\"com.kalvin.kvf.modules.func.mapper.UserInfoMapper\">\r\n\r\n    <!-- 通用查询映射结果 -->\r\n    <resultMap id=\"BaseResultMap\" type=\"com.kalvin.kvf.modules.func.entity.UserInfo\">\r\n        <id column=\"id\" property=\"id\" />\r\n        <result column=\"userid\" property=\"userid\" />\r\n        <result column=\"realname\" property=\"realname\" />\r\n        <result column=\"mobile\" property=\"mobile\" />\r\n        <result column=\"department\" property=\"department\" />\r\n        <result column=\"unionid\" property=\"unionid\" />\r\n        <result column=\"openid\" property=\"openid\" />\r\n        <result column=\"avatar\" property=\"avatar\" />\r\n        <result column=\"max_level\" property=\"maxLevel\" />\r\n        <result column=\"today_cnt\" property=\"todayCnt\" />\r\n        <result column=\"create_time\" property=\"createTime\" />\r\n        <result column=\"update_time\" property=\"updateTime\" />\r\n    </resultMap>\r\n\r\n    <!-- 通用查询结果列 -->\r\n    <sql id=\"Base_Column_List\">\r\n       id, userid, realname, mobile, department, unionid, openid, avatar, max_level, create_time, update_time\r\n    </sql>\r\n\r\n    <select id=\"selectUserInfoList\" resultType=\"com.kalvin.kvf.modules.func.entity.UserInfo\">\r\n        select <include refid=\"Base_Column_List\" /> from func_user_info\r\n        <trim prefix=\"where\" prefixOverrides=\"and\">\r\n            <if test=\"userInfo.realname != null and userInfo.realname != ''\">\r\n                and realname like concat(#{userInfo.realname}, \"%\")\r\n            </if>\r\n            <if test=\"userInfo.mobile != null and userInfo.mobile != ''\">\r\n                and mobile like concat(#{userInfo.mobile}, \"%\")\r\n            </if>\r\n            <if test=\"userInfo.openid != null and userInfo.openid != ''\">\r\n                and openid like concat(#{userInfo.openid}, \"%\")\r\n            </if>\r\n            <if test=\"userInfo.userid != null and userInfo.userid != ''\">\r\n                and userid like concat(#{userInfo.userid}, \"%\")\r\n            </if>\r\n        </trim>\r\n    </select>\r\n\r\n    <select id=\"getRank\" resultType=\"com.kalvin.kvf.modules.func.entity.UserInfo\">\r\n        select <include refid=\"Base_Column_List\" /> from func_user_info\r\n        order by max_level desc\r\n    </select>\r\n</mapper>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/mapper/func/UserInfoMapper.xml b/src/main/resources/mapper/func/UserInfoMapper.xml
--- a/src/main/resources/mapper/func/UserInfoMapper.xml	
+++ b/src/main/resources/mapper/func/UserInfoMapper.xml	
@@ -16,11 +16,13 @@
         <result column="today_cnt" property="todayCnt" />
         <result column="create_time" property="createTime" />
         <result column="update_time" property="updateTime" />
+        <result column="res_cnt" property="resCnt" />
+        <result column="res_score" property="resScore" />
     </resultMap>
 
     <!-- 通用查询结果列 -->
     <sql id="Base_Column_List">
-       id, userid, realname, mobile, department, unionid, openid, avatar, max_level, create_time, update_time
+       id, userid, realname, mobile, department, unionid, openid, avatar, max_level, create_time, update_time,res_cnt, res_score
     </sql>
 
     <select id="selectUserInfoList" resultType="com.kalvin.kvf.modules.func.entity.UserInfo">
@@ -43,6 +45,6 @@
 
     <select id="getRank" resultType="com.kalvin.kvf.modules.func.entity.UserInfo">
         select <include refid="Base_Column_List" /> from func_user_info
-        order by max_level desc
+        ORDER BY res_score desc , res_cnt asc, realname
     </select>
 </mapper>
Index: src/main/java/com/kalvin/kvf/modules/func/entity/UserInfo.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.entity;\r\n\r\nimport com.baomidou.mybatisplus.annotation.IdType;\r\nimport com.baomidou.mybatisplus.annotation.TableId;\r\nimport com.baomidou.mybatisplus.annotation.TableName;\r\nimport com.kalvin.kvf.common.entity.BaseEntity;\r\nimport lombok.Data;\r\nimport lombok.EqualsAndHashCode;\r\nimport lombok.experimental.Accessors;\r\nimport org.springframework.format.annotation.DateTimeFormat;\r\n\r\nimport java.util.Date;\r\n\r\n/**\r\n * <p>\r\n * 用户信息表\r\n * </p>\r\n * @since 2021-03-11 14:26:11\r\n */\r\n@Data\r\n@EqualsAndHashCode(callSuper = true)\r\n@Accessors(chain = true)\r\n@TableName(\"func_user_info\")\r\npublic class UserInfo extends BaseEntity {\r\n\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    /**\r\n     * \r\n     */\r\n    @TableId(value = \"id\", type = IdType.AUTO)\r\n    private Integer id;\r\n\r\n    /**\r\n     * 用户id\r\n     */\r\n    private String userid;\r\n\r\n    /**\r\n     * 姓名\r\n     */\r\n    private String realname;\r\n\r\n    /**\r\n     * 手机号\r\n     */\r\n    private String mobile;\r\n\r\n    /**\r\n     * 部门id\r\n     */\r\n    private String department;\r\n\r\n    /**\r\n     * unionid\r\n     */\r\n    private String unionid;\r\n\r\n    /**\r\n     * openid\r\n     */\r\n    private String openid;\r\n\r\n    /**\r\n     * 头像\r\n     */\r\n    private String avatar;\r\n\r\n    /**\r\n     * 挑战等级\r\n     */\r\n    private Integer maxLevel;\r\n\r\n    /**\r\n     * 当日挑战次数\r\n     */\r\n    private Integer todayCnt;\r\n\r\n    /**\r\n     * 创建时间\r\n     */\r\n    @DateTimeFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\r\n    private Date createTime;\r\n\r\n    /**\r\n     * 更新时间\r\n     */\r\n    @DateTimeFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\r\n    private Date updateTime;\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/entity/UserInfo.java b/src/main/java/com/kalvin/kvf/modules/func/entity/UserInfo.java
--- a/src/main/java/com/kalvin/kvf/modules/func/entity/UserInfo.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/entity/UserInfo.java	
@@ -1,6 +1,7 @@
 package com.kalvin.kvf.modules.func.entity;
 
 import com.baomidou.mybatisplus.annotation.IdType;
+import com.baomidou.mybatisplus.annotation.TableField;
 import com.baomidou.mybatisplus.annotation.TableId;
 import com.baomidou.mybatisplus.annotation.TableName;
 import com.kalvin.kvf.common.entity.BaseEntity;
@@ -88,4 +89,13 @@
     @DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss")
     private Date updateTime;
 
+    /**
+     * 答题次数
+     */
+    private int resCnt;
+
+    /**
+     * 答题积分
+     */
+    private int resScore;
 }
Index: src/main/java/com/kalvin/kvf/modules/func/service/UserInfoService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.service;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport com.baomidou.mybatisplus.extension.service.IService;\r\nimport com.kalvin.kvf.modules.func.entity.UserInfo;\r\n\r\n/**\r\n * <p>\r\n * 用户信息表 服务类\r\n * </p>\r\n * @since 2021-03-11 14:26:11\r\n */\r\npublic interface UserInfoService extends IService<UserInfo> {\r\n\r\n    /**\r\n     * 获取列表。分页\r\n     * @param userInfo 查询参数\r\n     * @return page\r\n     */\r\n    Page<UserInfo> listUserInfoPage(UserInfo userInfo);\r\n\r\n    /**\r\n     * 获取列表。分页 获取排行榜\r\n     * @return page\r\n     */\r\n    Page<UserInfo> getRank(UserInfo userInfo);\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/service/UserInfoService.java b/src/main/java/com/kalvin/kvf/modules/func/service/UserInfoService.java
--- a/src/main/java/com/kalvin/kvf/modules/func/service/UserInfoService.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/service/UserInfoService.java	
@@ -24,4 +24,10 @@
      * @return page
      */
     Page<UserInfo> getRank(UserInfo userInfo);
+
+    /**
+     * 获取列表。分页 获取本月排行榜
+     * @return page
+     */
+    Page<UserInfo> getMonthRank(UserInfo userInfo);
 }
Index: src/main/java/com/kalvin/kvf/common/config/WebMvcConfig.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.common.config;\r\n\r\nimport com.fasterxml.jackson.databind.DeserializationFeature;\r\nimport com.fasterxml.jackson.databind.ObjectMapper;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.http.converter.HttpMessageConverter;\r\nimport org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;\r\nimport org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;\r\nimport org.springframework.web.servlet.config.annotation.ViewControllerRegistry;\r\nimport org.springframework.web.servlet.config.annotation.WebMvcConfigurer;\r\n\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.List;\r\n\r\n/**\r\n * @author Kalvin\r\n */\r\n@Configuration\r\npublic class WebMvcConfig implements WebMvcConfigurer {\r\n\r\n    @Override\r\n    public void addViewControllers(ViewControllerRegistry registry) {\r\n        registry.addViewController(\"/403\").setViewName(\"/403\");\r\n        registry.addViewController(\"/404\").setViewName(\"/404\");\r\n    }\r\n\r\n    /** 本地文件 */\r\n    @Override\r\n    public void addResourceHandlers(ResourceHandlerRegistry registry) {\r\n        // /local/** 指向 /nhga/file/stable/\r\n        registry.addResourceHandler(\"/qrcode/**\")\r\n                .addResourceLocations(\"file:D:/QRCode/\");\r\n\r\n        registry.addResourceHandler(\"/miniqr/**\")\r\n                .addResourceLocations(\"file:D:/QRCode/\");\r\n    }\r\n\r\n    @Override\r\n    public void extendMessageConverters(List<HttpMessageConverter<?>> converters) {\r\n        MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();\r\n        ObjectMapper objectMapper = converter.getObjectMapper();\r\n        // 时间格式化\r\n        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\r\n        objectMapper.setDateFormat(new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\"));\r\n        // 设置格式化内容\r\n        converter.setObjectMapper(objectMapper);\r\n        converters.add(0, converter);\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/common/config/WebMvcConfig.java b/src/main/java/com/kalvin/kvf/common/config/WebMvcConfig.java
--- a/src/main/java/com/kalvin/kvf/common/config/WebMvcConfig.java	
+++ b/src/main/java/com/kalvin/kvf/common/config/WebMvcConfig.java	
@@ -2,9 +2,11 @@
 
 import com.fasterxml.jackson.databind.DeserializationFeature;
 import com.fasterxml.jackson.databind.ObjectMapper;
+import org.springframework.context.annotation.Bean;
 import org.springframework.context.annotation.Configuration;
 import org.springframework.http.converter.HttpMessageConverter;
 import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
+import org.springframework.web.servlet.config.annotation.CorsRegistry;
 import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
 import org.springframework.web.servlet.config.annotation.ViewControllerRegistry;
 import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;
@@ -17,6 +19,13 @@
  */
 @Configuration
 public class WebMvcConfig implements WebMvcConfigurer {
+    @Override
+    public void addCorsMappings(CorsRegistry registry) {
+        registry.addMapping("/**")
+                .allowedHeaders("*")
+                .allowedMethods("*")
+                .allowedOrigins("*");
+    }
 
     @Override
     public void addViewControllers(ViewControllerRegistry registry) {
@@ -24,15 +33,14 @@
         registry.addViewController("/404").setViewName("/404");
     }
 
-    /** 本地文件 */
+    /**
+     * 本地文件
+     */
     @Override
     public void addResourceHandlers(ResourceHandlerRegistry registry) {
         // /local/** 指向 /nhga/file/stable/
-        registry.addResourceHandler("/qrcode/**")
-                .addResourceLocations("file:D:/QRCode/");
-
-        registry.addResourceHandler("/miniqr/**")
-                .addResourceLocations("file:D:/QRCode/");
+        registry.addResourceHandler("/video/**")
+                .addResourceLocations("file:D:/每日一练/userFile/video/");
     }
 
     @Override
@@ -46,4 +54,5 @@
         converter.setObjectMapper(objectMapper);
         converters.add(0, converter);
     }
+
 }
Index: src/main/java/com/kalvin/kvf/KvfAdminApplication.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf;\r\n\r\nimport com.alibaba.druid.spring.boot.autoconfigure.DruidDataSourceAutoConfigure;\r\nimport org.springframework.boot.SpringApplication;\r\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\r\n\r\n/**\r\n * @author Administrator\r\n */\r\n@SpringBootApplication(exclude = {\r\n        org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration.class, DruidDataSourceAutoConfigure.class})\r\npublic class KvfAdminApplication {\r\n\r\n    public static void main(String[] args) {\r\n        SpringApplication.run(KvfAdminApplication.class, args);\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/KvfAdminApplication.java b/src/main/java/com/kalvin/kvf/KvfAdminApplication.java
--- a/src/main/java/com/kalvin/kvf/KvfAdminApplication.java	
+++ b/src/main/java/com/kalvin/kvf/KvfAdminApplication.java	
@@ -14,5 +14,4 @@
     public static void main(String[] args) {
         SpringApplication.run(KvfAdminApplication.class, args);
     }
-
 }
Index: src/main/resources/static/talkshow/index.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1,user-scalable=0,viewport-fit=cover\">\r\n    <meta name=\"wechat-enable-text-zoom-em\" content=\"true\">\r\n    <title>红船小义警特警少年夏令营</title>\r\n    <link rel=\"stylesheet\" href=\"css/weui.css\">\r\n    <script src=\"js/jquery.min.js\"></script>\r\n    <style>\r\n        /* 控制器 */\r\n        .wah-controls {\r\n            position: fixed;\r\n            z-index: 100000;\r\n            bottom: 50px;\r\n            right: constant(safe-area-inset-right);\r\n            right: env(safe-area-inset-right);\r\n            display: flex;\r\n            align-items: center;\r\n            background: rgba(0, 0, 0, 0.5);\r\n            color: #fff;\r\n            font-size: 14px;\r\n            border-top-left-radius: 4px;\r\n            border-bottom-left-radius: 4px;\r\n            overflow: hidden;\r\n        }\r\n\r\n        .wah-control {\r\n            padding: 4px;\r\n            display: flex;\r\n            align-items: center;\r\n        }\r\n\r\n        /* 热区蓝字 */\r\n        .wah-hotarea-size {\r\n            z-index: 99999;\r\n            font-size: 10px;\r\n            background: rgba(0, 0, 255, 0.5);\r\n            color: #FFF;\r\n        }\r\n\r\n        /* 读屏红框 */\r\n        .wah-reading-panel {\r\n            position: absolute;\r\n            top: 0;\r\n            right: 0;\r\n            bottom: 0;\r\n            left: 0;\r\n            pointer-events: none;\r\n        }\r\n\r\n        .wah-reading-outline {\r\n            position: absolute;\r\n            z-index: 99999;\r\n            transform: translateZ(999999px);\r\n            border: 2px solid rgba(255, 0, 0, 0.5);\r\n            background: rgba(100, 0, 0, 0.3);\r\n            font-size: 10px;\r\n            font-weight: 500;\r\n            line-height: 1.4;\r\n            color: #fff;\r\n            word-break: break-all;\r\n        }\r\n    </style>\r\n</head>\r\n\r\n<body>\r\n<div class=\"page\">\r\n    <div role=\"alert\" class=\"weui-toptips weui-toptips_warn\" id=\"topTips\">错误提示</div>\r\n    <form action=\"/func/summerCamp/add\" class=\"weui-form\" id=\"T_FORM\">\r\n        <div class=\"weui-form__text-area\">\r\n            <h2 class=\"weui-form__title\">报名表</h2>\r\n            <div class=\"weui-form__desc\">红船小义警特警少年夏令营</div>\r\n        </div>\r\n        <div class=\"weui-form__control-area\">\r\n            <div class=\"weui-cells__group weui-cells__group_form\">\r\n                <!-- <div class=\"weui-cells__title\">表单组标题</div> -->\r\n                <div class=\"weui-cells\">\r\n                    <label for=\"name\" class=\"weui-cell weui-cell_active\">\r\n                        <div class=\"weui-cell__hd\"><span class=\"weui-label\">姓名</span></div>\r\n                        <div class=\"weui-cell__bd\">\r\n                            <input id=\"name\" name=\"name\" class=\"weui-input\" placeholder=\"填写孩子姓名\"/>\r\n                        </div>\r\n                    </label>\r\n                    <label for=\"age\" class=\"weui-cell weui-cell_active\">\r\n                        <div class=\"weui-cell__hd\"><span class=\"weui-label\">年龄</span></div>\r\n                        <div class=\"weui-cell__bd\">\r\n                            <input id=\"age\" name=\"age\" class=\"weui-input\" placeholder=\"填写孩子年龄\" type=\"number\"/>\r\n                        </div>\r\n                    </label>\r\n                    <label for=\"tel\" class=\"weui-cell weui-cell_active\">\r\n                        <div class=\"weui-cell__hd\"><span class=\"weui-label\">联系电话</span>\r\n                            <!-- <div class=\"weui-cell__desc\">副标题</div> -->\r\n                        </div>\r\n                        <div class=\"weui-cell__bd\">\r\n                            <input id=\"tel\" name=\"tel\" class=\"weui-input\" placeholder=\"填写家长电话号码\" type=\"number\"\r\n                                   pattern=\"[0-9]*\"/>\r\n                        </div>\r\n                    </label>\r\n                    <div class=\"weui-cells__group\">\r\n                        <div class=\"weui-cell\">性别</div>\r\n                        <div class=\"weui-cells weui-cells_radio\">\r\n                            <label class=\"weui-cell weui-cell_active weui-check__label\">\r\n                                <div class=\"weui-cell__bd\">\r\n                                    <p>男</p>\r\n                                </div>\r\n                                <div class=\"weui-cell__ft\">\r\n                                    <input type=\"radio\" name=\"sex\" value=\"male\" class=\"weui-check\" checked=\"checked\"/>\r\n                                    <span class=\"weui-icon-checked\"></span>\r\n                                </div>\r\n                            </label>\r\n                            <label class=\"weui-cell weui-cell_active weui-check__label\">\r\n                                <div class=\"weui-cell__bd\">\r\n                                    <p>女</p>\r\n                                </div>\r\n                                <div class=\"weui-cell__ft\">\r\n                                    <input type=\"radio\" name=\"sex\" value=\"female\" class=\"weui-check\"/>\r\n                                    <span class=\"weui-icon-checked\"></span>\r\n                                </div>\r\n                            </label>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"weui-cells__group\">\r\n                        <div class=\"weui-cell\">7天内有无出嘉兴大市</div>\r\n                        <div class=\"weui-cells weui-cells_radio\">\r\n                            <label class=\"weui-cell weui-cell_active weui-check__label\">\r\n                                <div class=\"weui-cell__bd\">\r\n                                    <p>无</p>\r\n                                </div>\r\n                                <div class=\"weui-cell__ft\">\r\n                                    <input type=\"radio\" class=\"weui-check\" name=\"ifout\" value=\"0\"\r\n                                           checked=\"checked\"/>\r\n                                    <span class=\"weui-icon-checked\"></span>\r\n                                </div>\r\n                            </label>\r\n                            <label class=\"weui-cell weui-cell_active weui-check__label\">\r\n                                <div class=\"weui-cell__bd\">\r\n                                    <p>有</p>\r\n                                </div>\r\n                                <div class=\"weui-cell__ft\">\r\n                                    <input type=\"radio\" name=\"ifout\" value=\"1\" class=\"weui-check\"/>\r\n                                    <span class=\"weui-icon-checked\"></span>\r\n                                </div>\r\n                            </label>\r\n                        </div>\r\n                    </div>\r\n                    <label for=\"place\" class=\"weui-cell weui-cell_active\">\r\n                        <div class=\"weui-cell__hd\"><span class=\"weui-label\">前往地点</span></div>\r\n                        <div class=\"weui-cell__bd\">\r\n                            <input id=\"place\" name=\"place\" class=\"weui-input\" placeholder=\"填写前往地点\"/>\r\n                        </div>\r\n                    </label>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <!-- <div class=\"weui-form__tips-area\">\r\n            <p class=\"weui-form__tips\">\r\n                表单页提示，居中对齐\r\n            </p>\r\n        </div> -->\r\n        <div class=\"weui-form__opr-area\">\r\n            <a role=\"button\" disabled aria-disabled=\"true\" class=\"weui-btn weui-btn_primary weui-btn_disabled\"\r\n               href=\"javascript:\" id=\"showTooltips\">确定</a>\r\n        </div>\r\n        <!-- <div class=\"weui-form__tips-area\">\r\n            <p class=\"weui-form__tips\">\r\n                表单页提示，居中对齐\r\n            </p>\r\n        </div> -->\r\n        <div class=\"weui-form__extra-area\">\r\n            <div class=\"weui-footer\">\r\n                <p class=\"weui-footer__links\">\r\n<!--                    <a href=\"javascript:\" class=\"weui-footer__link\">南湖区公安局分局</a>-->\r\n                </p>\r\n                <p class=\"weui-footer__text\">Copyright © 2020-2025 alpha.wu</p>\r\n            </div>\r\n        </div>\r\n    </form>\r\n    <!--BEGIN dialog1-->\r\n    <div class=\"js_dialog\" role=\"dialog\"  aria-hidden=\"true\" aria-modal=\"true\" aria-labelledby=\"js_title1\" id=\"iosDialog1\" style=\"display: none;\">\r\n        <div class=\"weui-mask\"></div>\r\n        <div class=\"weui-dialog\">\r\n            <div class=\"weui-dialog__hd\"><strong class=\"weui-dialog__title\" id=\"js_title1\">提示</strong></div>\r\n            <div id=\"content\" class=\"weui-dialog__bd\">对不起，夏令营总数15人，报名人数已满！</div>\r\n            <div class=\"weui-dialog__ft\">\r\n                <a role=\"button\" class=\"weui-dialog__btn weui-dialog__btn_primary\"\r\n                   href=\"javascript: WeixinJSBridge.call('closeWindow')\" >关闭</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <!--END dialog1-->\r\n    <div role=\"alert\" id=\"js_toast\" style=\"display: none;\">\r\n        <div class=\"weui-mask_transparent\"></div>\r\n        <div class=\"weui-toast\">\r\n            <i class=\"weui-icon-success-no-circle weui-icon_toast\"></i>\r\n            <p class=\"weui-toast__content\">报名成功</p>\r\n        </div>\r\n    </div>\r\n</div>\r\n<script type=\"text/javascript\">\r\n    $(function () {\r\n        $.ajax({\r\n            type: 'get',\r\n            url: '/func/summerCamp/getCount',\r\n            async: false,\r\n            success: function (r) {\r\n                if (r.code === 200) {\r\n                    if(r.data === 15){\r\n                        var $iosDialog1 = $('#iosDialog1');\r\n                        $iosDialog1.fadeIn(200);\r\n                    }\r\n                }\r\n            }\r\n        })\r\n\r\n        var $toast = $('#js_toast');\r\n        var $input = $('#name');\r\n        $input.on('input', function () {\r\n            if ($input.val()) {\r\n                $('#showTooltips').removeClass('weui-btn_disabled');\r\n                $('#showTooltips').attr('aria-disabled', 'false');\r\n                $('#showTooltips').removeAttr('disabled');\r\n            } else {\r\n                $('#showTooltips').addClass('weui-btn_disabled');\r\n                $('#showTooltips').addClass('weui-btn_disabled');\r\n                $('#showTooltips').attr('aria-disabled', 'true');\r\n                $('#showTooltips').addAttr('disabled');\r\n            }\r\n        });\r\n\r\n        $('#showTooltips').on('click', function () {\r\n            if ($(this).hasClass('weui-btn_disabled')) return;\r\n\r\n            var name = $('#name').val();\r\n            if (name === undefined || name === '') {\r\n                $('#topTips').text(\"请输入孩子姓名！\");\r\n                $('#topTips').fadeIn(200);\r\n                setTimeout(function() {\r\n                    $('#topTips').fadeOut(100);\r\n                }, 2000);\r\n                return;\r\n            }\r\n\r\n            var age = $('#age').val();\r\n            if (age === undefined || age === '') {\r\n                $('#topTips').text(\"请输入孩子年龄！\");\r\n                $('#topTips').fadeIn(200);\r\n                setTimeout(function() {\r\n                    $('#topTips').fadeOut(100);\r\n                }, 2000);\r\n                return;\r\n            }\r\n\r\n            var tel = $('#tel').val();\r\n            if (tel === undefined || tel === '') {\r\n                $('#topTips').text(\"请输入家长联系电话！\");\r\n                $('#topTips').fadeIn(200)\r\n                setTimeout(function() {\r\n                    $('#topTips').fadeOut(100);\r\n                }, 2000);\r\n                return;\r\n            }\r\n\r\n            var sex = $(\"input[name='sex']:checked\").val();\r\n            var ifout = $(\"input[name='ifout']:checked\").val();\r\n            //提交 Ajax 成功后，关闭当前弹层并重载表格\r\n            $.ajax({\r\n                type: 'post',\r\n                url: '/func/summerCamp/add',\r\n                data: {\r\n                    name: name,\r\n                    age: age,\r\n                    sex: sex,\r\n                    tel: tel,\r\n                    ifout: ifout,\r\n                    place: $('#place').val(),\r\n                },\r\n                async: false,\r\n                success: function (r) {\r\n                    if (r.code === 200) {\r\n                        $toast.fadeIn(100);\r\n                        setTimeout(function() {\r\n                            $toast.fadeOut(100);\r\n                            WeixinJSBridge.call('closeWindow')\r\n                        }, 2000);\r\n                    }else{\r\n                        $('#topTips').text(r.msg);\r\n                        $('#topTips').fadeIn(200);\r\n                        setTimeout(function() {\r\n                            $('#topTips').fadeOut(100);\r\n                        }, 2000);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    });\r\n</script>\r\n</body>\r\n</html>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/static/talkshow/index.html b/src/main/resources/static/talkshow/index.html
--- a/src/main/resources/static/talkshow/index.html	
+++ b/src/main/resources/static/talkshow/index.html	
@@ -4,64 +4,10 @@
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,viewport-fit=cover">
     <meta name="wechat-enable-text-zoom-em" content="true">
-    <title>红船小义警特警少年夏令营</title>
+    <title>南湖区反诈脱口秀现场观众评委招募</title>
     <link rel="stylesheet" href="css/weui.css">
     <script src="js/jquery.min.js"></script>
-    <style>
-        /* 控制器 */
-        .wah-controls {
-            position: fixed;
-            z-index: 100000;
-            bottom: 50px;
-            right: constant(safe-area-inset-right);
-            right: env(safe-area-inset-right);
-            display: flex;
-            align-items: center;
-            background: rgba(0, 0, 0, 0.5);
-            color: #fff;
-            font-size: 14px;
-            border-top-left-radius: 4px;
-            border-bottom-left-radius: 4px;
-            overflow: hidden;
-        }
-
-        .wah-control {
-            padding: 4px;
-            display: flex;
-            align-items: center;
-        }
 
-        /* 热区蓝字 */
-        .wah-hotarea-size {
-            z-index: 99999;
-            font-size: 10px;
-            background: rgba(0, 0, 255, 0.5);
-            color: #FFF;
-        }
-
-        /* 读屏红框 */
-        .wah-reading-panel {
-            position: absolute;
-            top: 0;
-            right: 0;
-            bottom: 0;
-            left: 0;
-            pointer-events: none;
-        }
-
-        .wah-reading-outline {
-            position: absolute;
-            z-index: 99999;
-            transform: translateZ(999999px);
-            border: 2px solid rgba(255, 0, 0, 0.5);
-            background: rgba(100, 0, 0, 0.3);
-            font-size: 10px;
-            font-weight: 500;
-            line-height: 1.4;
-            color: #fff;
-            word-break: break-all;
-        }
-    </style>
 </head>
 
 <body>
@@ -70,7 +16,7 @@
     <form action="/func/summerCamp/add" class="weui-form" id="T_FORM">
         <div class="weui-form__text-area">
             <h2 class="weui-form__title">报名表</h2>
-            <div class="weui-form__desc">红船小义警特警少年夏令营</div>
+            <div class="weui-form__desc">南湖区反诈脱口秀现场观众评委招募</div>
         </div>
         <div class="weui-form__control-area">
             <div class="weui-cells__group weui-cells__group_form">
@@ -79,13 +25,13 @@
                     <label for="name" class="weui-cell weui-cell_active">
                         <div class="weui-cell__hd"><span class="weui-label">姓名</span></div>
                         <div class="weui-cell__bd">
-                            <input id="name" name="name" class="weui-input" placeholder="填写孩子姓名"/>
+                            <input id="name" name="name" class="weui-input" placeholder="填写姓名"/>
                         </div>
                     </label>
                     <label for="age" class="weui-cell weui-cell_active">
                         <div class="weui-cell__hd"><span class="weui-label">年龄</span></div>
                         <div class="weui-cell__bd">
-                            <input id="age" name="age" class="weui-input" placeholder="填写孩子年龄" type="number"/>
+                            <input id="age" name="age" class="weui-input" placeholder="填写年龄" type="number"/>
                         </div>
                     </label>
                     <label for="tel" class="weui-cell weui-cell_active">
@@ -93,7 +39,7 @@
                             <!-- <div class="weui-cell__desc">副标题</div> -->
                         </div>
                         <div class="weui-cell__bd">
-                            <input id="tel" name="tel" class="weui-input" placeholder="填写家长电话号码" type="number"
+                            <input id="tel" name="tel" class="weui-input" placeholder="填写联系电话" type="number"
                                    pattern="[0-9]*"/>
                         </div>
                     </label>
@@ -121,7 +67,7 @@
                         </div>
                     </div>
                     <div class="weui-cells__group">
-                        <div class="weui-cell">7天内有无出嘉兴大市</div>
+                        <div class="weui-cell">14天内有无前往中高风险地区</div>
                         <div class="weui-cells weui-cells_radio">
                             <label class="weui-cell weui-cell_active weui-check__label">
                                 <div class="weui-cell__bd">
@@ -144,12 +90,6 @@
                             </label>
                         </div>
                     </div>
-                    <label for="place" class="weui-cell weui-cell_active">
-                        <div class="weui-cell__hd"><span class="weui-label">前往地点</span></div>
-                        <div class="weui-cell__bd">
-                            <input id="place" name="place" class="weui-input" placeholder="填写前往地点"/>
-                        </div>
-                    </label>
                 </div>
             </div>
         </div>
@@ -181,7 +121,7 @@
         <div class="weui-mask"></div>
         <div class="weui-dialog">
             <div class="weui-dialog__hd"><strong class="weui-dialog__title" id="js_title1">提示</strong></div>
-            <div id="content" class="weui-dialog__bd">对不起，夏令营总数15人，报名人数已满！</div>
+            <div id="content" class="weui-dialog__bd">对不起，报名人数已满！</div>
             <div class="weui-dialog__ft">
                 <a role="button" class="weui-dialog__btn weui-dialog__btn_primary"
                    href="javascript: WeixinJSBridge.call('closeWindow')" >关闭</a>
@@ -201,11 +141,11 @@
     $(function () {
         $.ajax({
             type: 'get',
-            url: '/func/summerCamp/getCount',
+            url: '/func/talkShow/getCount',
             async: false,
             success: function (r) {
                 if (r.code === 200) {
-                    if(r.data === 15){
+                    if(r.data === 20){
                         var $iosDialog1 = $('#iosDialog1');
                         $iosDialog1.fadeIn(200);
                     }
@@ -222,9 +162,20 @@
                 $('#showTooltips').removeAttr('disabled');
             } else {
                 $('#showTooltips').addClass('weui-btn_disabled');
+                $('#showTooltips').attr('aria-disabled', 'true');
+            }
+        });
+
+        $("input[name=ifout]").click(function (e) {
+            var ifout = $(this).val();
+            if (ifout === '1') {
                 $('#showTooltips').addClass('weui-btn_disabled');
                 $('#showTooltips').attr('aria-disabled', 'true');
-                $('#showTooltips').addAttr('disabled');
+            }else{
+
+                $('#showTooltips').removeClass('weui-btn_disabled');
+                $('#showTooltips').attr('aria-disabled', 'false');
+                $('#showTooltips').removeAttr('disabled');
             }
         });
 
@@ -233,7 +184,7 @@
 
             var name = $('#name').val();
             if (name === undefined || name === '') {
-                $('#topTips').text("请输入孩子姓名！");
+                $('#topTips').text("请输入姓名！");
                 $('#topTips').fadeIn(200);
                 setTimeout(function() {
                     $('#topTips').fadeOut(100);
@@ -243,7 +194,7 @@
 
             var age = $('#age').val();
             if (age === undefined || age === '') {
-                $('#topTips').text("请输入孩子年龄！");
+                $('#topTips').text("请输入年龄！");
                 $('#topTips').fadeIn(200);
                 setTimeout(function() {
                     $('#topTips').fadeOut(100);
@@ -253,7 +204,7 @@
 
             var tel = $('#tel').val();
             if (tel === undefined || tel === '') {
-                $('#topTips').text("请输入家长联系电话！");
+                $('#topTips').text("请输入联系电话！");
                 $('#topTips').fadeIn(200)
                 setTimeout(function() {
                     $('#topTips').fadeOut(100);
@@ -266,7 +217,7 @@
             //提交 Ajax 成功后，关闭当前弹层并重载表格
             $.ajax({
                 type: 'post',
-                url: '/func/summerCamp/add',
+                url: '/func/talkShow/add',
                 data: {
                     name: name,
                     age: age,
Index: src/main/resources/templates/schedule/job.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n</head>\r\n<body style=\"background-color: #f2f2f2;\">\r\n\r\n<div id=\"kPage\" class=\"layui-fluid\" style=\"padding: 0\">\r\n    <div class=\"layui-row\">\r\n        <div class=\"layui-col-md12\" id=\"kMainContentCol\">\r\n            <div class=\"layui-fluid kvf-fluid-padding15\">\r\n                <div class=\"layui-card\">\r\n                    <form>\r\n                        <div class=\"layui-form layui-card-header kvf-card-header-auto\">\r\n                            <div class=\"layui-form-item\">\r\n                            <div class=\"layui-inline\">\r\n                                <label class=\"layui-form-label\">bean名称</label>\r\n                                <div class=\"layui-input-inline\">\r\n                                    <input type=\"text\" name=\"bean\" placeholder=\"请输入bean名称\" autocomplete=\"off\" class=\"layui-input\">\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"layui-inline\">\r\n                                <button class=\"layui-btn \" lay-submit=\"\" lay-filter=\"kTableSearchFilter\">\r\n                                    <i class=\"layui-icon layui-icon-search\"></i>\r\n                                </button>\r\n                                <button class=\"layui-btn \" type=\"reset\" data-event=\"refresh\">\r\n                                    <i class=\"layui-icon layui-icon-refresh-1\"></i>\r\n                                </button>\r\n                            </div>\r\n                            </div>\r\n                        </div>\r\n                    </form>\r\n\r\n                    <div class=\"layui-card-body\">\r\n                        <table id=\"kContentTable\" lay-filter=\"kContentTable\"></table>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n\r\n<!--头部工具栏模板-->\r\n<script type=\"text/html\" id=\"headToolbarTpl\">\r\n    <button class=\"layui-btn layui-btn-sm \" lay-event=\"add\">添加</button>\r\n    <button class=\"layui-btn layui-btn-sm layui-bg-blue\" lay-event=\"pause\">暂停</button>\r\n<!--    <button class=\"layui-btn layui-btn-sm layui-bg-orange\" lay-event=\"resume\">恢复</button>-->\r\n    <button class=\"layui-btn layui-btn-sm layui-bg-cyan\" lay-event=\"resume\">运行</button>\r\n</script>\r\n\r\n<!--表格行工具栏模板-->\r\n<script type=\"text/html\" id=\"rowToolbarTpl\">\r\n    <a class=\"layui-btn layui-btn-xs layui-btn-normal\" lay-event=\"edit\"><i class=\"layui-icon layui-icon-edit\"></i>编辑</a>\r\n    <a class=\"layui-btn layui-btn-xs layui-btn-danger\" lay-event=\"del\"><i class=\"layui-icon layui-icon-delete\"></i>删除</a>\r\n</script>\r\n\r\n<!--表格列格式化模板 start-->\r\n<script type=\"text/html\" id=\"statusTpl\">\r\n    {{#  if(d.status == 0){ }}\r\n    <span class=\"layui-badge layui-bg-green\">运行中</span>\r\n    {{# } else if(d.status == 1) { }}\r\n    <span class=\"layui-badge layui-bg-blue\">已暂停</span>\r\n    {{# } else if(d.status == 2) { }}\r\n    <span class=\"layui-badge layui-bg-gray\">已完成</span>\r\n    {{# } else if(d.status == 3) { }}\r\n    <span class=\"layui-badge layui-bg-red\">运行失败</span>\r\n    {{# } }}\r\n</script>\r\n<!--表格列格式化模板 end-->\r\n\r\n<script type=\"text/javascript\" th:inline=\"javascript\">\r\n    layui.use(['element', 'form', 'layer', 'table', 'laydate'], function () {\r\n        var elemet = layui.element, form = layui.form, layer = layui.layer, table = layui.table, laydate = layui.laydate;\r\n        var tableId = 'kContentTable';\r\n        var area = ['449px', '95%'];\r\n\r\n        // 实例化table\r\n        var tableIns = table.render($.extend(config.layui.table, {\r\n            elem: '#' + tableId\r\n            ,url: BASE_WEB + 'schedule/job/list/data' // 数据接口\r\n            ,toolbar: '#headToolbarTpl'\r\n            ,cols: [[ //表头\r\n                {type:'checkbox', fixed: 'left'}\r\n                ,{field: 'bean', title: '任务bean', width: 130}\r\n                // ,{field: 'method', title: '方法名', width: 130}\r\n                ,{field: 'cron', title: 'cron表达式', width: 180}\r\n                ,{field: 'params', title: '参数', width: 200}\r\n                ,{field: 'status', title: '状态', width: 130, templet: '#statusTpl'}\r\n                ,{field: 'remark', title: '备注'}\r\n                ,{field: 'createTime', title: '创建时间', width: 200}\r\n                ,{field: '', title: '操作', width: 150, fixed: 'right', templet: '#rowToolbarTpl'}\r\n            ]]\r\n        }));\r\n\r\n        // 监听表格头部事件\r\n        table.on('toolbar(' + tableId + ')', function(obj){\r\n            var checkStatus = table.checkStatus(obj.config.id);\r\n            var checkData = checkStatus.data; // 得到选中的数据\r\n            log('checkData=', checkData)\r\n            switch(obj.event) {\r\n                case 'add':\r\n                    layer.open({\r\n                        type: 2\r\n                        ,title: '添加'\r\n                        ,content: BASE_WEB + 'schedule/job/edit'\r\n                        ,maxmin: true\r\n                        ,area: area   // 宽高\r\n                        ,btn: ['确定', '取消']\r\n                        ,yes: function(index, layero){\r\n                            //点击确认触发 iframe 内容中的按钮提交\r\n                            var submit = layero.find('iframe').contents().find(\"#kFormSubmit\");\r\n                            submit.click();\r\n                        }\r\n                    });\r\n                    break;\r\n                case 'pause':\r\n                    if(checkData.length === 0){\r\n                        return kvfKit.warningMsg('请选择数据');\r\n                    }\r\n                    layer.confirm('确定暂时任务吗？', function(index) {\r\n                        //执行 Ajax 后重载\r\n                        $.ajax({\r\n                            type: req.type.post,\r\n                            url: BASE_WEB + 'schedule/job/pause/' + checkData[0].id,\r\n                            success: function (r) {\r\n                                if (r.code === req.status.ok) {\r\n                                    table.reload(tableId);\r\n                                    kvfKit.sucessMsg('已暂停定时任务');\r\n                                } else {\r\n                                    kvfKit.errorMsg(r.msg);\r\n                                }\r\n                            }\r\n                        });\r\n                    });\r\n                    break;\r\n                case 'resume':\r\n                    if(checkData.length === 0){\r\n                        return kvfKit.warningMsg('请选择数据');\r\n                    }\r\n                    layer.confirm('确定恢复/运行任务吗？', function(index) {\r\n                        //执行 Ajax 后重载\r\n                        $.ajax({\r\n                            type: req.type.post,\r\n                            url: BASE_WEB + 'schedule/job/resume/' + checkData[0].id,\r\n                            success: function (r) {\r\n                                if (r.code === req.status.ok) {\r\n                                    table.reload(tableId);\r\n                                    kvfKit.sucessMsg('已恢复/运行任务');\r\n                                } else {\r\n                                    kvfKit.errorMsg(r.msg);\r\n                                }\r\n                            }\r\n                        });\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n\r\n        // 表格行按钮 监听事件\r\n        table.on('tool(' + tableId + ')', function (obj) {\r\n            var data = obj.data; //获得当前行数据\r\n            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）\r\n            var tr = obj.tr; //获得当前行 tr 的DOM对象\r\n\r\n            if (layEvent === 'edit') {\r\n                layer.open({\r\n                    type: 2\r\n                    ,title: '编辑'\r\n                    ,content: BASE_WEB + 'schedule/job/edit?id=' + data.id\r\n                    ,maxmin: true\r\n                    ,area: area   // 宽高\r\n                    ,btn: ['确定', '取消']\r\n                    ,yes: function(index, layero){\r\n                        //点击确认触发 iframe 内容中的按钮提交\r\n                        var submit = layero.find('iframe').contents().find(\"#kFormSubmit\");\r\n                        submit.click();\r\n                    }\r\n                });\r\n            }\r\n            if (layEvent === 'del') {\r\n                layer.confirm('确定删除吗？', function(index) {\r\n                    //执行 Ajax 后重载\r\n                    $.ajax({\r\n                        type: req.type.post,\r\n                        url: BASE_WEB + 'schedule/job/delete/' + data.id,\r\n                        async: false,\r\n                        success: function (r) {\r\n                            if (r.code === req.status.ok) {\r\n                                table.reload(tableId);\r\n                                kvfKit.sucessMsg('已删除');\r\n                            } else {\r\n                                kvfKit.errorMsg(r.msg);\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        });\r\n\r\n        // 监听查询\r\n        form.on('submit(kTableSearchFilter)', function (obj) {\r\n            renderTableData(obj.field);\r\n            return false;\r\n        });\r\n\r\n        var active = {\r\n            refresh: function () {\r\n                var $form = $('form');\r\n                $form[0].reset();\r\n                renderTableData(kvfKit.getFormJson($form));\r\n            }\r\n        };\r\n\r\n        kvfKit.activeInit(active);\r\n\r\n        function renderTableData(params) {\r\n            params = params ? params : {};\r\n            log('seach=', params); //\r\n\r\n            tableIns.reload({\r\n                where: params,\r\n                page: {curr: 1}\r\n            });\r\n        }\r\n\r\n        // 绑定监听回车事件\r\n        kvfKit.bindEnterEventForLayuiForm();\r\n\r\n    });\r\n</script>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/schedule/job.html b/src/main/resources/templates/schedule/job.html
--- a/src/main/resources/templates/schedule/job.html	
+++ b/src/main/resources/templates/schedule/job.html	
@@ -80,7 +80,7 @@
     layui.use(['element', 'form', 'layer', 'table', 'laydate'], function () {
         var elemet = layui.element, form = layui.form, layer = layui.layer, table = layui.table, laydate = layui.laydate;
         var tableId = 'kContentTable';
-        var area = ['449px', '95%'];
+        var area = ['500px', '80%'];
 
         // 实例化table
         var tableIns = table.render($.extend(config.layui.table, {
@@ -89,14 +89,14 @@
             ,toolbar: '#headToolbarTpl'
             ,cols: [[ //表头
                 {type:'checkbox', fixed: 'left'}
-                ,{field: 'bean', title: '任务bean', width: 130}
+                ,{field: 'bean', title: '任务bean', width: 130, align: 'center'}
                 // ,{field: 'method', title: '方法名', width: 130}
-                ,{field: 'cron', title: 'cron表达式', width: 180}
-                ,{field: 'params', title: '参数', width: 200}
-                ,{field: 'status', title: '状态', width: 130, templet: '#statusTpl'}
-                ,{field: 'remark', title: '备注'}
-                ,{field: 'createTime', title: '创建时间', width: 200}
-                ,{field: '', title: '操作', width: 150, fixed: 'right', templet: '#rowToolbarTpl'}
+                ,{field: 'cron', title: 'cron表达式', width: 180, align: 'center'}
+                ,{field: 'status', title: '状态', width: 130, templet: '#statusTpl', align: 'center'}
+                ,{field: 'params', title: '发送内容', width: 350, align: 'center'}
+                ,{field: 'remark', title: '备注', align: 'center'}
+                ,{field: 'createTime', title: '创建时间', width: 200, align: 'center'}
+                ,{field: '', title: '操作', width: 150, fixed: 'right', templet: '#rowToolbarTpl', align: 'center'}
             ]]
         }));
 
Index: src/main/resources/templates/schedule/job_edit.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n</head>\r\n<body>\r\n<div class=\"layui-form\" style=\"padding: 20px 30px 0 0;\">\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">bean名称</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"bean\" th:value=\"${editInfo.bean}\" lay-verify=\"required\" placeholder=\"请输入bean名称\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <!--<div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">方法名</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"method\" th:value=\"${editInfo.method}\" lay-verify=\"required\" placeholder=\"请输入方法名\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>-->\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">cron表达式</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"cron\" th:value=\"${editInfo.cron}\" lay-verify=\"required\" placeholder=\"请输入crom表达式\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">参数</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"params\" th:value=\"${editInfo.params}\" placeholder=\"请输入参数\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">备注</label>\r\n        <div class=\"layui-input-inline\">\r\n            <textarea type=\"text\" name=\"remark\" th:text=\"${editInfo.remark}\" placeholder=\"请输入备注\" autocomplete=\"off\" class=\"layui-textarea\"></textarea>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"layui-form-item layui-hide\">\r\n        <input type=\"button\" lay-submit=\"\" lay-filter=\"kFormSubmit\" id=\"kFormSubmit\" value=\"确认添加\">\r\n        <input type=\"text\" name=\"id\" th:value=\"${editInfo.id}\" placeholder=\"保存ID\" autocomplete=\"off\" class=\"layui-input\">\r\n    </div>\r\n</div>\r\n\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n<script>\r\n    layui.use(['form', 'laydate'], function () {\r\n        var $ = layui.$, form = layui.form, laydate = layui.laydate;\r\n\r\n        //监听提交\r\n        form.on('submit(kFormSubmit)', function(data){\r\n            var field = data.field; //获取提交的字段\r\n            var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引\r\n\r\n            var url = field.id ? 'schedule/job/update' : 'schedule/job/add';\r\n            //提交 Ajax 成功后，关闭当前弹层并重载表格\r\n            $.ajax({\r\n                type: req.type.post,\r\n                url: BASE_WEB + url,\r\n                data: field,\r\n                async: false,\r\n                success: function (r) {\r\n                    if (r.code === req.status.ok) {\r\n                        // 重载表格\r\n                        parent.layui.table.reload('kContentTable');\r\n                        parent.layer.close(index); //再执行关闭\r\n                    } else {\r\n                        kvfKit.errorMsg(r.msg);\r\n                    }\r\n                }\r\n            });\r\n\r\n        });\r\n    })\r\n</script>\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/schedule/job_edit.html b/src/main/resources/templates/schedule/job_edit.html
--- a/src/main/resources/templates/schedule/job_edit.html	
+++ b/src/main/resources/templates/schedule/job_edit.html	
@@ -4,13 +4,20 @@
     <meta charset="UTF-8">
     <title th:replace="common/base::pagetitle"></title>
     <link th:replace="common/base::static"/>
+    <style>
+        .layui-input, .layui-textarea {
+            display: block;
+            width: 350px;
+            padding-left: 10px;
+        }
+    </style>
 </head>
 <body>
 <div class="layui-form" style="padding: 20px 30px 0 0;">
     <div class="layui-form-item">
         <label class="layui-form-label">bean名称</label>
         <div class="layui-input-inline">
-            <input type="text" name="bean" th:value="${editInfo.bean}" lay-verify="required" placeholder="请输入bean名称" autocomplete="off" class="layui-input">
+            <input type="text" name="bean" th:value="helloJob" readonly lay-verify="required" placeholder="请输入bean名称" autocomplete="off" class="layui-input">
         </div>
     </div>
     <!--<div class="layui-form-item">
@@ -21,14 +28,22 @@
     </div>-->
     <div class="layui-form-item">
         <label class="layui-form-label">cron表达式</label>
-        <div class="layui-input-inline">
-            <input type="text" name="cron" th:value="${editInfo.cron}" lay-verify="required" placeholder="请输入crom表达式" autocomplete="off" class="layui-input">
+        <div class="layui-input-inline"  style="display:flex;width: 74%">
+            <input type="text" name="cron" th:value="${editInfo.cron}" lay-verify="required" placeholder="例：0/10 * * * * ?（具体请参考文档）" autocomplete="off" class="layui-input">
+            <button class="layui-btn" onclick="javascript:window.open('https://cron.qqe2.com/');" >参考</button>
+        </div>
+    </div>
+    <div class="layui-form-item">
+        <label class="layui-form-label">机器人地址</label>
+        <div class="layui-input-inline"  style="display:flex;width: 74%">
+            <textarea type="text" name="webhook" th:text="${editInfo.webhook}" placeholder="请输入机器人地址(webhook)" autocomplete="off" class="layui-textarea"></textarea>
+            <button class="layui-btn" onclick="javascript:window.open('https://www.alibabacloud.com/help/zh/enterprise-distributed-application-service/latest/get-the-webhook-address-of-the-dingtalk-robot ');" >参考</button>
         </div>
     </div>
     <div class="layui-form-item">
-        <label class="layui-form-label">参数</label>
+        <label class="layui-form-label">发送内容</label>
         <div class="layui-input-inline">
-            <input type="text" name="params" th:value="${editInfo.params}" placeholder="请输入参数" autocomplete="off" class="layui-input">
+            <textarea type="text" name="params" th:text="${editInfo.params}" placeholder="请输入发送内容" autocomplete="off" class="layui-textarea"></textarea>
         </div>
     </div>
     <div class="layui-form-item">
Index: src/main/resources/templates/func/infoTest.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n</head>\r\n<body style=\"background-color: #f2f2f2;\">\r\n\r\n<div id=\"kPage\" class=\"layui-fluid\" style=\"padding: 0\">\r\n    <div class=\"layui-row\">\r\n        <div class=\"layui-col-md12\" id=\"kMainContentCol\">\r\n            <div class=\"layui-fluid kvf-fluid-padding15\">\r\n                <div class=\"layui-card\">\r\n                    <form>\r\n                        <div class=\"layui-form layui-card-header kvf-card-header-auto\">\r\n                            <div class=\"layui-form-item\">\r\n                                <div class=\"layui-inline\">\r\n                                    <label class=\"layui-form-label\">标题</label>\r\n                                    <div class=\"layui-input-inline\">\r\n                                        <input type=\"text\" name=\"title\" placeholder=\"请输入标题\" autocomplete=\"off\" class=\"layui-input\">\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class=\"layui-inline\">\r\n                                    <button class=\"layui-btn \" lay-submit=\"\" lay-filter=\"kTableSearchFilter\">\r\n                                        <i class=\"layui-icon layui-icon-search\"></i>\r\n                                    </button>\r\n                                    <button class=\"layui-btn \" type=\"reset\" data-event=\"refresh\">\r\n                                        <i class=\"layui-icon layui-icon-refresh-1\"></i>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </form>\r\n\r\n                    <div class=\"layui-card-body\">\r\n                        <table id=\"kContentTable\" lay-filter=\"kContentTable\"></table>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n\r\n<!--头部工具栏模板-->\r\n<script type=\"text/html\" id=\"headToolbarTpl\">\r\n    <button class=\"layui-btn layui-btn-sm \" lay-event=\"add\">添加</button>\r\n    <button class=\"layui-btn layui-btn-sm layui-btn-danger\" lay-event=\"batchdel\">批量删除</button>\r\n</script>\r\n\r\n<!--表格行工具栏模板-->\r\n<script type=\"text/html\" id=\"rowToolbarTpl\">\r\n    <a class=\"layui-btn layui-btn-xs layui-btn-normal\" lay-event=\"edit\"><i class=\"layui-icon layui-icon-edit\"></i>编辑</a>\r\n    <a class=\"layui-btn layui-btn-xs layui-btn-danger\" lay-event=\"del\"><i class=\"layui-icon layui-icon-delete\"></i>删除</a>\r\n</script>\r\n\r\n<!--表格列格式化模板 start-->\r\n<!--表格列格式化模板 end-->\r\n\r\n<script type=\"text/javascript\" th:inline=\"javascript\">\r\n    layui.use(['element', 'form', 'layer', 'table', 'laydate'], function () {\r\n        var elemet = layui.element, form = layui.form, layer = layui.layer, table = layui.table, laydate = layui.laydate;\r\n        var tableId = 'kContentTable';\r\n        var area = ['449px', '95%'];\r\n\r\n        // 实例化table\r\n        var tableIns = table.render($.extend(config.layui.table, {\r\n            elem: '#' + tableId\r\n            ,url: BASE_WEB + 'func/infoTest/list/data' // 数据接口\r\n            ,toolbar: '#headToolbarTpl'\r\n            ,cols: [[ //表头\r\n                {type:'checkbox', fixed: 'left'}\r\n                ,{field: 'title', title: '标题', width: 130}\r\n                ,{field: 'ids', title: '题目列表'}\r\n                ,{field: 'createTime', title: '创建时间', width: 130}\r\n                ,{field: 'startTime', title: '开始时间', width: 130}\r\n                ,{field: 'endTime', title: '结束时间', width: 130}\r\n                ,{field: '', title: '操作', width: 235, fixed: 'right', templet: '#rowToolbarTpl'}\r\n            ]]\r\n        }));\r\n\r\n        // 监听表格头部事件\r\n        table.on('toolbar(' + tableId + ')', function(obj){\r\n            var checkStatus = table.checkStatus(obj.config.id);\r\n            var checkData = checkStatus.data; // 得到选中的数据\r\n            switch(obj.event) {\r\n                case 'add':\r\n                    layer.open({\r\n                        type: 2\r\n                        ,title: '添加'\r\n                        ,content: BASE_WEB + 'func/infoTest/edit'\r\n                        ,maxmin: true\r\n                        ,area: area   // 宽高\r\n                        ,btn: ['确定', '取消']\r\n                        ,yes: function(index, layero){\r\n                            //点击确认触发 iframe 内容中的按钮提交\r\n                            var submit = layero.find('iframe').contents().find(\"#kFormSubmit\");\r\n                            submit.click();\r\n                        }\r\n                    });\r\n                    break;\r\n                case 'batchdel':\r\n                    if(checkData.length === 0){\r\n                        return kvfKit.warningMsg('请选择数据');\r\n                    }\r\n                    layer.confirm('确定删除吗？', function(index) {\r\n                        var ids = [];\r\n                        $.each(checkData, function(i, n){\r\n                            ids[i] = n.id;\r\n                        });\r\n\r\n                        //执行 Ajax 后重载\r\n                        $.ajax({\r\n                            type: req.type.post,\r\n                            url: BASE_WEB + 'func/infoTest/batchdel',\r\n                            data: {ids: ids.toString()},\r\n                            success: function (r) {\r\n                                if (r.code === req.status.ok) {\r\n                                    table.reload(tableId);\r\n                                    kvfKit.sucessMsg('已删除');\r\n                                } else {\r\n                                    kvfKit.errorMsg(r.msg);\r\n                                }\r\n                            }\r\n                        });\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n\r\n        // 表格行按钮 监听事件\r\n        table.on('tool(' + tableId + ')', function (obj) {\r\n            var data = obj.data; //获得当前行数据\r\n            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）\r\n            var tr = obj.tr; //获得当前行 tr 的DOM对象\r\n\r\n            if (layEvent === 'edit') {\r\n                layer.open({\r\n                    type: 2\r\n                    ,title: '编辑'\r\n                    ,content: BASE_WEB + 'func/infoTest/edit?id=' + data.id\r\n                    ,maxmin: true\r\n                    ,area: area   // 宽高\r\n                    ,btn: ['确定', '取消']\r\n                    ,yes: function(index, layero){\r\n                        //点击确认触发 iframe 内容中的按钮提交\r\n                        var submit = layero.find('iframe').contents().find(\"#kFormSubmit\");\r\n                        submit.click();\r\n                    }\r\n                });\r\n            }\r\n            if (layEvent === 'del') {\r\n                layer.confirm('确定删除吗？', function(index) {\r\n                    //执行 Ajax 后重载\r\n                    $.ajax({\r\n                        type: req.type.post,\r\n                        url: BASE_WEB + 'func/infoTest/del/' + data.id,\r\n                        async: false,\r\n                        success: function (r) {\r\n                            if (r.code === req.status.ok) {\r\n                                table.reload(tableId);\r\n                                kvfKit.sucessMsg('已删除');\r\n                            } else {\r\n                                kvfKit.errorMsg(r.msg);\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        });\r\n\r\n\r\n        // 监听查询\r\n        form.on('submit(kTableSearchFilter)', function (obj) {\r\n            renderTableData(obj.field);\r\n            return false;\r\n        });\r\n\r\n        var active = {\r\n            refresh: function () {\r\n                var $form = $('form');\r\n                $form[0].reset();\r\n                renderTableData(kvfKit.getFormJson($form));\r\n            }\r\n        };\r\n\r\n        kvfKit.activeInit(active);\r\n\r\n        function renderTableData(params) {\r\n            params = params ? params : {};\r\n\r\n            tableIns.reload({\r\n                where: params,\r\n                page: {curr: 1}\r\n            });\r\n        }\r\n\r\n        // 绑定监听回车事件\r\n        kvfKit.bindEnterEventForLayuiForm();\r\n\r\n    });\r\n</script>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/func/infoTest.html b/src/main/resources/templates/func/infoTest.html
--- a/src/main/resources/templates/func/infoTest.html	
+++ b/src/main/resources/templates/func/infoTest.html	
@@ -76,12 +76,12 @@
             ,toolbar: '#headToolbarTpl'
             ,cols: [[ //表头
                 {type:'checkbox', fixed: 'left'}
-                ,{field: 'title', title: '标题', width: 130}
-                ,{field: 'ids', title: '题目列表'}
-                ,{field: 'createTime', title: '创建时间', width: 130}
-                ,{field: 'startTime', title: '开始时间', width: 130}
-                ,{field: 'endTime', title: '结束时间', width: 130}
-                ,{field: '', title: '操作', width: 235, fixed: 'right', templet: '#rowToolbarTpl'}
+                ,{field: 'title', title: '标题', width: 200, align: 'center'}
+                ,{field: 'ids', title: '题目列表',width: 300,  align: 'center'}
+                ,{field: 'startTime', title: '开始时间', width: 180, align: 'center'}
+                ,{field: 'endTime', title: '结束时间', width: 180, align: 'center'}
+                ,{field: 'createTime', title: '创建时间', width: 180, align: 'center'}
+                ,{field: '', title: '操作', width: 235, fixed: 'right', templet: '#rowToolbarTpl',  align: 'center'}
             ]]
         }));
 
Index: src/main/resources/static/summercamp/index.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n\t<head>\r\n\t\t<meta charset=\"UTF-8\">\r\n\t\t<meta name=\"viewport\" content=\"width=device-width,initial-scale=1,user-scalable=0,viewport-fit=cover\">\r\n\t\t<meta name=\"wechat-enable-text-zoom-em\" content=\"true\">\r\n\t\t<title>红船小义警特警少年夏令营</title>\r\n\t\t<link rel=\"stylesheet\" href=\"css/weui.css\">\r\n\t\t<script src=\"js/jquery.min.js\"></script>\r\n\t\t<style>\r\n\t\t\t/* 控制器 */\r\n\t\t\t.wah-controls {\r\n\t\t\t\tposition: fixed;\r\n\t\t\t\tz-index: 100000;\r\n\t\t\t\tbottom: 50px;\r\n\t\t\t\tright: constant(safe-area-inset-right);\r\n\t\t\t\tright: env(safe-area-inset-right);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tbackground: rgba(0, 0, 0, 0.5);\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tfont-size: 14px;\r\n\t\t\t\tborder-top-left-radius: 4px;\r\n\t\t\t\tborder-bottom-left-radius: 4px;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t}\r\n\r\n\t\t\t.wah-control {\r\n\t\t\t\tpadding: 4px;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\r\n\t\t\t/* 热区蓝字 */\r\n\t\t\t.wah-hotarea-size {\r\n\t\t\t\tz-index: 99999;\r\n\t\t\t\tfont-size: 10px;\r\n\t\t\t\tbackground: rgba(0, 0, 255, 0.5);\r\n\t\t\t\tcolor: #FFF;\r\n\t\t\t}\r\n\r\n\t\t\t/* 读屏红框 */\r\n\t\t\t.wah-reading-panel {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 0;\r\n\t\t\t\tright: 0;\r\n\t\t\t\tbottom: 0;\r\n\t\t\t\tleft: 0;\r\n\t\t\t\tpointer-events: none;\r\n\t\t\t}\r\n\r\n\t\t\t.wah-reading-outline {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tz-index: 99999;\r\n\t\t\t\ttransform: translateZ(999999px);\r\n\t\t\t\tborder: 2px solid rgba(255, 0, 0, 0.5);\r\n\t\t\t\tbackground: rgba(100, 0, 0, 0.3);\r\n\t\t\t\tfont-size: 10px;\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t\tline-height: 1.4;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tword-break: break-all;\r\n\t\t\t}\r\n\t\t</style>\r\n\t</head>\r\n\r\n\t<body>\r\n\t\t<div class=\"page\">\r\n\t\t\t<div class=\"weui-form\">\r\n\t\t\t\t<div class=\"weui-form__text-area\">\r\n\t\t\t\t\t<h2 class=\"weui-form__title\">报名表</h2>\r\n\t\t\t\t\t<div class=\"weui-form__desc\">红船小义警特警少年夏令营</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<form action=\"/func/summerCamp/add\" id=\"T_FORM\" class=\"weui-form__control-area\" >\r\n\t\t\t\t\t<div class=\"weui-cells__group weui-cells__group_form\">\r\n\t\t\t\t\t\t<!-- <div class=\"weui-cells__title\">表单组标题</div> -->\r\n\t\t\t\t\t\t<div class=\"weui-cells\">\r\n\t\t\t\t\t\t\t<label for=\"js_input1\" class=\"weui-cell weui-cell_active\">\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cell__hd\"><span class=\"weui-label\">姓名</span></div>\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cell__bd\">\r\n\t\t\t\t\t\t\t\t\t<input id=\"js_input1\" class=\"weui-input\" placeholder=\"填写孩子姓名\" />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<label for=\"js_input2\" class=\"weui-cell weui-cell_active\">\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cell__hd\"><span class=\"weui-label\">年龄</span></div>\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cell__bd\">\r\n\t\t\t\t\t\t\t\t\t<input id=\"js_input2\" class=\"weui-input\" placeholder=\"填写孩子年龄\" type=\"number\"/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<div class=\"weui-cells__group\">\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cell\">性别</div>\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cells weui-cells_radio\">\r\n\t\t\t\t\t\t\t\t\t<label class=\"weui-cell weui-cell_active weui-check__label\" for=\"x11\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"weui-cell__bd\">\r\n\t\t\t\t\t\t\t\t\t\t\t<p>男</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"weui-cell__ft\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"weui-check\" name=\"radio1\" id=\"x11\" checked=\"checked\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"weui-icon-checked\"></span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<label class=\"weui-cell weui-cell_active weui-check__label\" for=\"x12\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"weui-cell__bd\">\r\n\t\t\t\t\t\t\t\t\t\t\t<p>女</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"weui-cell__ft\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" name=\"radio1\" class=\"weui-check\" id=\"x12\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"weui-icon-checked\"></span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<label for=\"js_input4\" class=\"weui-cell weui-cell_active\">\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cell__hd\"><span class=\"weui-label\">联系电话</span>\r\n\t\t\t\t\t\t\t\t\t<!-- <div class=\"weui-cell__desc\">副标题</div> -->\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cell__bd\">\r\n\t\t\t\t\t\t\t\t\t<input id=\"js_input4\" class=\"weui-input\" placeholder=\"填写家长电话号码\" type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\tpattern=\"[0-9]*\" />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<div class=\"weui-cells__group\">\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cell\">7天内有无出嘉兴大市</div>\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cells weui-cells_radio\">\r\n\t\t\t\t\t\t\t\t\t<label class=\"weui-cell weui-cell_active weui-check__label\" for=\"x13\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"weui-cell__bd\">\r\n\t\t\t\t\t\t\t\t\t\t\t<p>无</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"weui-cell__ft\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"weui-check\" name=\"radio2\" id=\"x13\" checked=\"checked\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"weui-icon-checked\"></span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<label class=\"weui-cell weui-cell_active weui-check__label\" for=\"x14\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"weui-cell__bd\">\r\n\t\t\t\t\t\t\t\t\t\t\t<p>有</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"weui-cell__ft\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" name=\"radio2\" class=\"weui-check\" id=\"x14\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"weui-icon-checked\"></span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<label for=\"js_input5\" class=\"weui-cell weui-cell_active\">\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cell__hd\"><span class=\"weui-label\">前往地点</span></div>\r\n\t\t\t\t\t\t\t\t<div class=\"weui-cell__bd\">\r\n\t\t\t\t\t\t\t\t\t<input id=\"js_input5\" class=\"weui-input\" placeholder=\"填写前往地点\" />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t\t<!-- <div class=\"weui-form__tips-area\">\r\n\t\t\t\t\t<p class=\"weui-form__tips\">\r\n\t\t\t\t\t\t表单页提示，居中对齐\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div> -->\r\n\t\t\t\t<div class=\"weui-form__opr-area\">\r\n\t\t\t\t\t<a role=\"button\" disabled aria-disabled=\"true\" class=\"weui-btn weui-btn_primary weui-btn_disabled\"\r\n\t\t\t\t\t\thref=\"javascript:\" id=\"showTooltips\">确定</a>\r\n\t\t\t\t</div>\r\n\t\t\t\t<!-- <div class=\"weui-form__tips-area\">\r\n\t\t\t\t\t<p class=\"weui-form__tips\">\r\n\t\t\t\t\t\t表单页提示，居中对齐\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div> -->\r\n\t\t\t\t<div class=\"weui-form__extra-area\">\r\n\t\t\t\t\t<div class=\"weui-footer\">\r\n\t\t\t\t\t\t<p class=\"weui-footer__links\">\r\n\t\t\t\t\t\t\t<a href=\"javascript:\" class=\"weui-footer__link\">南湖区公安局分局</a>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t<p class=\"weui-footer__text\">Copyright © 2020-2025 alpha.wu</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div role=\"alert\" id=\"js_toast\" style=\"display: none;\">\r\n\t\t\t\t<div class=\"weui-mask_transparent\"></div>\r\n\t\t\t\t<div class=\"weui-toast\">\r\n\t\t\t\t\t<i class=\"weui-icon-success-no-circle weui-icon_toast\"></i>\r\n\t\t\t\t\t<p class=\"weui-toast__content\">已完成</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<script type=\"text/javascript\">\r\n\t\t\t$(function() {\r\n\t\t\t\tvar $toast = $('#js_toast');\r\n\t\t\t\tvar $input = $('#js_input1');\r\n\t\t\t\t$input.on('input', function() {\r\n\t\t\t\t\tif ($input.val()) {\r\n\t\t\t\t\t\t$('#showTooltips').removeClass('weui-btn_disabled');\r\n\t\t\t\t\t\t$('#showTooltips').attr('aria-disabled', 'false');\r\n\t\t\t\t\t\t$('#showTooltips').removeAttr('disabled');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$('#showTooltips').addClass('weui-btn_disabled');\r\n\t\t\t\t\t\t$('#showTooltips').addClass('weui-btn_disabled');\r\n\t\t\t\t\t\t$('#showTooltips').attr('aria-disabled', 'true');\r\n\t\t\t\t\t\t$('#showTooltips').addAttr('disabled');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t$('#showTooltips').on('click', function() {\r\n\t\t\t\t\tif ($(this).hasClass('weui-btn_disabled')) return;\r\n\r\n\t\t\t\t\tvar $form = $('#T_FORM');\r\n\t\t\t\t\t$form.submit(function(){\r\n\t\t\t\r\n\t\r\n\t\t\t\t\tconsole.log('11111111')\r\n})\r\n\t\t\t\t\t// toptips的fixed, 如果有`animation`, `position: fixed`不生效\r\n\t\t\t\t\t// $('.page.cell').removeClass('slideIn');\r\n\r\n\t\t\t\t\t// $toast.attr('aria-live', 'assertive');\r\n\t\t\t\t\t// $toast.fadeIn(100);\r\n\t\t\t\t\t// setTimeout(function() {\r\n\t\t\t\t\t// \t$toast.attr('aria-live', 'off');\r\n\t\t\t\t\t// \t$toast.fadeOut(100);\r\n\t\t\t\t\t// }, 2000);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$('.weui-cell').on('click', function(){\r\n\t\t\t\t $(this).find('input').trigger('focus');\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t</script>\r\n\t</body>\r\n</html>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/static/summercamp/index.html b/src/main/resources/static/summercamp/index.html
--- a/src/main/resources/static/summercamp/index.html	
+++ b/src/main/resources/static/summercamp/index.html	
@@ -1,227 +1,298 @@
 <!DOCTYPE html>
 <html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
-	<head>
-		<meta charset="UTF-8">
-		<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,viewport-fit=cover">
-		<meta name="wechat-enable-text-zoom-em" content="true">
-		<title>红船小义警特警少年夏令营</title>
-		<link rel="stylesheet" href="css/weui.css">
-		<script src="js/jquery.min.js"></script>
-		<style>
-			/* 控制器 */
-			.wah-controls {
-				position: fixed;
-				z-index: 100000;
-				bottom: 50px;
-				right: constant(safe-area-inset-right);
-				right: env(safe-area-inset-right);
-				display: flex;
-				align-items: center;
-				background: rgba(0, 0, 0, 0.5);
-				color: #fff;
-				font-size: 14px;
-				border-top-left-radius: 4px;
-				border-bottom-left-radius: 4px;
-				overflow: hidden;
-			}
+<head>
+    <meta charset="UTF-8">
+    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,viewport-fit=cover">
+    <meta name="wechat-enable-text-zoom-em" content="true">
+    <title>红船小义警特警少年夏令营</title>
+    <link rel="stylesheet" href="css/weui.css">
+    <script src="js/jquery.min.js"></script>
+    <style>
+        /* 控制器 */
+        .wah-controls {
+            position: fixed;
+            z-index: 100000;
+            bottom: 50px;
+            right: constant(safe-area-inset-right);
+            right: env(safe-area-inset-right);
+            display: flex;
+            align-items: center;
+            background: rgba(0, 0, 0, 0.5);
+            color: #fff;
+            font-size: 14px;
+            border-top-left-radius: 4px;
+            border-bottom-left-radius: 4px;
+            overflow: hidden;
+        }
 
-			.wah-control {
-				padding: 4px;
-				display: flex;
-				align-items: center;
-			}
+        .wah-control {
+            padding: 4px;
+            display: flex;
+            align-items: center;
+        }
 
-			/* 热区蓝字 */
-			.wah-hotarea-size {
-				z-index: 99999;
-				font-size: 10px;
-				background: rgba(0, 0, 255, 0.5);
-				color: #FFF;
-			}
+        /* 热区蓝字 */
+        .wah-hotarea-size {
+            z-index: 99999;
+            font-size: 10px;
+            background: rgba(0, 0, 255, 0.5);
+            color: #FFF;
+        }
 
-			/* 读屏红框 */
-			.wah-reading-panel {
-				position: absolute;
-				top: 0;
-				right: 0;
-				bottom: 0;
-				left: 0;
-				pointer-events: none;
-			}
+        /* 读屏红框 */
+        .wah-reading-panel {
+            position: absolute;
+            top: 0;
+            right: 0;
+            bottom: 0;
+            left: 0;
+            pointer-events: none;
+        }
 
-			.wah-reading-outline {
-				position: absolute;
-				z-index: 99999;
-				transform: translateZ(999999px);
-				border: 2px solid rgba(255, 0, 0, 0.5);
-				background: rgba(100, 0, 0, 0.3);
-				font-size: 10px;
-				font-weight: 500;
-				line-height: 1.4;
-				color: #fff;
-				word-break: break-all;
-			}
-		</style>
-	</head>
+        .wah-reading-outline {
+            position: absolute;
+            z-index: 99999;
+            transform: translateZ(999999px);
+            border: 2px solid rgba(255, 0, 0, 0.5);
+            background: rgba(100, 0, 0, 0.3);
+            font-size: 10px;
+            font-weight: 500;
+            line-height: 1.4;
+            color: #fff;
+            word-break: break-all;
+        }
+    </style>
+</head>
 
-	<body>
-		<div class="page">
-			<div class="weui-form">
-				<div class="weui-form__text-area">
-					<h2 class="weui-form__title">报名表</h2>
-					<div class="weui-form__desc">红船小义警特警少年夏令营</div>
-				</div>
-				<form action="/func/summerCamp/add" id="T_FORM" class="weui-form__control-area" >
-					<div class="weui-cells__group weui-cells__group_form">
-						<!-- <div class="weui-cells__title">表单组标题</div> -->
-						<div class="weui-cells">
-							<label for="js_input1" class="weui-cell weui-cell_active">
-								<div class="weui-cell__hd"><span class="weui-label">姓名</span></div>
-								<div class="weui-cell__bd">
-									<input id="js_input1" class="weui-input" placeholder="填写孩子姓名" />
-								</div>
-							</label>
-							<label for="js_input2" class="weui-cell weui-cell_active">
-								<div class="weui-cell__hd"><span class="weui-label">年龄</span></div>
-								<div class="weui-cell__bd">
-									<input id="js_input2" class="weui-input" placeholder="填写孩子年龄" type="number"/>
-								</div>
-							</label>
-							<div class="weui-cells__group">
-								<div class="weui-cell">性别</div>
-								<div class="weui-cells weui-cells_radio">
-									<label class="weui-cell weui-cell_active weui-check__label" for="x11">
-										<div class="weui-cell__bd">
-											<p>男</p>
-										</div>
-										<div class="weui-cell__ft">
-											<input type="radio" class="weui-check" name="radio1" id="x11" checked="checked" />
-											<span class="weui-icon-checked"></span>
-										</div>
-									</label>
-									<label class="weui-cell weui-cell_active weui-check__label" for="x12">
-										<div class="weui-cell__bd">
-											<p>女</p>
-										</div>
-										<div class="weui-cell__ft">
-											<input type="radio" name="radio1" class="weui-check" id="x12"/>
-											<span class="weui-icon-checked"></span>
-										</div>
-									</label>
-								</div>
-							</div>
-							<label for="js_input4" class="weui-cell weui-cell_active">
-								<div class="weui-cell__hd"><span class="weui-label">联系电话</span>
-									<!-- <div class="weui-cell__desc">副标题</div> -->
-								</div>
-								<div class="weui-cell__bd">
-									<input id="js_input4" class="weui-input" placeholder="填写家长电话号码" type="number"
-										pattern="[0-9]*" />
-								</div>
-							</label>
-							<div class="weui-cells__group">
-								<div class="weui-cell">7天内有无出嘉兴大市</div>
-								<div class="weui-cells weui-cells_radio">
-									<label class="weui-cell weui-cell_active weui-check__label" for="x13">
-										<div class="weui-cell__bd">
-											<p>无</p>
-										</div>
-										<div class="weui-cell__ft">
-											<input type="radio" class="weui-check" name="radio2" id="x13" checked="checked" />
-											<span class="weui-icon-checked"></span>
-										</div>
-									</label>
-									<label class="weui-cell weui-cell_active weui-check__label" for="x14">
-										<div class="weui-cell__bd">
-											<p>有</p>
-										</div>
-										<div class="weui-cell__ft">
-											<input type="radio" name="radio2" class="weui-check" id="x14"/>
-											<span class="weui-icon-checked"></span>
-										</div>
-									</label>
-								</div>
-							</div>
-							<label for="js_input5" class="weui-cell weui-cell_active">
-								<div class="weui-cell__hd"><span class="weui-label">前往地点</span></div>
-								<div class="weui-cell__bd">
-									<input id="js_input5" class="weui-input" placeholder="填写前往地点" />
-								</div>
-							</label>
-						</div>
-					</div>
-				</form>
-				<!-- <div class="weui-form__tips-area">
-					<p class="weui-form__tips">
-						表单页提示，居中对齐
-					</p>
-				</div> -->
-				<div class="weui-form__opr-area">
-					<a role="button" disabled aria-disabled="true" class="weui-btn weui-btn_primary weui-btn_disabled"
-						href="javascript:" id="showTooltips">确定</a>
-				</div>
-				<!-- <div class="weui-form__tips-area">
-					<p class="weui-form__tips">
-						表单页提示，居中对齐
-					</p>
-				</div> -->
-				<div class="weui-form__extra-area">
-					<div class="weui-footer">
-						<p class="weui-footer__links">
-							<a href="javascript:" class="weui-footer__link">南湖区公安局分局</a>
-						</p>
-						<p class="weui-footer__text">Copyright © 2020-2025 alpha.wu</p>
-					</div>
-				</div>
-			</div>
-			<div role="alert" id="js_toast" style="display: none;">
-				<div class="weui-mask_transparent"></div>
-				<div class="weui-toast">
-					<i class="weui-icon-success-no-circle weui-icon_toast"></i>
-					<p class="weui-toast__content">已完成</p>
-				</div>
-			</div>
-		</div>
-		<script type="text/javascript">
-			$(function() {
-				var $toast = $('#js_toast');
-				var $input = $('#js_input1');
-				$input.on('input', function() {
-					if ($input.val()) {
-						$('#showTooltips').removeClass('weui-btn_disabled');
-						$('#showTooltips').attr('aria-disabled', 'false');
-						$('#showTooltips').removeAttr('disabled');
-					} else {
-						$('#showTooltips').addClass('weui-btn_disabled');
-						$('#showTooltips').addClass('weui-btn_disabled');
-						$('#showTooltips').attr('aria-disabled', 'true');
-						$('#showTooltips').addAttr('disabled');
-					}
-				});
-				$('#showTooltips').on('click', function() {
-					if ($(this).hasClass('weui-btn_disabled')) return;
+<body>
+<div class="page">
+    <div role="alert" class="weui-toptips weui-toptips_warn" id="topTips">错误提示</div>
+    <form action="/func/summerCamp/add" class="weui-form" id="T_FORM">
+        <div class="weui-form__text-area">
+            <h2 class="weui-form__title">报名表</h2>
+            <div class="weui-form__desc">红船小义警特警少年夏令营</div>
+        </div>
+        <div class="weui-form__control-area">
+            <div class="weui-cells__group weui-cells__group_form">
+                <!-- <div class="weui-cells__title">表单组标题</div> -->
+                <div class="weui-cells">
+                    <label for="name" class="weui-cell weui-cell_active">
+                        <div class="weui-cell__hd"><span class="weui-label">姓名</span></div>
+                        <div class="weui-cell__bd">
+                            <input id="name" name="name" class="weui-input" placeholder="填写孩子姓名"/>
+                        </div>
+                    </label>
+                    <label for="age" class="weui-cell weui-cell_active">
+                        <div class="weui-cell__hd"><span class="weui-label">年龄</span></div>
+                        <div class="weui-cell__bd">
+                            <input id="age" name="age" class="weui-input" placeholder="填写孩子年龄" type="number"/>
+                        </div>
+                    </label>
+                    <label for="tel" class="weui-cell weui-cell_active">
+                        <div class="weui-cell__hd"><span class="weui-label">联系电话</span>
+                            <!-- <div class="weui-cell__desc">副标题</div> -->
+                        </div>
+                        <div class="weui-cell__bd">
+                            <input id="tel" name="tel" class="weui-input" placeholder="填写家长电话号码" type="number"
+                                   pattern="[0-9]*"/>
+                        </div>
+                    </label>
+                    <div class="weui-cells__group">
+                        <div class="weui-cell">性别</div>
+                        <div class="weui-cells weui-cells_radio">
+                            <label class="weui-cell weui-cell_active weui-check__label">
+                                <div class="weui-cell__bd">
+                                    <p>男</p>
+                                </div>
+                                <div class="weui-cell__ft">
+                                    <input type="radio" name="sex" value="male" class="weui-check" checked="checked"/>
+                                    <span class="weui-icon-checked"></span>
+                                </div>
+                            </label>
+                            <label class="weui-cell weui-cell_active weui-check__label">
+                                <div class="weui-cell__bd">
+                                    <p>女</p>
+                                </div>
+                                <div class="weui-cell__ft">
+                                    <input type="radio" name="sex" value="female" class="weui-check"/>
+                                    <span class="weui-icon-checked"></span>
+                                </div>
+                            </label>
+                        </div>
+                    </div>
+                    <div class="weui-cells__group">
+                        <div class="weui-cell">7天内有无出嘉兴大市</div>
+                        <div class="weui-cells weui-cells_radio">
+                            <label class="weui-cell weui-cell_active weui-check__label">
+                                <div class="weui-cell__bd">
+                                    <p>无</p>
+                                </div>
+                                <div class="weui-cell__ft">
+                                    <input type="radio" class="weui-check" name="ifout" value="0"
+                                           checked="checked"/>
+                                    <span class="weui-icon-checked"></span>
+                                </div>
+                            </label>
+                            <label class="weui-cell weui-cell_active weui-check__label">
+                                <div class="weui-cell__bd">
+                                    <p>有</p>
+                                </div>
+                                <div class="weui-cell__ft">
+                                    <input type="radio" name="ifout" value="1" class="weui-check"/>
+                                    <span class="weui-icon-checked"></span>
+                                </div>
+                            </label>
+                        </div>
+                    </div>
+                    <label for="place" class="weui-cell weui-cell_active">
+                        <div class="weui-cell__hd"><span class="weui-label">前往地点</span></div>
+                        <div class="weui-cell__bd">
+                            <input id="place" name="place" class="weui-input" placeholder="填写前往地点"/>
+                        </div>
+                    </label>
+                </div>
+            </div>
+        </div>
+        <!-- <div class="weui-form__tips-area">
+            <p class="weui-form__tips">
+                表单页提示，居中对齐
+            </p>
+        </div> -->
+        <div class="weui-form__opr-area">
+            <a role="button" disabled aria-disabled="true" class="weui-btn weui-btn_primary weui-btn_disabled"
+               href="javascript:" id="showTooltips">确定</a>
+        </div>
+        <!-- <div class="weui-form__tips-area">
+            <p class="weui-form__tips">
+                表单页提示，居中对齐
+            </p>
+        </div> -->
+        <div class="weui-form__extra-area">
+            <div class="weui-footer">
+                <p class="weui-footer__links">
+<!--                    <a href="javascript:" class="weui-footer__link">南湖区公安局分局</a>-->
+                </p>
+                <p class="weui-footer__text">Copyright © 2020-2025 alpha.wu</p>
+            </div>
+        </div>
+    </form>
+    <!--BEGIN dialog1-->
+    <div class="js_dialog" role="dialog"  aria-hidden="true" aria-modal="true" aria-labelledby="js_title1" id="iosDialog1" style="display: none;">
+        <div class="weui-mask"></div>
+        <div class="weui-dialog">
+            <div class="weui-dialog__hd"><strong class="weui-dialog__title" id="js_title1">提示</strong></div>
+            <div id="content" class="weui-dialog__bd">对不起，夏令营总数15人，报名人数已满！</div>
+            <div class="weui-dialog__ft">
+                <a role="button" class="weui-dialog__btn weui-dialog__btn_primary"
+                   href="javascript: WeixinJSBridge.call('closeWindow')" >关闭</a>
+            </div>
+        </div>
+    </div>
+    <!--END dialog1-->
+    <div role="alert" id="js_toast" style="display: none;">
+        <div class="weui-mask_transparent"></div>
+        <div class="weui-toast">
+            <i class="weui-icon-success-no-circle weui-icon_toast"></i>
+            <p class="weui-toast__content">报名成功</p>
+        </div>
+    </div>
+</div>
+<script type="text/javascript">
+    $(function () {
+        $.ajax({
+            type: 'get',
+            url: '/func/summerCamp/getCount',
+            async: false,
+            success: function (r) {
+                if (r.code === 200) {
+                    if(r.data === 15){
+                        var $iosDialog1 = $('#iosDialog1');
+                        $iosDialog1.fadeIn(200);
+                    }
+                }
+            }
+        })
+
+        var $toast = $('#js_toast');
+        var $input = $('#name');
+        $input.on('input', function () {
+            if ($input.val()) {
+                $('#showTooltips').removeClass('weui-btn_disabled');
+                $('#showTooltips').attr('aria-disabled', 'false');
+                $('#showTooltips').removeAttr('disabled');
+            } else {
+                $('#showTooltips').addClass('weui-btn_disabled');
+                $('#showTooltips').addClass('weui-btn_disabled');
+                $('#showTooltips').attr('aria-disabled', 'true');
+            }
+        });
+
+        $('#showTooltips').on('click', function () {
+            if ($(this).hasClass('weui-btn_disabled')) return;
 
-					var $form = $('#T_FORM');
-					$form.submit(function(){
-			
-	
-					console.log('11111111')
-})
-					// toptips的fixed, 如果有`animation`, `position: fixed`不生效
-					// $('.page.cell').removeClass('slideIn');
+            var name = $('#name').val();
+            if (name === undefined || name === '') {
+                $('#topTips').text("请输入孩子姓名！");
+                $('#topTips').fadeIn(200);
+                setTimeout(function() {
+                    $('#topTips').fadeOut(100);
+                }, 2000);
+                return;
+            }
+
+            var age = $('#age').val();
+            if (age === undefined || age === '') {
+                $('#topTips').text("请输入孩子年龄！");
+                $('#topTips').fadeIn(200);
+                setTimeout(function() {
+                    $('#topTips').fadeOut(100);
+                }, 2000);
+                return;
+            }
+
+            var tel = $('#tel').val();
+            if (tel === undefined || tel === '') {
+                $('#topTips').text("请输入家长联系电话！");
+                $('#topTips').fadeIn(200)
+                setTimeout(function() {
+                    $('#topTips').fadeOut(100);
+                }, 2000);
+                return;
+            }
 
-					// $toast.attr('aria-live', 'assertive');
-					// $toast.fadeIn(100);
-					// setTimeout(function() {
-					// 	$toast.attr('aria-live', 'off');
-					// 	$toast.fadeOut(100);
-					// }, 2000);
-				});
-
-				$('.weui-cell').on('click', function(){
-				 $(this).find('input').trigger('focus');
-				});
-			});
-		</script>
-	</body>
+            var sex = $("input[name='sex']:checked").val();
+            var ifout = $("input[name='ifout']:checked").val();
+            //提交 Ajax 成功后，关闭当前弹层并重载表格
+            $.ajax({
+                type: 'post',
+                url: '/func/summerCamp/add',
+                data: {
+                    name: name,
+                    age: age,
+                    sex: sex,
+                    tel: tel,
+                    ifout: ifout,
+                    place: $('#place').val(),
+                },
+                async: false,
+                success: function (r) {
+                    if (r.code === 200) {
+                        $toast.fadeIn(100);
+                        setTimeout(function() {
+                            $toast.fadeOut(100);
+                            WeixinJSBridge.call('closeWindow')
+                        }, 2000);
+                    }else{
+                        $('#topTips').text(r.msg);
+                        $('#topTips').fadeIn(200);
+                        setTimeout(function() {
+                            $('#topTips').fadeOut(100);
+                        }, 2000);
+                    }
+                }
+            });
+        });
+    });
+</script>
+</body>
 </html>
Index: src/main/java/com/kalvin/kvf/modules/sys/controller/LoginController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.sys.controller;\r\n\r\nimport com.kalvin.kvf.common.annotation.Log;\r\nimport com.kalvin.kvf.common.controller.BaseController;\r\nimport com.kalvin.kvf.common.dto.R;\r\nimport com.kalvin.kvf.common.utils.HttpServletContextKit;\r\nimport com.kalvin.kvf.common.utils.ShiroKit;\r\nimport com.wf.captcha.GifCaptcha;\r\nimport com.wf.captcha.utils.CaptchaUtil;\r\nimport org.apache.shiro.authc.UsernamePasswordToken;\r\nimport org.apache.shiro.subject.Subject;\r\nimport org.springframework.beans.factory.annotation.Value;\r\nimport org.springframework.web.bind.annotation.GetMapping;\r\nimport org.springframework.web.bind.annotation.PostMapping;\r\nimport org.springframework.web.bind.annotation.RequestParam;\r\nimport org.springframework.web.bind.annotation.RestController;\r\nimport org.springframework.web.servlet.ModelAndView;\r\n\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport javax.servlet.http.HttpServletResponse;\r\nimport java.io.IOException;\r\n\r\n/**\r\n * 作用：LayOA系统登录<br>\r\n * 说明：(无)\r\n *\r\n * @author Kalvin\r\n * @Date 2019年05月05日 15:14\r\n */\r\n@RestController\r\npublic class LoginController extends BaseController {\r\n\r\n    @Value(value = \"${kvf.login.authcode.enable}\")\r\n    private boolean needAuthCode;\r\n\r\n    @Value(value = \"${kvf.login.authcode.dynamic}\")\r\n    private boolean isDynamic;\r\n\r\n    @GetMapping(value = \"login\")\r\n    public ModelAndView login() {\r\n        Subject subject = ShiroKit.getSubject();\r\n        if (subject.isAuthenticated()) {\r\n            return new ModelAndView(\"redirect:\");\r\n        }\r\n        return new ModelAndView(\"login\");\r\n    }\r\n\r\n    @Log(\"登录\")\r\n    @PostMapping(value = \"login\")\r\n    public R login(@RequestParam(\"username\") String username, @RequestParam(\"password\") String password, boolean rememberMe, String vercode) {\r\n\r\n        // 只有开启了验证码功能才需要验证。可在yml配置kvf.login.authcode.enable来开启或关闭\r\n        if (needAuthCode) {\r\n            // 验证码校验\r\n            HttpServletRequest request = HttpServletContextKit.getHttpServletRequest();\r\n            if (!CaptchaUtil.ver(vercode, request)) {\r\n                CaptchaUtil.clear(request);  // 清除session中的验证码\r\n                return R.fail(\"验证码不正确\");\r\n            }\r\n        }\r\n\r\n        try {\r\n            Subject subject = ShiroKit.getSubject();\r\n            UsernamePasswordToken token = new UsernamePasswordToken(username, password, rememberMe);\r\n            subject.login(token);\r\n\r\n            ShiroKit.setSessionAttribute(\"user\", username);\r\n        } catch (Exception e) {\r\n            LOGGER.error(e.getMessage(), e);\r\n            return R.fail(e.getMessage());\r\n        }\r\n\r\n        return R.ok();\r\n    }\r\n\r\n    @Log(\"退出\")\r\n    @GetMapping(value = \"logout\")\r\n    public R logout() {\r\n        String username = ShiroKit.getUser().getUsername();\r\n        ShiroKit.logout();\r\n        LOGGER.info(\"{}退出登录\", username);\r\n        return R.ok();\r\n    }\r\n\r\n    /**\r\n     * 图片验证码\r\n     */\r\n    @GetMapping(value = \"captcha\")\r\n    public void captcha(HttpServletRequest request, HttpServletResponse response) throws IOException {\r\n        // 可在yml配置kvf.login.authcode.dynamic切换动静态图片验证码，默认静态\r\n        // 其它验证码样式可前往查看：https://gitee.com/whvse/EasyCaptcha\r\n        if (isDynamic) {\r\n            CaptchaUtil.out(new GifCaptcha(), request, response);\r\n        } else {\r\n            CaptchaUtil.out(request, response);\r\n        }\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/sys/controller/LoginController.java b/src/main/java/com/kalvin/kvf/modules/sys/controller/LoginController.java
--- a/src/main/java/com/kalvin/kvf/modules/sys/controller/LoginController.java	
+++ b/src/main/java/com/kalvin/kvf/modules/sys/controller/LoginController.java	
@@ -45,6 +45,11 @@
         return new ModelAndView("login");
     }
 
+    @GetMapping(value = "rank")
+    public ModelAndView rank() {
+        return new ModelAndView("rank");
+    }
+
     @Log("登录")
     @PostMapping(value = "login")
     public R login(@RequestParam("username") String username, @RequestParam("password") String password, boolean rememberMe, String vercode) {
@@ -54,7 +59,8 @@
             // 验证码校验
             HttpServletRequest request = HttpServletContextKit.getHttpServletRequest();
             if (!CaptchaUtil.ver(vercode, request)) {
-                CaptchaUtil.clear(request);  // 清除session中的验证码
+                // 清除session中的验证码
+                CaptchaUtil.clear(request);
                 return R.fail("验证码不正确");
             }
         }
Index: src/main/java/com/kalvin/kvf/modules/func/vo/QuestionBankVo.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.vo;\r\n\r\nimport com.kalvin.kvf.modules.func.entity.QuestionBank;\r\nimport com.kalvin.kvf.modules.sys.entity.Dict;\r\nimport com.kalvin.kvf.modules.sys.entity.User;\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\nimport lombok.experimental.Accessors;\r\nimport com.diboot.core.binding.annotation.BindEntity;\r\n\r\n@Getter\r\n@Setter\r\n@Accessors(chain = true)\r\npublic class QuestionBankVo extends QuestionBank {\r\n    @BindEntity(entity = Dict.class, condition=\"this.subject_type=id\")\r\n    private Dict dictSubType;\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/vo/QuestionBankVo.java b/src/main/java/com/kalvin/kvf/modules/func/vo/QuestionBankVo.java
--- a/src/main/java/com/kalvin/kvf/modules/func/vo/QuestionBankVo.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/vo/QuestionBankVo.java	
@@ -1,6 +1,7 @@
 package com.kalvin.kvf.modules.func.vo;
 
 import com.kalvin.kvf.modules.func.entity.QuestionBank;
+import com.kalvin.kvf.modules.func.entity.QuestionCollect;
 import com.kalvin.kvf.modules.sys.entity.Dict;
 import com.kalvin.kvf.modules.sys.entity.User;
 import lombok.Getter;
@@ -12,6 +13,6 @@
 @Setter
 @Accessors(chain = true)
 public class QuestionBankVo extends QuestionBank {
-    @BindEntity(entity = Dict.class, condition="this.subject_type=id")
-    private Dict dictSubType;
+    @BindEntity(entity = QuestionCollect.class, condition="this.id=qs_id")
+    private QuestionCollect questionCollect;
 }
Index: src/main/resources/templates/func/train_edit.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n</head>\r\n<body>\r\n<div class=\"layui-form\" style=\"padding: 20px 30px 0 0;\">\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">标题</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"title\" th:value=\"${editInfo.title}\" placeholder=\"请输入标题\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">路径</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"videoUrl\" th:value=\"${editInfo.videoUrl}\" placeholder=\"请输入路径\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">描述</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"descrption\" th:value=\"${editInfo.descrption}\" placeholder=\"请输入描述\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">创建时间</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"createTime\" id=\"createTime\" th:value=\"${#strings.replace(editInfo.createTime,'T',' ')}\" placeholder=\"请输入创建时间\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"layui-form-item layui-hide\">\r\n        <input type=\"button\" lay-submit=\"\" lay-filter=\"kFormSubmit\" id=\"kFormSubmit\">\r\n        <input type=\"text\" name=\"id\" th:value=\"${editInfo.id}\" autocomplete=\"off\" class=\"layui-input\">\r\n    </div>\r\n</div>\r\n\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n<script>\r\n    layui.use(['form', 'laydate'], function () {\r\n        var $ = layui.$, form = layui.form, laydate = layui.laydate;\r\n\r\n\r\n        laydate.render({\r\n            elem: '#createTime' // 指定元素\r\n            ,type: 'datetime'\r\n        });\r\n\r\n        //监听提交\r\n        form.on('submit(kFormSubmit)', function(data){\r\n            var field = data.field; //获取提交的字段\r\n            var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引\r\n\r\n            var url = field.id ? 'func/train/edit' : 'func/train/add';\r\n            //提交 Ajax 成功后，关闭当前弹层并重载表格\r\n            $.ajax({\r\n                type: req.type.post,\r\n                url: BASE_WEB + url,\r\n                data: field,\r\n                async: false,\r\n                success: function (r) {\r\n                    if (r.code === req.status.ok) {\r\n                        // 重载表格\r\n                        parent.layui.table.reload('kContentTable');\r\n                        parent.layer.close(index); //再执行关闭\r\n                    } else {\r\n                        kvfKit.errorMsg(r.msg);\r\n                    }\r\n                }\r\n            });\r\n\r\n        });\r\n    })\r\n</script>\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/func/train_edit.html b/src/main/resources/templates/func/train_edit.html
--- a/src/main/resources/templates/func/train_edit.html	
+++ b/src/main/resources/templates/func/train_edit.html	
@@ -10,28 +10,27 @@
     <div class="layui-form-item">
         <label class="layui-form-label">标题</label>
         <div class="layui-input-inline">
-            <input type="text" name="title" th:value="${editInfo.title}" placeholder="请输入标题" autocomplete="off" class="layui-input">
+            <input type="text" name="title" th:value="${editInfo.title}" placeholder="请输入标题" autocomplete="off"
+                   class="layui-input">
         </div>
     </div>
-    <div class="layui-form-item">
-        <label class="layui-form-label">路径</label>
-        <div class="layui-input-inline">
-            <input type="text" name="videoUrl" th:value="${editInfo.videoUrl}" placeholder="请输入路径" autocomplete="off" class="layui-input">
+
+    <div class="layui-form-item" id="videoUp">
+        <label class="layui-form-label" style="height: 137px; line-height: 117px">视频</label>
+        <input name="videoUrl" id="videoUrl" value="" autocomplete="off" class="layui-input" type="hidden">
+        <div class=" layui-upload-drag" id="kVideoUpload" style="border-left: 0px;" type="video">
+            <i class="layui-icon">&#xe654;</i>
+            <p>点击上传</p>
+            <video id="demo9" th:src="@{/} + ${'common/static/'+ editInfo.videoUrl}" style="position: absolute;height: 137px; margin: -106px auto auto -60px;"></video>
         </div>
     </div>
     <div class="layui-form-item">
         <label class="layui-form-label">描述</label>
         <div class="layui-input-inline">
-            <input type="text" name="descrption" th:value="${editInfo.descrption}" placeholder="请输入描述" autocomplete="off" class="layui-input">
-        </div>
-    </div>
-    <div class="layui-form-item">
-        <label class="layui-form-label">创建时间</label>
-        <div class="layui-input-inline">
-            <input type="text" name="createTime" id="createTime" th:value="${#strings.replace(editInfo.createTime,'T',' ')}" placeholder="请输入创建时间" autocomplete="off" class="layui-input">
+            <input type="text" name="description" th:value="${editInfo.description}" placeholder="请输入描述"
+                   autocomplete="off" class="layui-input">
         </div>
     </div>
-
     <div class="layui-form-item layui-hide">
         <input type="button" lay-submit="" lay-filter="kFormSubmit" id="kFormSubmit">
         <input type="text" name="id" th:value="${editInfo.id}" autocomplete="off" class="layui-input">
@@ -41,17 +40,34 @@
 <script th:replace="common/base::context"></script>
 <script th:replace="common/base::mainjs"></script>
 <script>
-    layui.use(['form', 'laydate'], function () {
-        var $ = layui.$, form = layui.form, laydate = layui.laydate;
+    layui.use(['form', 'laydate', 'upload'], function () {
+        var $ = layui.$, form = layui.form, upload = layui.upload;
 
-
-        laydate.render({
-            elem: '#createTime' // 指定元素
-            ,type: 'datetime'
+        //执行实例
+        upload.render({
+            elem: '#kVideoUpload' //绑定元素
+            , url: api.comm.fileUpload //上传接口
+            , data: {type: 'video'}
+            , accept: 'video'
+            , done: function (r) {
+                //上传完毕回调
+                if (r.code === req.status.ok) {
+                    log(r.data);
+                    $("#videoUrl").val(r.data.path);
+                    $("#demo9").attr("src",BASE_WEB + "common/static/" + r.data.path);
+                    kvfKit.sucessMsg('上传成功');
+                } else {
+                    kvfKit.errorMsg('上传失败：' + r.msg);
+                }
+            }
+            , error: function (index, upload) {
+                //请求异常回调
+                kvfKit.errorMsg('上传失败');
+            }
         });
 
         //监听提交
-        form.on('submit(kFormSubmit)', function(data){
+        form.on('submit(kFormSubmit)', function (data) {
             var field = data.field; //获取提交的字段
             var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
 
Index: src/main/resources/templates/sys/user_pwd.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n</head>\r\n<body style=\"background-color: #f2f2f2;\">\r\n\r\n<div id=\"kPage\" class=\"layui-fluid\" style=\"padding: 0\">\r\n    <div class=\"layui-row kvf-fluid-padding15\">\r\n        <div class=\"layui-col-md12\">\r\n            <div class=\"layui-card\">\r\n                <div class=\"layui-card-header\">修改登录密码</div>\r\n                <div class=\"layui-card-body\">\r\n                    <div class=\"layui-form\" lay-filter=\"\">\r\n                        <div class=\"layui-form-item\">\r\n                            <label class=\"layui-form-label\">当前密码</label>\r\n                            <div class=\"layui-input-inline\">\r\n                                <input type=\"password\" name=\"oldPassword\" lay-verify=\"required\" lay-vertype=\"tips\" class=\"layui-input\">\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"layui-form-item\">\r\n                            <label class=\"layui-form-label\">新密码</label>\r\n                            <div class=\"layui-input-inline\">\r\n                                <input type=\"password\" name=\"password\" lay-verify=\"pass\" lay-vertype=\"tips\" autocomplete=\"off\" id=\"LAY_password\" class=\"layui-input\">\r\n                            </div>\r\n                            <div class=\"layui-form-mid layui-word-aux\">6到16个字符</div>\r\n                        </div>\r\n                        <div class=\"layui-form-item\">\r\n                            <label class=\"layui-form-label\">确认新密码</label>\r\n                            <div class=\"layui-input-inline\">\r\n                                <input type=\"password\" name=\"repassword\" lay-verify=\"repass\" lay-vertype=\"tips\" autocomplete=\"off\" class=\"layui-input\">\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class=\"layui-form-item\">\r\n                            <div class=\"layui-input-block\">\r\n                                <button class=\"layui-btn\" lay-submit=\"\" lay-filter=\"kFormSubmit\">确认修改</button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n\r\n<script type=\"text/javascript\" th:inline=\"javascript\">\r\n    layui.use(['form'], function () {\r\n        var $ = layui.$, form = layui.form;\r\n\r\n        form.verify({\r\n            pass: function (value, item) {\r\n                var reg = new RegExp(/^[a-z0-9]{6,16}$/);\r\n                if (!reg.test(value)) {\r\n                    return '6~16个字母或数字';\r\n                }\r\n            },\r\n            repass: function (value, item) {\r\n                var password = $('input[name=\"password\"]').val();\r\n                if (password !== value) {\r\n                    return '与第一次输入的密码不一致';\r\n                }\r\n            }\r\n        });\r\n\r\n        //监听提交\r\n        form.on('submit(kFormSubmit)', function (data) {\r\n            var field = data.field; //获取提交的字段\r\n\r\n            $.ajax({\r\n                type: req.type.post,\r\n                url: api.sys.userChangePwd,\r\n                data: field,\r\n                async: false,\r\n                success: function (r) {\r\n                    if (r.code === req.status.ok) {\r\n                        kvfKit.sucessMsg('修改成功');\r\n                    } else {\r\n                        kvfKit.errorMsg(r.msg);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    });\r\n</script>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/sys/user_pwd.html b/src/main/resources/templates/sys/user_pwd.html
--- a/src/main/resources/templates/sys/user_pwd.html	
+++ b/src/main/resources/templates/sys/user_pwd.html	
@@ -57,9 +57,10 @@
 
         form.verify({
             pass: function (value, item) {
-                var reg = new RegExp(/^[a-z0-9]{6,16}$/);
-                if (!reg.test(value)) {
-                    return '6~16个字母或数字';
+                var password = $('input[name="password"]').val();
+                var reg = new RegExp('(?=.*[0-9])(?=.*[A-Z])(?=.*[a-z])(?=.*[^a-zA-Z0-9]).{8,30}');
+                if (!reg.test(password)) {
+                    return "密码中必须包含大小写字母、数字、特称字符，至少8个字符，最多30个字符！";
                 }
             },
             repass: function (value, item) {
Index: src/main/resources/templates/common/base.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html lang=\"en\" xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<!--全局title-->\r\n<title th:fragment=\"pagetitle\">kvfAdmin</title>\r\n<body>\r\n    <!-- loa上下文路径  -->\r\n    <script th:fragment=\"context\" th:inline=\"javascript\">\r\n        var BASE_WEB = [[${#httpServletRequest.getContextPath()}]] + '/';\r\n    </script>\r\n\r\n    <!--系统图标-->\r\n    <link th:fragment=\"icon\" rel=\"shortcut icon\" th:href=\"@{/static/favicon.ico}\" type=\"image/x-icon\"/>\r\n\r\n    <!-- 共用css/js静态资源 -->\r\n    <div th:fragment=\"static\">\r\n        <link rel=\"stylesheet\" th:href=\"@{/static/plugins/layui/css/layui.css}\">\r\n        <link rel=\"stylesheet\" th:href=\"@{/static/plugins/lay-formselect/formSelects-v4.css}\">\r\n        <link rel=\"stylesheet\" th:href=\"@{/static/css/kvf.css}\">\r\n        <link rel=\"stylesheet\" th:href=\"@{/static/plugins/font-awesome/css/font-awesome.min.css}\">\r\n        <link rel=\"stylesheet\" th:href=\"@{/static/plugins/ztree/css/metroStyle/metroStyle.css}\">\r\n    </div>\r\n\r\n    <div th:fragment=\"iconpkcss\">\r\n        <link rel=\"stylesheet\" th:href=\"@{/static/plugins/fonticon-picker/css/jquery.fonticonpicker.min.css}\">\r\n        <link rel=\"stylesheet\" th:href=\"@{/static/plugins/fonticon-picker/css/jquery.fonticonpicker.grey.min.css}\">\r\n    </div>\r\n\r\n    <div th:fragment=\"mainjs\">\r\n        <script th:src=\"@{/static/js/jquery.min.js}\"></script>\r\n        <script th:src=\"@{/static/js/jquery.cookie.js}\"></script>\r\n        <script th:src=\"@{/static/plugins/layui/layui.js}\"></script>\r\n        <script th:src=\"@{/static/js/kconfig.js}\"></script>\r\n        <script th:src=\"@{/static/js/kcommon.js}\"></script>\r\n        <script th:src=\"@{/static/js/kpopup.js}\"></script>\r\n        <script th:src=\"@{/static/plugins/ztree/js/jquery.ztree.all.min.js}\"></script>\r\n    </div>\r\n\r\n    <div th:fragment=\"iconpkjs\">\r\n        <script th:src=\"@{/static/plugins/fonticon-picker/js/jquery.fonticonpicker.min.js}\"></script>\r\n        <script th:src=\"@{/static/plugins/fonticon-picker/js/fa-icon-source.js}\"></script>\r\n    </div>\r\n\r\n    <div th:fragment=\"echartjs\">\r\n        <script th:src=\"@{/static/plugins/echarts/echarts.min.js}\"></script>\r\n    </div>\r\n\r\n    <!--UEditor插件相关js-->\r\n    <div th:fragment=\"ueditorjs\">\r\n        <script type=\"text/javascript\" charset=\"utf-8\" th:src=\"@{/static/plugins/ueditor/ueditor.config.js}\"></script>\r\n        <script type=\"text/javascript\" charset=\"utf-8\" th:src=\"@{/static/plugins/ueditor/ueditor.all.js}\"></script>\r\n        <script type=\"text/javascript\" charset=\"utf-8\" th:src=\"@{/static/plugins/ueditor/lang/zh-cn/zh-cn.js}\"></script>\r\n    </div>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/common/base.html b/src/main/resources/templates/common/base.html
--- a/src/main/resources/templates/common/base.html	
+++ b/src/main/resources/templates/common/base.html	
@@ -1,7 +1,7 @@
 <!DOCTYPE html>
 <html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
 <!--全局title-->
-<title th:fragment="pagetitle">kvfAdmin</title>
+<title th:fragment="pagetitle">红船钉</title>
 <body>
     <!-- loa上下文路径  -->
     <script th:fragment="context" th:inline="javascript">
Index: src/main/java/com/kalvin/kvf/modules/util/EncryptUtil.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.common.utils;\r\n\r\n\r\nimport com.sun.org.apache.xerces.internal.impl.dv.util.Base64;\r\n\r\nimport javax.crypto.Cipher;\r\nimport javax.crypto.KeyGenerator;\r\nimport javax.crypto.Mac;\r\nimport javax.crypto.SecretKey;\r\nimport javax.crypto.spec.SecretKeySpec;\r\nimport java.security.MessageDigest;\r\nimport java.security.SecureRandom;\r\n\r\n/**\r\n * 加密工具\r\n */\r\npublic class EncryptUtil {\r\n\r\n    private EncryptUtil() {\r\n    }\r\n\r\n    public static final String MD5 = \"MD5\";\r\n    public static final String SHA1 = \"SHA1\";\r\n    public static final String HmacMD5 = \"HmacMD5\";\r\n    public static final String HmacSHA1 = \"HmacSHA1\";\r\n    public static final String DES = \"DES\";\r\n    public static final String AES = \"AES\";\r\n    public static final String KEY = \"1234zxcv@NHGA\";\r\n\r\n    /**\r\n     * 编码格式；默认使用uft-8\r\n     */\r\n    public static String charset = \"utf-8\";\r\n    /**\r\n     * DES\r\n     */\r\n    public static int keysizeDES = 0;\r\n    /**\r\n     * AES\r\n     */\r\n    public static int keysizeAES = 128;\r\n\r\n\r\n    /**\r\n     * 使用MessageDigest进行单向加密（无密码）\r\n     *\r\n     * @param res       被加密的文本\r\n     * @param algorithm 加密算法名称\r\n     * @return\r\n     */\r\n    private static String messageDigest(String res, String algorithm) {\r\n        try {\r\n            MessageDigest md = MessageDigest.getInstance(algorithm);\r\n            byte[] resBytes = charset == null ? res.getBytes() : res.getBytes(charset);\r\n            return base64(md.digest(resBytes));\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * 使用KeyGenerator进行单向/双向加密（可设密码）\r\n     *\r\n     * @param res       被加密的原文\r\n     * @param algorithm 加密使用的算法名称\r\n     * @param key       加密使用的秘钥\r\n     * @return\r\n     */\r\n    private static String keyGeneratorMac(String res, String algorithm, String key) {\r\n        try {\r\n            SecretKey sk = null;\r\n            if (key == null) {\r\n                KeyGenerator kg = KeyGenerator.getInstance(algorithm);\r\n                sk = kg.generateKey();\r\n            } else {\r\n                byte[] keyBytes = charset == null ? key.getBytes() : key.getBytes(charset);\r\n                sk = new SecretKeySpec(keyBytes, algorithm);\r\n            }\r\n            Mac mac = Mac.getInstance(algorithm);\r\n            mac.init(sk);\r\n            byte[] result = mac.doFinal(res.getBytes());\r\n            return base64(result);\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * 使用KeyGenerator双向加密，DES/AES，注意这里转化为字符串的时候是将2进制转为16进制格式的字符串，不是直接转，因为会出错\r\n     *\r\n     * @param res       加密的原文\r\n     * @param algorithm 加密使用的算法名称\r\n     * @param key       加密的秘钥\r\n     * @param keysize\r\n     * @param isEncode\r\n     * @return\r\n     */\r\n    private static String keyGeneratorES(String res, String algorithm, String key, int keysize, boolean isEncode) {\r\n        try {\r\n            KeyGenerator kg = KeyGenerator.getInstance(algorithm);\r\n            if (keysize == 0) {\r\n                byte[] keyBytes = charset == null ? key.getBytes() : key.getBytes(charset);\r\n                kg.init(new SecureRandom(keyBytes));\r\n            } else if (key == null) {\r\n                kg.init(keysize);\r\n            } else {\r\n                byte[] keyBytes = charset == null ? key.getBytes() : key.getBytes(charset);\r\n                kg.init(keysize, new SecureRandom(keyBytes));\r\n            }\r\n            SecretKey sk = kg.generateKey();\r\n            SecretKeySpec sks = new SecretKeySpec(sk.getEncoded(), algorithm);\r\n            Cipher cipher = Cipher.getInstance(algorithm);\r\n            if (isEncode) {\r\n                cipher.init(Cipher.ENCRYPT_MODE, sks);\r\n                byte[] resBytes = charset == null ? res.getBytes() : res.getBytes(charset);\r\n                return parseByte2HexStr(cipher.doFinal(resBytes));\r\n            } else {\r\n                cipher.init(Cipher.DECRYPT_MODE, sks);\r\n                return new String(cipher.doFinal(parseHexStr2Byte(res)));\r\n            }\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private static String base64(byte[] res) {\r\n        return Base64.encode(res);\r\n    }\r\n\r\n    /**\r\n     * 将二进制转换成16进制\r\n     *\r\n     * @param buf\r\n     * @return\r\n     */\r\n    public static String parseByte2HexStr(byte buf[]) {\r\n        StringBuffer sb = new StringBuffer();\r\n        for (int i = 0; i < buf.length; i++) {\r\n            String hex = Integer.toHexString(buf[i] & 0xFF);\r\n            if (hex.length() == 1) {\r\n                hex = '0' + hex;\r\n            }\r\n            sb.append(hex.toUpperCase());\r\n        }\r\n        return sb.toString();\r\n    }\r\n\r\n    /**\r\n     * 将16进制转换为二进制\r\n     *\r\n     * @param hexStr\r\n     * @return\r\n     */\r\n    public static byte[] parseHexStr2Byte(String hexStr) {\r\n        if (hexStr.length() < 1) {\r\n            return null;\r\n        }\r\n        byte[] result = new byte[hexStr.length() / 2];\r\n        for (int i = 0; i < hexStr.length() / 2; i++) {\r\n            int high = Integer.parseInt(hexStr.substring(i * 2, i * 2 + 1), 16);\r\n            int low = Integer.parseInt(hexStr.substring(i * 2 + 1, i * 2 + 2), 16);\r\n            result[i] = (byte) (high * 16 + low);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * md5加密算法进行加密（不可逆）\r\n     *\r\n     * @param res 需要加密的原文\r\n     * @return\r\n     */\r\n    public static String MD5(String res) {\r\n        return messageDigest(res, MD5);\r\n    }\r\n\r\n    /**\r\n     * md5加密算法进行加密（不可逆）\r\n     *\r\n     * @param res 需要加密的原文\r\n     * @param key 秘钥\r\n     * @return\r\n     */\r\n    public static String MD5(String res, String key) {\r\n        return keyGeneratorMac(res, HmacMD5, key);\r\n    }\r\n\r\n    /**\r\n     * 使用SHA1加密算法进行加密（不可逆）\r\n     *\r\n     * @param res 需要加密的原文\r\n     * @return\r\n     */\r\n    public static String SHA1(String res) {\r\n        return messageDigest(res, SHA1);\r\n    }\r\n\r\n    /**\r\n     * 使用SHA1加密算法进行加密（不可逆）\r\n     *\r\n     * @param res 需要加密的原文\r\n     * @param key 秘钥\r\n     * @return\r\n     */\r\n    public static String SHA1(String res, String key) {\r\n        return keyGeneratorMac(res, HmacSHA1, key);\r\n    }\r\n\r\n    /**\r\n     * 使用DES加密算法进行加密（可逆）\r\n     *\r\n     * @param res 需要加密的原文\r\n     * @param key 秘钥\r\n     * @return\r\n     */\r\n    public static String DESencode(String res, String key) {\r\n        return keyGeneratorES(res, DES, key, keysizeDES, true);\r\n    }\r\n\r\n    /**\r\n     * 对使用DES加密算法的密文进行解密（可逆）\r\n     *\r\n     * @param res 需要解密的密文\r\n     * @param key 秘钥\r\n     * @return\r\n     */\r\n    public static String DESdecode(String res, String key) {\r\n        return keyGeneratorES(res, DES, key, keysizeDES, false);\r\n    }\r\n\r\n    /**\r\n     * 使用AES加密算法经行加密（可逆）\r\n     *\r\n     * @param res 需要加密的密文\r\n     * @param key 秘钥\r\n     * @return\r\n     */\r\n    public static String AESencode(String res, String key) {\r\n        return keyGeneratorES(res, AES, key, keysizeAES, true);\r\n    }\r\n\r\n    /**\r\n     * 对使用AES加密算法的密文进行解密\r\n     *\r\n     * @param res 需要解密的密文\r\n     * @param key 秘钥\r\n     * @return\r\n     */\r\n    public static String AESdecode(String res, String key) {\r\n        return keyGeneratorES(res, AES, key, keysizeAES, false);\r\n    }\r\n\r\n    /**\r\n     * 使用异或进行加密\r\n     *\r\n     * @param res 需要加密的密文\r\n     * @param key 秘钥\r\n     * @return\r\n     */\r\n    public static String XORencode(String res, String key) {\r\n        byte[] bs = res.getBytes();\r\n        for (int i = 0; i < bs.length; i++) {\r\n            bs[i] = (byte) ((bs[i]) ^ key.hashCode());\r\n        }\r\n        return parseByte2HexStr(bs);\r\n    }\r\n\r\n    /**\r\n     * 使用异或进行解密\r\n     *\r\n     * @param res 需要解密的密文\r\n     * @param key 秘钥\r\n     * @return\r\n     */\r\n    public static String XORdecode(String res, String key) {\r\n        byte[] bs = parseHexStr2Byte(res);\r\n        for (int i = 0; i < bs.length; i++) {\r\n            bs[i] = (byte) ((bs[i]) ^ key.hashCode());\r\n        }\r\n        return new String(bs);\r\n    }\r\n\r\n    /**\r\n     * 直接使用异或（第一调用加密，第二次调用解密）\r\n     *\r\n     * @param res 密文\r\n     * @param key 秘钥\r\n     * @return\r\n     */\r\n    public static int XOR(int res, String key) {\r\n        return res ^ key.hashCode();\r\n    }\r\n\r\n    /**\r\n     * 使用Base64进行加密\r\n     *\r\n     * @param res 密文\r\n     * @return\r\n     */\r\n    public static String Base64Encode(String res) {\r\n        return Base64.encode(res.getBytes());\r\n    }\r\n\r\n    /**\r\n     * 使用Base64进行解密\r\n     *\r\n     * @param res\r\n     * @return\r\n     */\r\n    public static String Base64Decode(String res) {\r\n        return new String(Base64.decode(res));\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/util/EncryptUtil.java b/src/main/java/com/kalvin/kvf/modules/util/EncryptUtil.java
--- a/src/main/java/com/kalvin/kvf/modules/util/EncryptUtil.java	
+++ b/src/main/java/com/kalvin/kvf/modules/util/EncryptUtil.java	
@@ -1,4 +1,4 @@
-package com.kalvin.kvf.common.utils;
+package com.kalvin.kvf.modules.util;
 
 
 import com.sun.org.apache.xerces.internal.impl.dv.util.Base64;
Index: src/main/resources/templates/func/userTab.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n</head>\r\n<body style=\"background-color: #f2f2f2;\">\r\n\r\n<div id=\"kPage\" class=\"layui-fluid\" style=\"padding: 0\">\r\n    <div class=\"layui-row\">\r\n        <div class=\"layui-col-md12\" id=\"kMainContentCol\">\r\n            <div class=\"layui-fluid kvf-fluid-padding15\">\r\n                <div class=\"layui-card\">\r\n                    <form>\r\n                        <div class=\"layui-form layui-card-header kvf-card-header-auto\">\r\n                            <div class=\"layui-form-item\">\r\n                                <div class=\"layui-inline\">\r\n                                    <label class=\"layui-form-label\">姓名</label>\r\n                                    <div class=\"layui-input-inline\">\r\n                                        <input type=\"text\" name=\"realname\" placeholder=\"请输入姓名\" autocomplete=\"off\" class=\"layui-input\">\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class=\"layui-inline\">\r\n                                    <label class=\"layui-form-label\">手机号</label>\r\n                                    <div class=\"layui-input-inline\">\r\n                                        <input type=\"text\" name=\"mobile\" placeholder=\"请输入手机号\" autocomplete=\"off\" class=\"layui-input\">\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class=\"layui-inline\">\r\n                                    <button class=\"layui-btn \" lay-submit=\"\" lay-filter=\"kTableSearchFilter\">\r\n                                        <i class=\"layui-icon layui-icon-search\"></i>\r\n                                    </button>\r\n                                    <button class=\"layui-btn \" type=\"reset\" data-event=\"refresh\">\r\n                                        <i class=\"layui-icon layui-icon-refresh-1\"></i>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </form>\r\n\r\n                    <div class=\"layui-card-body\">\r\n                        <table id=\"kContentTable\" lay-filter=\"kContentTable\"></table>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n\r\n<!--头部工具栏模板-->\r\n<script type=\"text/html\" id=\"headToolbarTpl\">\r\n    <button class=\"layui-btn layui-btn-sm \" lay-event=\"add\">添加</button>\r\n    <button class=\"layui-btn layui-btn-sm layui-btn-danger\" lay-event=\"batchdel\">批量删除</button>\r\n</script>\r\n\r\n<!--表格行工具栏模板-->\r\n<script type=\"text/html\" id=\"rowToolbarTpl\">\r\n    <a class=\"layui-btn layui-btn-xs layui-btn-normal\" lay-event=\"edit\"><i class=\"layui-icon layui-icon-edit\"></i>编辑</a>\r\n    <a class=\"layui-btn layui-btn-xs layui-btn-danger\" lay-event=\"del\"><i class=\"layui-icon layui-icon-delete\"></i>删除</a>\r\n</script>\r\n\r\n<!--表格列格式化模板 start-->\r\n<!--表格列格式化模板 end-->\r\n\r\n<script type=\"text/javascript\" th:inline=\"javascript\">\r\n    layui.use(['element', 'form', 'layer', 'table', 'laydate'], function () {\r\n        var elemet = layui.element, form = layui.form, layer = layui.layer, table = layui.table, laydate = layui.laydate;\r\n        var tableId = 'kContentTable';\r\n        var area = ['449px', '95%'];\r\n\r\n        // 实例化table\r\n        var tableIns = table.render($.extend(config.layui.table, {\r\n            elem: '#' + tableId\r\n            ,url: BASE_WEB + 'func/userTab/list/data' // 数据接口\r\n            ,toolbar: '#headToolbarTpl'\r\n            ,cols: [[ //表头\r\n                {type:'checkbox', fixed: 'left'}\r\n                ,{field: 'userid', title: '用户id', width: 130}\r\n                ,{field: 'realname', title: '姓名'}\r\n                ,{field: 'mobile', title: '手机号', width: 130}\r\n                ,{field: 'department', title: '部门id', width: 130}\r\n                ,{field: 'unionid', title: 'union', width: 130}\r\n                ,{field: 'avatar', title: '头像', width: 130}\r\n                ,{field: '', title: '操作', width: 235, fixed: 'right', templet: '#rowToolbarTpl'}\r\n            ]]\r\n        }));\r\n\r\n        // 监听表格头部事件\r\n        table.on('toolbar(' + tableId + ')', function(obj){\r\n            var checkStatus = table.checkStatus(obj.config.id);\r\n            var checkData = checkStatus.data; // 得到选中的数据\r\n            switch(obj.event) {\r\n                case 'add':\r\n                    layer.open({\r\n                        type: 2\r\n                        ,title: '添加'\r\n                        ,content: BASE_WEB + 'func/userTab/edit'\r\n                        ,maxmin: true\r\n                        ,area: area   // 宽高\r\n                        ,btn: ['确定', '取消']\r\n                        ,yes: function(index, layero){\r\n                            //点击确认触发 iframe 内容中的按钮提交\r\n                            var submit = layero.find('iframe').contents().find(\"#kFormSubmit\");\r\n                            submit.click();\r\n                        }\r\n                    });\r\n                    break;\r\n                case 'batchdel':\r\n                    if(checkData.length === 0){\r\n                        return kvfKit.warningMsg('请选择数据');\r\n                    }\r\n                    layer.confirm('确定删除吗？', function(index) {\r\n                        var ids = [];\r\n                        $.each(checkData, function(i, n){\r\n                            ids[i] = n.id;\r\n                        });\r\n\r\n                        //执行 Ajax 后重载\r\n                        $.ajax({\r\n                            type: req.type.post,\r\n                            url: BASE_WEB + 'func/userTab/batchdel',\r\n                            data: {ids: ids.toString()},\r\n                            success: function (r) {\r\n                                if (r.code === req.status.ok) {\r\n                                    table.reload(tableId);\r\n                                    kvfKit.sucessMsg('已删除');\r\n                                } else {\r\n                                    kvfKit.errorMsg(r.msg);\r\n                                }\r\n                            }\r\n                        });\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n\r\n        // 表格行按钮 监听事件\r\n        table.on('tool(' + tableId + ')', function (obj) {\r\n            var data = obj.data; //获得当前行数据\r\n            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）\r\n            var tr = obj.tr; //获得当前行 tr 的DOM对象\r\n\r\n            if (layEvent === 'edit') {\r\n                layer.open({\r\n                    type: 2\r\n                    ,title: '编辑'\r\n                    ,content: BASE_WEB + 'func/userTab/edit?id=' + data.id\r\n                    ,maxmin: true\r\n                    ,area: area   // 宽高\r\n                    ,btn: ['确定', '取消']\r\n                    ,yes: function(index, layero){\r\n                        //点击确认触发 iframe 内容中的按钮提交\r\n                        var submit = layero.find('iframe').contents().find(\"#kFormSubmit\");\r\n                        submit.click();\r\n                    }\r\n                });\r\n            }\r\n            if (layEvent === 'del') {\r\n                layer.confirm('确定删除吗？', function(index) {\r\n                    //执行 Ajax 后重载\r\n                    $.ajax({\r\n                        type: req.type.post,\r\n                        url: BASE_WEB + 'func/userTab/del/' + data.id,\r\n                        async: false,\r\n                        success: function (r) {\r\n                            if (r.code === req.status.ok) {\r\n                                table.reload(tableId);\r\n                                kvfKit.sucessMsg('已删除');\r\n                            } else {\r\n                                kvfKit.errorMsg(r.msg);\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        });\r\n\r\n\r\n        // 监听查询\r\n        form.on('submit(kTableSearchFilter)', function (obj) {\r\n            renderTableData(obj.field);\r\n            return false;\r\n        });\r\n\r\n        var active = {\r\n            refresh: function () {\r\n                var $form = $('form');\r\n                $form[0].reset();\r\n                renderTableData(kvfKit.getFormJson($form));\r\n            }\r\n        };\r\n\r\n        kvfKit.activeInit(active);\r\n\r\n        function renderTableData(params) {\r\n            params = params ? params : {};\r\n\r\n            tableIns.reload({\r\n                where: params,\r\n                page: {curr: 1}\r\n            });\r\n        }\r\n\r\n        // 绑定监听回车事件\r\n        kvfKit.bindEnterEventForLayuiForm();\r\n\r\n    });\r\n</script>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/func/userTab.html b/src/main/resources/templates/func/userTab.html
--- a/src/main/resources/templates/func/userTab.html	
+++ b/src/main/resources/templates/func/userTab.html	
@@ -83,12 +83,12 @@
             ,toolbar: '#headToolbarTpl'
             ,cols: [[ //表头
                 {type:'checkbox', fixed: 'left'}
-                ,{field: 'userid', title: '用户id', width: 130}
-                ,{field: 'realname', title: '姓名'}
-                ,{field: 'mobile', title: '手机号', width: 130}
-                ,{field: 'department', title: '部门id', width: 130}
-                ,{field: 'unionid', title: 'union', width: 130}
-                ,{field: 'avatar', title: '头像', width: 130}
+                ,{field: 'userid', title: '用户id', width: 130, align: 'center'}
+                ,{field: 'realname', title: '姓名', width: 130, align: 'center'}
+                ,{field: 'mobile', title: '手机号', width: 130, align: 'center'}
+                ,{field: 'department', title: '部门名称', width: 150, align: 'center'}
+                ,{field: 'unionid', title: 'union', width: 200, align: 'center'}
+                ,{field: 'avatar', title: '头像', width: 200, align: 'center'}
                 ,{field: '', title: '操作', width: 235, fixed: 'right', templet: '#rowToolbarTpl'}
             ]]
         }));
Index: src/main/resources/templates/func/questionBank.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n</head>\r\n<body style=\"background-color: #f2f2f2;\">\r\n\r\n<div id=\"kPage\" class=\"layui-fluid\" style=\"padding: 0\">\r\n    <div class=\"layui-row\">\r\n        <div class=\"layui-col-md12\" id=\"kMainContentCol\">\r\n            <div class=\"layui-fluid kvf-fluid-padding15\">\r\n                <div class=\"layui-card\">\r\n                    <form>\r\n                        <div class=\"layui-form layui-card-header kvf-card-header-auto\">\r\n                            <div class=\"layui-form-item\">\r\n                                <div class=\"layui-inline\">\r\n                                    <label class=\"layui-form-label\">题目类型</label>\r\n                                    <div class=\"layui-input-inline\">\r\n                                        <select class=\"layui-select\" name=\"subjectType\">\r\n                                            <option value=\"\">请选择</option>\r\n                                            <option value=\"1\">单选题</option>\r\n                                            <option value=\"2\">多选题</option>\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"layui-inline\">\r\n                                    <label class=\"layui-form-label\">状态</label>\r\n                                    <div class=\"layui-input-inline\">\r\n                                        <select class=\"layui-select\" name=\"status\">\r\n                                            <option value=\"\">请选择</option>\r\n                                            <option value=\"0\">正常</option>\r\n                                            <option value=\"1\">禁止</option>\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class=\"layui-inline\">\r\n                                    <button class=\"layui-btn \" lay-submit=\"\" lay-filter=\"kTableSearchFilter\">\r\n                                        <i class=\"layui-icon layui-icon-search\"></i>\r\n                                    </button>\r\n                                    <button class=\"layui-btn \" type=\"reset\" data-event=\"refresh\">\r\n                                        <i class=\"layui-icon layui-icon-refresh-1\"></i>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </form>\r\n\r\n                    <div class=\"layui-card-body\">\r\n                        <table id=\"kContentTable\" lay-filter=\"kContentTable\"></table>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n\r\n<!--头部工具栏模板-->\r\n<script type=\"text/html\" id=\"headToolbarTpl\">\r\n    <button class=\"layui-btn layui-btn-sm \" lay-event=\"add\">添加</button>\r\n    <button class=\"layui-btn layui-btn-sm layui-btn-danger\" lay-event=\"batchdel\">批量删除</button>\r\n</script>\r\n\r\n<!--表格行工具栏模板-->\r\n<script type=\"text/html\" id=\"rowToolbarTpl\">\r\n    <a class=\"layui-btn layui-btn-xs layui-btn-normal\" lay-event=\"edit\"><i class=\"layui-icon layui-icon-edit\"></i>编辑</a>\r\n    <a class=\"layui-btn layui-btn-xs layui-btn-danger\" lay-event=\"del\"><i\r\n            class=\"layui-icon layui-icon-delete\"></i>删除</a>\r\n</script>\r\n\r\n<!--表格列格式化模板 start-->\r\n<script type=\"text/html\" id=\"answerTpl\">\r\n    <span>{{d.answer}}</span>\r\n</script>\r\n\r\n<script type=\"text/html\" id=\"statusTpl\">\r\n    {{#  if(d.status == 0){ }}\r\n    <span class=\"layui-badge layui-bg-green\">正常</span>\r\n    {{#  } else { }}\r\n    <span class=\"layui-badge\">禁用</span>\r\n    {{# } }}\r\n</script>\r\n\r\n<script type=\"text/html\" id=\"subjectTypeTpl\">\r\n    {{#  if(d.subjectType == 1){ }}\r\n    <span>单选题</span>\r\n    {{#  } else { }}\r\n    <span>多选题</span>\r\n    {{# } }}\r\n</script>\r\n<!--表格列格式化模板 end-->\r\n\r\n<script type=\"text/javascript\" th:inline=\"javascript\">\r\n\r\n    layui.use(['element', 'form', 'layer', 'table', 'laydate'], function () {\r\n        var form = layui.form, layer = layui.layer, table = layui.table;\r\n        var tableId = 'kContentTable';\r\n        var area = ['600px', '80%'];\r\n\r\n        // 实例化table\r\n        var tableIns = table.render($.extend(config.layui.table, {\r\n            elem: '#' + tableId\r\n            , url: BASE_WEB + 'func/questionBank/list/data' // 数据接口\r\n            , toolbar: '#headToolbarTpl'\r\n            , cols: [[ //表头\r\n                {type: 'checkbox', fixed: 'left'}\r\n                , {field: 'id', title: 'id', width: 100, align: 'center'}\r\n                , {field: 'subjectType', title: '题目类型', width: 100, templet: '#subjectTypeTpl', align: 'center'}\r\n                , {field: 'example', title: '案例', width: 300, align: 'center'}\r\n                , {field: 'question', title: '问题', width: 300, align: 'center'}\r\n                , {field: 'answer', title: '答案', width: 300, templet: '#answerTpl', align: 'center'}\r\n                , {field: 'status', title: '状态', width: 100, templet: '#statusTpl', align: 'center'}\r\n                , {field: '', title: '操作', width: 235, fixed: 'right', templet: '#rowToolbarTpl', align: 'center'}\r\n            ]]\r\n        }));\r\n\r\n        // 监听表格头部事件\r\n        table.on('toolbar(' + tableId + ')', function (obj) {\r\n            var checkStatus = table.checkStatus(obj.config.id);\r\n            var checkData = checkStatus.data; // 得到选中的数据\r\n            switch (obj.event) {\r\n                case 'add':\r\n                    layer.open({\r\n                        type: 2\r\n                        , title: '添加'\r\n                        , content: BASE_WEB + 'func/questionBank/edit'\r\n                        , maxmin: true\r\n                        , area: area   // 宽高\r\n                        , btn: ['确定', '取消']\r\n                        , yes: function (index, layero) {\r\n                            //点击确认触发 iframe 内容中的按钮提交\r\n                            var submit = layero.find('iframe').contents().find(\"#kFormSubmit\");\r\n                            submit.click();\r\n                        }\r\n                    });\r\n                    break;\r\n                case 'batchdel':\r\n                    if (checkData.length === 0) {\r\n                        return kvfKit.warningMsg('请选择数据');\r\n                    }\r\n                    layer.confirm('确定删除吗？', function (index) {\r\n                        var ids = [];\r\n                        $.each(checkData, function (i, n) {\r\n                            ids[i] = n.id;\r\n                        });\r\n\r\n                        //执行 Ajax 后重载\r\n                        $.ajax({\r\n                            type: req.type.post,\r\n                            url: BASE_WEB + 'func/questionBank/batchdel',\r\n                            data: {ids: ids.toString()},\r\n                            success: function (r) {\r\n                                if (r.code === req.status.ok) {\r\n                                    table.reload(tableId);\r\n                                    kvfKit.sucessMsg('已删除');\r\n                                } else {\r\n                                    kvfKit.errorMsg(r.msg);\r\n                                }\r\n                            }\r\n                        });\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n\r\n        // 表格行按钮 监听事件\r\n        table.on('tool(' + tableId + ')', function (obj) {\r\n            var data = obj.data; //获得当前行数据\r\n            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）\r\n            var tr = obj.tr; //获得当前行 tr 的DOM对象\r\n\r\n            if (layEvent === 'edit') {\r\n                layer.open({\r\n                    type: 2\r\n                    , title: '编辑'\r\n                    , content: BASE_WEB + 'func/questionBank/edit?id=' + data.id\r\n                    , maxmin: true\r\n                    , area: area   // 宽高\r\n                    , btn: ['确定', '取消']\r\n                    , yes: function (index, layero) {\r\n                        //点击确认触发 iframe 内容中的按钮提交\r\n                        var submit = layero.find('iframe').contents().find(\"#kFormSubmit\");\r\n                        submit.click();\r\n                    }\r\n                });\r\n            }\r\n            if (layEvent === 'del') {\r\n                layer.confirm('确定删除吗？', function (index) {\r\n                    //执行 Ajax 后重载\r\n                    $.ajax({\r\n                        type: req.type.post,\r\n                        url: BASE_WEB + 'func/questionBank/del/' + data.id,\r\n                        async: false,\r\n                        success: function (r) {\r\n                            if (r.code === req.status.ok) {\r\n                                table.reload(tableId);\r\n                                kvfKit.sucessMsg('已删除');\r\n                            } else {\r\n                                kvfKit.errorMsg(r.msg);\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        });\r\n\r\n        // 监听查询\r\n        form.on('submit(kTableSearchFilter)', function (obj) {\r\n            renderTableData(obj.field);\r\n            return false;\r\n        });\r\n\r\n        var active = {\r\n            refresh: function () {\r\n                var $form = $('form');\r\n                $form[0].reset();\r\n                renderTableData(kvfKit.getFormJson($form));\r\n            }\r\n        };\r\n\r\n        kvfKit.activeInit(active);\r\n\r\n        function renderTableData(params) {\r\n            params = params ? params : {};\r\n\r\n            tableIns.reload({\r\n                where: params,\r\n                page: {curr: 1}\r\n            });\r\n        }\r\n\r\n        // 绑定监听回车事件\r\n        kvfKit.bindEnterEventForLayuiForm();\r\n    });\r\n</script>\r\n\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/func/questionBank.html b/src/main/resources/templates/func/questionBank.html
--- a/src/main/resources/templates/func/questionBank.html	
+++ b/src/main/resources/templates/func/questionBank.html	
@@ -17,12 +17,36 @@
                         <div class="layui-form layui-card-header kvf-card-header-auto">
                             <div class="layui-form-item">
                                 <div class="layui-inline">
+                                    <label class="layui-form-label">题目</label>
+                                    <div class="layui-input-inline">
+                                        <input type="text" name="question" placeholder="请输入题目包含文字" autocomplete="off" class="layui-input">
+                                    </div>
+                                </div>
+                                <div class="layui-inline">
+                                    <label class="layui-form-label">题库</label>
+                                    <div class="layui-input-inline">
+                                        <select class="layui-select" name="classify">
+                                            <option value="">请选择</option>
+                                            <option value="法律法规">法律法规</option>
+                                            <option value="执法规范化">执法规范化</option>
+                                            <option value="公共科目">公共科目</option>
+                                            <option value="专业科目">专业科目</option>
+                                            <option value="常用法律">常用法律</option>
+                                            <option value="题库">题库</option>
+                                            <option value="科技应用">科技应用</option>
+                                            <option value="新警题库">新警题库</option>
+                                            <option value="2023全警法律知识题库">2023全警法律知识题库</option>
+                                        </select>
+                                    </div>
+                                </div>
+                                <div class="layui-inline">
                                     <label class="layui-form-label">题目类型</label>
                                     <div class="layui-input-inline">
                                         <select class="layui-select" name="subjectType">
                                             <option value="">请选择</option>
                                             <option value="1">单选题</option>
                                             <option value="2">多选题</option>
+                                            <option value="3">判断题</option>
                                         </select>
                                     </div>
                                 </div>
@@ -91,8 +115,10 @@
 <script type="text/html" id="subjectTypeTpl">
     {{#  if(d.subjectType == 1){ }}
     <span>单选题</span>
+    {{#  } else if(d.subjectType == 2) { }}
+    <span>多选题</span>
     {{#  } else { }}
-    <span>多选题</span>
+    <span>判断题</span>
     {{# } }}
 </script>
 <!--表格列格式化模板 end-->
@@ -111,7 +137,7 @@
             , toolbar: '#headToolbarTpl'
             , cols: [[ //表头
                 {type: 'checkbox', fixed: 'left'}
-                , {field: 'id', title: 'id', width: 100, align: 'center'}
+                , {field: 'classify', title: '题库', width: 100, align: 'center'}
                 , {field: 'subjectType', title: '题目类型', width: 100, templet: '#subjectTypeTpl', align: 'center'}
                 , {field: 'example', title: '案例', width: 300, align: 'center'}
                 , {field: 'question', title: '问题', width: 300, align: 'center'}
Index: src/main/resources/templates/func/questionBank_edit.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n    <style>\r\n        .layui-form-item .layui-input-inline {\r\n            float: left;\r\n            width: 74%;\r\n            margin-right: 10px\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n<div class=\"layui-form\" style=\"padding: 20px 30px 0 0;\">\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">题目类型</label>\r\n        <div class=\"layui-input-inline\">\r\n                <select name=\"subjectType\" lay-verify=\"required\" lay-search=\"\">\r\n                    <option value=\"\">请选择</option>\r\n                    <option value=\"1\" th:selected = \"${editInfo.subjectType} == 1\">单选题</option>\r\n                    <option value=\"2\" th:selected = \"${editInfo.subjectType} == 2\">多选题</option>\r\n                </select>\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">案例</label>\r\n        <div class=\"layui-input-inline\">\r\n            <textarea name=\"example\" placeholder=\"请输入案例\" th:text=\"${editInfo.example}\"  autocomplete=\"off\" class=\"layui-textarea\" ></textarea>\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">问题题目</label>\r\n        <div class=\"layui-input-inline\">\r\n            <textarea name=\"question\" placeholder=\"请输入问题题目\" autocomplete=\"off\" th:text=\"${editInfo.question}\" class=\"layui-textarea\" lay-verify=\"required\"></textarea>\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">选项配置:</label>\r\n        <div id=\"answerLine\" class=\"layui-input-inline\">\r\n            <div style=\"margin-bottom: 5px\" th:each=\"answer: ${editInfo.answerDtos}\">\r\n                <input type=\"text\" th:value=\"${answer.getAnswer()}\" class=\"layui-input answer\" value=\"\" style=\"width:300px;display: inline\">\r\n                <input type=\"checkbox\" lay-skin=\"primary\" th:checked=\"${answer.value}\">\r\n                <button type=\"button\" class=\"layui-btn layui-btn-sm layui-btn-danger\"><i class=\"layui-icon layui-icon-delete\"></i>删除</button>\r\n            </div>\r\n        </div>\r\n        <button type=\"button\" id=\"addAnswer\" class=\"layui-btn layui-btn-sm\" style=\"margin-left:111px;margin-top: 10px\"><i class=\"layui-icon layui-icon-add-1\"></i> 追加</button>\r\n    </div>\r\n\r\n\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">状态</label>\r\n        <div class=\"layui-input-block\">\r\n            <input type=\"radio\" name=\"status\" value=\"0\" title=\"正常\" autocomplete=\"off\" class=\"layui-input\" th:checked=\"${editInfo.status==0 || editInfo.status== null}\">\r\n            <input type=\"radio\" name=\"status\" value=\"1\" title=\"禁用\" autocomplete=\"off\" class=\"layui-input\" th:checked=\"${editInfo.status==1}\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item layui-hide\">\r\n        <input type=\"button\" lay-submit=\"\" lay-filter=\"kFormSubmit\" id=\"kFormSubmit\" value=\"确认添加\">\r\n        <input type=\"text\" name=\"id\" th:value=\"${editInfo.id}\" placeholder=\"保存ID\" autocomplete=\"off\" class=\"layui-input\">\r\n    </div>\r\n</div>\r\n<!--<script type=\"text/javascript\" th:inline=\"javascript\">-->\r\n    <!--var answerJson = [[${editInfo.answer}]];-->\r\n    <!--var answer = JSON.parse(answerJson);-->\r\n    <!--console.log(answer);-->\r\n<!--</script>-->\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n<script>\r\n    /*定义选题对象*/\r\n    function Answer(answer,value){\r\n        /*定义对象的属性*/\r\n        this.answer = answer;\r\n        this.value = value;\r\n\r\n        /*定义对象的方法*/\r\n        this.study = function(){\r\n        }\r\n    }\r\n\r\n    layui.use(['form'], function () {\r\n        var $ = layui.$, form = layui.form;\r\n\r\n        //监听提交\r\n        form.on('submit(kFormSubmit)', function(data){\r\n            var field = data.field; //获取提交的字段\r\n            var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引\r\n\r\n            var answers = [];\r\n            var questions = [];\r\n            var i = 0;\r\n            $('.answer').each(function () {\r\n                questions.push( $(this).val() );\r\n            });\r\n\r\n            var isChecked = false;\r\n            $('input[type=checkbox]').each(function () {\r\n                var ques = new Answer();\r\n                ques.answer = questions[i];\r\n                ques.value = $(this).prop('checked');\r\n                answers.push(ques);\r\n\r\n                isChecked = isChecked || ques.value;\r\n                i++;\r\n            });\r\n\r\n            if (!isChecked){\r\n                layer.msg(\"请选择答案!\");\r\n                return;\r\n            }\r\n\r\n            field.answer = JSON.stringify(answers).replace(/\"/g,\"PASSWWORD\");// 框架把json的双引号去掉了\r\n\r\n            var url = field.id ? 'func/questionBank/edit' : 'func/questionBank/add';\r\n            //提交 Ajax 成功后，关闭当前弹层并重载表格\r\n            $.ajax({\r\n                type: req.type.post,\r\n                url: BASE_WEB + url,\r\n                data: field,\r\n                async: false,\r\n                success: function (r) {\r\n                    if (r.code === req.status.ok) {\r\n                        // 重载表格\r\n                        parent.layui.table.reload('kContentTable');\r\n                        parent.layer.close(index); //再执行关闭\r\n                    } else {\r\n                        kvfKit.errorMsg(r.msg);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n\r\n        $(document).on('click', '#addAnswer', function () {\r\n            var line = '   <div style=\"margin-bottom: 5px\">\\n' +\r\n                '                <input type=\"text\" class=\"layui-input answer\" style=\"width:300px;display: inline\">\\n' +\r\n                '                <input type=\"checkbox\" lay-skin=\"primary\">\\n' +\r\n                '                <button type=\"button\" class=\"layui-btn layui-btn-sm layui-btn-danger\"><i class=\"layui-icon layui-icon-delete\"></i>删除</button>\\n' +\r\n                '          </div>';\r\n            $('#answerLine').append(line);\r\n            form.render('checkbox');\r\n        })\r\n\r\n        $(document).on('click', '.layui-btn-danger', function () {\r\n            $(this).parent().remove();\r\n        })\r\n    })\r\n</script>\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/func/questionBank_edit.html b/src/main/resources/templates/func/questionBank_edit.html
--- a/src/main/resources/templates/func/questionBank_edit.html	
+++ b/src/main/resources/templates/func/questionBank_edit.html	
@@ -15,12 +15,30 @@
 <body>
 <div class="layui-form" style="padding: 20px 30px 0 0;">
     <div class="layui-form-item">
+        <label class="layui-form-label">题库</label>
+        <div class="layui-input-inline">
+            <select name="classify" lay-verify="required" lay-search="">
+                <option value="">请选择</option>
+                <option value="法律法规" th:selected = "${editInfo.classify} == '法律法规'">法律法规</option>
+                <option value="执法规范化" th:selected = "${editInfo.classify} == '执法规范化'">执法规范化</option>
+                <option value="公共科目" th:selected = "${editInfo.classify} == '公共科目'">公共科目</option>
+                <option value="专业科目" th:selected = "${editInfo.classify} == '专业科目'">专业科目</option>
+                <option value="常用法律" th:selected = "${editInfo.classify} == '常用法律'">常用法律</option>
+                <option value="题库" th:selected = "${editInfo.classify} == '题库'">题库</option>
+                <option value="科技应用" th:selected = "${editInfo.classify} == '科技应用'">科技应用</option>
+                <option value="新警题库" th:selected = "${editInfo.classify} == '新警题库'">新警题库</option>
+                <option value="2023全警法律知识题库" th:selected = "${editInfo.classify} == '2023全警法律知识题库'">2023全警法律知识题库</option>
+            </select>
+        </div>
+    </div>
+    <div class="layui-form-item">
         <label class="layui-form-label">题目类型</label>
         <div class="layui-input-inline">
                 <select name="subjectType" lay-verify="required" lay-search="">
                     <option value="">请选择</option>
                     <option value="1" th:selected = "${editInfo.subjectType} == 1">单选题</option>
                     <option value="2" th:selected = "${editInfo.subjectType} == 2">多选题</option>
+                    <option value="3" th:selected = "${editInfo.subjectType} == 3">判断题</option>
                 </select>
         </div>
     </div>
Index: src/main/resources/templates/func/userTab_edit.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!DOCTYPE html>\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:th=\"http://www.thymeleaf.org\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title th:replace=\"common/base::pagetitle\"></title>\r\n    <link th:replace=\"common/base::static\"/>\r\n</head>\r\n<body>\r\n<div class=\"layui-form\" style=\"padding: 20px 30px 0 0;\">\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">用户id</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"userid\" th:value=\"${editInfo.userid}\" placeholder=\"请输入用户id\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">姓名</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"realname\" th:value=\"${editInfo.realname}\" placeholder=\"请输入姓名\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">手机号</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"mobile\" th:value=\"${editInfo.mobile}\" placeholder=\"请输入手机号\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">部门id</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"department\" th:value=\"${editInfo.department}\" placeholder=\"请输入部门id\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">union</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"unionid\" th:value=\"${editInfo.unionid}\" placeholder=\"请输入union\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n    <div class=\"layui-form-item\">\r\n        <label class=\"layui-form-label\">头像</label>\r\n        <div class=\"layui-input-inline\">\r\n            <input type=\"text\" name=\"avatar\" th:value=\"${editInfo.avatar}\" placeholder=\"请输入头像\" autocomplete=\"off\" class=\"layui-input\">\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"layui-form-item layui-hide\">\r\n        <input type=\"button\" lay-submit=\"\" lay-filter=\"kFormSubmit\" id=\"kFormSubmit\">\r\n        <input type=\"text\" name=\"id\" th:value=\"${editInfo.id}\" autocomplete=\"off\" class=\"layui-input\">\r\n    </div>\r\n</div>\r\n\r\n<script th:replace=\"common/base::context\"></script>\r\n<script th:replace=\"common/base::mainjs\"></script>\r\n<script>\r\n    layui.use(['form', 'laydate'], function () {\r\n        var $ = layui.$, form = layui.form, laydate = layui.laydate;\r\n\r\n\r\n\r\n        //监听提交\r\n        form.on('submit(kFormSubmit)', function(data){\r\n            var field = data.field; //获取提交的字段\r\n            var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引\r\n\r\n            var url = field.id ? 'func/userTab/edit' : 'func/userTab/add';\r\n            //提交 Ajax 成功后，关闭当前弹层并重载表格\r\n            $.ajax({\r\n                type: req.type.post,\r\n                url: BASE_WEB + url,\r\n                data: field,\r\n                async: false,\r\n                success: function (r) {\r\n                    if (r.code === req.status.ok) {\r\n                        // 重载表格\r\n                        parent.layui.table.reload('kContentTable');\r\n                        parent.layer.close(index); //再执行关闭\r\n                    } else {\r\n                        kvfKit.errorMsg(r.msg);\r\n                    }\r\n                }\r\n            });\r\n\r\n        });\r\n    })\r\n</script>\r\n</body>\r\n</html>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/templates/func/userTab_edit.html b/src/main/resources/templates/func/userTab_edit.html
--- a/src/main/resources/templates/func/userTab_edit.html	
+++ b/src/main/resources/templates/func/userTab_edit.html	
@@ -26,7 +26,7 @@
         </div>
     </div>
     <div class="layui-form-item">
-        <label class="layui-form-label">部门id</label>
+        <label class="layui-form-label">部门名称</label>
         <div class="layui-input-inline">
             <input type="text" name="department" th:value="${editInfo.department}" placeholder="请输入部门id" autocomplete="off" class="layui-input">
         </div>
Index: src/main/java/com/kalvin/kvf/modules/func/entity/DeptSys.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.entity;public class DeptSys {\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/entity/DeptSys.java b/src/main/java/com/kalvin/kvf/modules/func/entity/DeptSys.java
--- a/src/main/java/com/kalvin/kvf/modules/func/entity/DeptSys.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/entity/DeptSys.java	
@@ -1,2 +1,11 @@
-package com.kalvin.kvf.modules.func.entity;public class DeptSys {
+package com.kalvin.kvf.modules.func.entity;
+
+import lombok.Data;
+
+@Data
+public class DeptSys {
+    private String department;
+    private Integer cs;
+    private Integer cnt;
+    private Float bfb;
 }
Index: src/main/java/com/kalvin/kvf/modules/func/controller/ZzdController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.controller;public class ZzdController {\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/controller/ZzdController.java b/src/main/java/com/kalvin/kvf/modules/func/controller/ZzdController.java
--- a/src/main/java/com/kalvin/kvf/modules/func/controller/ZzdController.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/controller/ZzdController.java	
@@ -1,2 +1,84 @@
-package com.kalvin.kvf.modules.func.controller;public class ZzdController {
+package com.kalvin.kvf.modules.func.controller;
+
+import cn.hutool.crypto.digest.DigestUtil;
+import com.alibaba.fastjson.JSONObject;
+import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
+import com.kalvin.kvf.common.controller.BaseController;
+import com.kalvin.kvf.common.dto.R;
+import com.kalvin.kvf.modules.func.entity.UserInfo;
+import com.kalvin.kvf.modules.func.service.UserInfoService;
+import com.kalvin.kvf.modules.util.OkHttpUtils;
+import org.springframework.web.bind.annotation.*;
+import org.springframework.web.servlet.ModelAndView;
+import org.springframework.web.servlet.view.RedirectView;
+
+import javax.annotation.Resource;
+import javax.servlet.http.HttpServletRequest;
+
+/**
+ * @author Administrator
+ */
+@RestController
+@RequestMapping("zzd")
+public class ZzdController extends BaseController {
+    @Resource
+    private UserInfoService userInfoService;
+
+    private static final String APPKEY = "a36bbb975fea4b90";
+    private static final String APPSECRET = "2e39fea3b1f04d74";
+    private static final String METHOD = "getUserInfo";
+
+    @RequestMapping("/index")
+    public ModelAndView index(HttpServletRequest request) {
+        String token = request.getParameter("_token");
+        String url = "http://111.1.30.66:8089/redship/index.html#/pages/index/index?token=" + token;
+//        String url = "http://localhost:8080/redship#/pages/index/index?token=" + token;
+        System.out.println("###########" + url + "############");
+        return new ModelAndView(new RedirectView(url));
+    }
+
+    @RequestMapping(value = "/login", method = RequestMethod.POST)
+    @ResponseBody
+    public R login(@RequestParam(value = "token") String token) {
+        try {
+            System.out.println("---------------------token=" + token + "---------------------------\n");
+            long timestamp = System.currentTimeMillis();
+            String signature = DigestUtil.md5Hex("key" + APPKEY + "secret" + APPSECRET + "stamp" + timestamp);
+//            String rs = OkHttpUtils.builder().url("https://xfszmf.nhgaj.com//api/open/user.ashx")
+            String rs = OkHttpUtils.builder().url("http://10.203.12.181:8008/api/open/user.ashx")
+                    .addHeader("_appkey", APPKEY)
+                    .addHeader("_timestamp", String.valueOf(timestamp))
+                    .addHeader("_signature", signature)
+                    .addHeader("_method", METHOD)
+                    .addHeader("_token", token)
+//                .addParam("name", "xxx").addParam("pass", "xxx")
+                    .get()
+                    .sync();
+
+            System.out.println(rs);
+
+            JSONObject jb = (JSONObject) JSONObject.parseObject(rs).get("data");
+            String mobile = jb.getString("mobile");
+            UserInfo userInfo = userInfoService.getOne(new LambdaQueryWrapper<UserInfo>()
+                    .eq(UserInfo::getMobile, mobile));
+
+            if (userInfo == null) {
+                userInfo = new UserInfo();
+                userInfo.setUserid(jb.getString("openid"));
+                userInfo.setRealname(jb.getString("nickname"));
+                userInfo.setMobile(mobile);
+                userInfo.setOpenid(jb.getString("openid"));
+//                userInfo.setUnionid();
+//                userInfo.setAvatar();
+//                userInfo.setDepartment();
+
+                userInfoService.save(userInfo);
+            }
+
+            return R.ok(userInfo);
+        } catch (Exception ex) {
+            System.out.println(ex.getMessage());
+            return R.fail("err:" + ex.getMessage());
+        }
+    }
 }
Index: src/main/java/com/kalvin/kvf/modules/schedule/service/JobServiceImpl.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.schedule.service;\r\n\r\nimport com.baomidou.mybatisplus.extension.plugins.pagination.Page;\r\nimport com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;\r\nimport com.kalvin.kvf.common.exception.KvfException;\r\nimport com.kalvin.kvf.modules.schedule.constant.JobConstant;\r\nimport com.kalvin.kvf.modules.schedule.utils.ScheduleKit;\r\nimport org.springframework.stereotype.Service;\r\nimport com.kalvin.kvf.modules.schedule.entity.Job;\r\nimport com.kalvin.kvf.modules.schedule.mapper.JobMapper;\r\nimport org.springframework.transaction.annotation.Transactional;\r\n\r\nimport java.util.List;\r\n\r\n/**\r\n * <p>\r\n * 定时任务表 服务实现类\r\n * </p>\r\n * @since 2019-08-17 17:06:12\r\n */\r\n@Service\r\npublic class JobServiceImpl extends ServiceImpl<JobMapper, Job> implements JobService {\r\n\r\n    @Override\r\n    public Page<Job> listJobPage(Job job) {\r\n        Page<Job> page = new Page<>(job.getCurrent(), job.getSize());\r\n        List<Job> jobs = baseMapper.selectJobList(job, page);\r\n        return page.setRecords(jobs);\r\n    }\r\n\r\n    @Transactional\r\n    @Override\r\n    public void createJob(Job job) {\r\n        job.setStatus(JobConstant.JOB_STATUS_PAUSE);\r\n        super.save(job);\r\n        ScheduleKit.create(job.getId(), job);\r\n    }\r\n\r\n    @Transactional\r\n    @Override\r\n    public void pauseJob(Long id) {\r\n        Job job = this.checkJobExist(id);\r\n        job.setStatus(JobConstant.JOB_STATUS_PAUSE);\r\n        super.updateById(job);\r\n        ScheduleKit.pause(id);\r\n    }\r\n\r\n    @Transactional\r\n    @Override\r\n    public void resumeJob(Long id) {\r\n        Job job = this.checkJobExist(id);\r\n        job.setStatus(JobConstant.JOB_STATUS_RUNNING);\r\n        super.updateById(job);\r\n        ScheduleKit.resume(id);\r\n    }\r\n\r\n    @Transactional\r\n    @Override\r\n    public void updateJob(Job job) {\r\n        job.setStatus(JobConstant.JOB_STATUS_RUNNING);\r\n        super.updateById(job);\r\n        ScheduleKit.update(job.getId(), job);\r\n    }\r\n\r\n    @Transactional\r\n    @Override\r\n    public void deleteJob(Long id) {\r\n        super.removeById(id);\r\n        ScheduleKit.delete(id);\r\n    }\r\n\r\n    @Override\r\n    public Job checkJobExist(Long id) {\r\n        Job job = super.getById(id);\r\n        if (job == null) {\r\n            throw new KvfException(\"不存在的任务ID\");\r\n        }\r\n        return job;\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/schedule/service/JobServiceImpl.java b/src/main/java/com/kalvin/kvf/modules/schedule/service/JobServiceImpl.java
--- a/src/main/java/com/kalvin/kvf/modules/schedule/service/JobServiceImpl.java	
+++ b/src/main/java/com/kalvin/kvf/modules/schedule/service/JobServiceImpl.java	
@@ -4,10 +4,10 @@
 import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;
 import com.kalvin.kvf.common.exception.KvfException;
 import com.kalvin.kvf.modules.schedule.constant.JobConstant;
-import com.kalvin.kvf.modules.schedule.utils.ScheduleKit;
-import org.springframework.stereotype.Service;
 import com.kalvin.kvf.modules.schedule.entity.Job;
 import com.kalvin.kvf.modules.schedule.mapper.JobMapper;
+import com.kalvin.kvf.modules.schedule.utils.ScheduleKit;
+import org.springframework.stereotype.Service;
 import org.springframework.transaction.annotation.Transactional;
 
 import java.util.List;
@@ -16,6 +16,7 @@
  * <p>
  * 定时任务表 服务实现类
  * </p>
+ *
  * @since 2019-08-17 17:06:12
  */
 @Service
@@ -28,7 +29,7 @@
         return page.setRecords(jobs);
     }
 
-    @Transactional
+    @Transactional(rollbackFor = Exception.class)
     @Override
     public void createJob(Job job) {
         job.setStatus(JobConstant.JOB_STATUS_PAUSE);
@@ -36,7 +37,7 @@
         ScheduleKit.create(job.getId(), job);
     }
 
-    @Transactional
+    @Transactional(rollbackFor = Exception.class)
     @Override
     public void pauseJob(Long id) {
         Job job = this.checkJobExist(id);
@@ -45,7 +46,7 @@
         ScheduleKit.pause(id);
     }
 
-    @Transactional
+    @Transactional(rollbackFor = Exception.class)
     @Override
     public void resumeJob(Long id) {
         Job job = this.checkJobExist(id);
@@ -54,7 +55,7 @@
         ScheduleKit.resume(id);
     }
 
-    @Transactional
+    @Transactional(rollbackFor = Exception.class)
     @Override
     public void updateJob(Job job) {
         job.setStatus(JobConstant.JOB_STATUS_RUNNING);
@@ -62,7 +63,7 @@
         ScheduleKit.update(job.getId(), job);
     }
 
-    @Transactional
+    @Transactional(rollbackFor = Exception.class)
     @Override
     public void deleteJob(Long id) {
         super.removeById(id);
Index: src/main/java/com/kalvin/kvf/modules/func/entity/UserTab.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.entity;\r\n\r\nimport com.baomidou.mybatisplus.annotation.IdType;\r\nimport com.baomidou.mybatisplus.annotation.TableId;\r\nimport com.baomidou.mybatisplus.annotation.TableName;\r\nimport lombok.Data;\r\nimport lombok.EqualsAndHashCode;\r\nimport lombok.experimental.Accessors;\r\nimport com.kalvin.kvf.common.entity.BaseEntity;\r\n\r\n/**\r\n * <p>\r\n * 用户表\r\n * </p>\r\n * @since 2021-03-30 14:33:54\r\n */\r\n@Data\r\n@EqualsAndHashCode(callSuper = true)\r\n@Accessors(chain = true)\r\n@TableName(\"func_user_tab\")\r\npublic class UserTab extends BaseEntity {\r\n\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    /**\r\n     * \r\n     */\r\n    @TableId(value = \"id\", type = IdType.AUTO)\r\n    private Integer id;\r\n\r\n    /**\r\n     * 用户id\r\n     */\r\n    private String userid;\r\n\r\n    /**\r\n     * 姓名\r\n     */\r\n    private String realname;\r\n\r\n    /**\r\n     * 手机号\r\n     */\r\n    private String mobile;\r\n\r\n    /**\r\n     * 部门id\r\n     */\r\n    private String department;\r\n\r\n    /**\r\n     * union\r\n     */\r\n    private String unionid;\r\n\r\n    /**\r\n     * 头像\r\n     */\r\n    private String avatar;\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/entity/UserTab.java b/src/main/java/com/kalvin/kvf/modules/func/entity/UserTab.java
--- a/src/main/java/com/kalvin/kvf/modules/func/entity/UserTab.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/entity/UserTab.java	
@@ -1,6 +1,7 @@
 package com.kalvin.kvf.modules.func.entity;
 
 import com.baomidou.mybatisplus.annotation.IdType;
+import com.baomidou.mybatisplus.annotation.TableField;
 import com.baomidou.mybatisplus.annotation.TableId;
 import com.baomidou.mybatisplus.annotation.TableName;
 import lombok.Data;
@@ -58,4 +59,6 @@
      */
     private String avatar;
 
+    @TableField(exist = false)
+    private Integer todayCnt;
 }
Index: src/main/java/com/kalvin/kvf/common/xss/XssFilter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.common.xss;\r\n\r\nimport com.kalvin.kvf.common.constant.Constants;\r\nimport lombok.extern.slf4j.Slf4j;\r\n\r\nimport javax.servlet.*;\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport java.io.IOException;\r\n\r\n/**\r\n * XSS过滤\r\n * Create by Kalvin on 2019/6/25.\r\n */\r\n@Slf4j\r\npublic class XssFilter implements Filter {\r\n\r\n    private String[] excludedUris;\r\n\r\n    @Override\r\n    public void init(FilterConfig filterConfig) {\r\n        log.info(\"init XssFilter...\");\r\n        excludedUris = filterConfig.getInitParameter(Constants.XSS_NOTICE_KEY).split(\",\");\r\n    }\r\n\r\n    @Override\r\n    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)\r\n            throws IOException, ServletException {\r\n        XssHttpRequestWrapper xssRequest = new XssHttpRequestWrapper((HttpServletRequest) request);\r\n        String url = xssRequest.getServletPath();\r\n        if (isExcludedUri(url)) {\r\n            chain.doFilter(request, response);\r\n        } else {\r\n            chain.doFilter(xssRequest, response);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void destroy() {\r\n    }\r\n\r\n    private boolean isExcludedUri(String uri) {\r\n        if (excludedUris == null || excludedUris.length <= 0) {\r\n            return false;\r\n        }\r\n        for (String ex : excludedUris) {\r\n            uri = uri.trim();\r\n            ex = ex.trim();\r\n            if (uri.toLowerCase().matches(ex.toLowerCase().replace(\"*\", \".*\")))\r\n                return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/common/xss/XssFilter.java b/src/main/java/com/kalvin/kvf/common/xss/XssFilter.java
--- a/src/main/java/com/kalvin/kvf/common/xss/XssFilter.java	
+++ b/src/main/java/com/kalvin/kvf/common/xss/XssFilter.java	
@@ -45,8 +45,9 @@
         for (String ex : excludedUris) {
             uri = uri.trim();
             ex = ex.trim();
-            if (uri.toLowerCase().matches(ex.toLowerCase().replace("*", ".*")))
+            if (uri.toLowerCase().matches(ex.toLowerCase().replace("*", ".*"))) {
                 return true;
+            }
         }
         return false;
     }
Index: src/main/java/com/kalvin/kvf/modules/func/entity/TalkShow.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.entity;\r\n\r\nimport com.baomidou.mybatisplus.annotation.IdType;\r\nimport com.baomidou.mybatisplus.annotation.TableId;\r\nimport com.baomidou.mybatisplus.annotation.TableName;\r\nimport lombok.Data;\r\nimport lombok.EqualsAndHashCode;\r\nimport lombok.experimental.Accessors;\r\nimport com.kalvin.kvf.common.entity.BaseEntity;\r\nimport org.springframework.format.annotation.DateTimeFormat;\r\nimport java.time.LocalDateTime;\r\n\r\n/**\r\n * <p>\r\n * 脱口秀\r\n * </p>\r\n * @since 2022-08-22 08:41:19\r\n */\r\n@Data\r\n@EqualsAndHashCode(callSuper = true)\r\n@Accessors(chain = true)\r\n@TableName(\"func_talk_show\")\r\npublic class TalkShow extends BaseEntity {\r\n\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    /**\r\n     * \r\n     */\r\n    @TableId(value = \"id\", type = IdType.AUTO)\r\n    private Integer id;\r\n\r\n    /**\r\n     * 姓名\r\n     */\r\n    private String name;\r\n\r\n    /**\r\n     * 年龄\r\n     */\r\n    private Integer age;\r\n\r\n    /**\r\n     * 性别\r\n     */\r\n    private String sex;\r\n\r\n    /**\r\n     * 手机\r\n     */\r\n    private String tel;\r\n\r\n    /**\r\n     * 是否外出\r\n     */\r\n    private Boolean ifout;\r\n\r\n    /**\r\n     * 外出地点\r\n     */\r\n    private String place;\r\n\r\n    /**\r\n     * 创建时间\r\n     */\r\n    @DateTimeFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\r\n    private LocalDateTime createTime;\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/entity/TalkShow.java b/src/main/java/com/kalvin/kvf/modules/func/entity/TalkShow.java
--- a/src/main/java/com/kalvin/kvf/modules/func/entity/TalkShow.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/entity/TalkShow.java	
@@ -3,12 +3,14 @@
 import com.baomidou.mybatisplus.annotation.IdType;
 import com.baomidou.mybatisplus.annotation.TableId;
 import com.baomidou.mybatisplus.annotation.TableName;
+import com.fasterxml.jackson.annotation.JsonFormat;
 import lombok.Data;
 import lombok.EqualsAndHashCode;
 import lombok.experimental.Accessors;
 import com.kalvin.kvf.common.entity.BaseEntity;
 import org.springframework.format.annotation.DateTimeFormat;
 import java.time.LocalDateTime;
+import java.util.Date;
 
 /**
  * <p>
@@ -63,7 +65,7 @@
     /**
      * 创建时间
      */
-    @DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss")
-    private LocalDateTime createTime;
+    @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss", timezone = "GMT+8")
+    private Date createTime;
 
 }
Index: src/main/java/com/kalvin/kvf/modules/func/entity/UserSys.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.kalvin.kvf.modules.func.entity;public class UserSys {\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/kalvin/kvf/modules/func/entity/UserSys.java b/src/main/java/com/kalvin/kvf/modules/func/entity/UserSys.java
--- a/src/main/java/com/kalvin/kvf/modules/func/entity/UserSys.java	
+++ b/src/main/java/com/kalvin/kvf/modules/func/entity/UserSys.java	
@@ -1,2 +1,10 @@
-package com.kalvin.kvf.modules.func.entity;public class UserSys {
+package com.kalvin.kvf.modules.func.entity;
+
+import lombok.Data;
+
+@Data
+public class UserSys {
+    private String realname;
+    private String avatar;
+    private int status;
 }
